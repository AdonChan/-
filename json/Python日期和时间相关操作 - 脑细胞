{"title": "Python日期和时间相关操作 - 脑细胞 ", "index": "时间函数,日期,datetime,python", "content": "1. 先来看几个常用的\n1.1 获取今天、昨天、明天的日期时间\nfrom datetime import datetime, timedelta, date\n\n'''今天'''\ntoday1 = date.today()  # 精确到`天`\ntoday2 = datetime.today()  # 精确到`微秒`\nstr(today1), str(today2)\n\n# 结果：\n# datetime.date(2015, 11, 20)\n# datetime.datetime(2015, 11, 20, 16, 26, 21, 593990)\n# ('2015-11-20', '2015-11-20 16:26:21.593990)\n\n\n'''昨天'''\nyesterday1 = date.today() + timedelta(days=-1)\nyesterday2 = datetime.today() + timedelta(days=-1)\nstr(yesterday1), str(yesterday2)\n\n# 结果：\n# datetime.date(2015, 11, 19)\n# datetime.datetime(2015, 11, 19, 16, 26, 21, 593990)\n# ('2015-11-19', '2015-11-19 16:26:21.593990)\n\n\n'''明天'''\ntomorrow1 = date.today() + timedelta(days=1)\ntomorrow2 = datetime.today() + timedelta(days=1)\nstr(tomorrow1), str(tomorrow2)\n\n# 结果：\n# datetime.date(2015, 11, 21)\n# datetime.datetime(2015, 11, 21, 16, 26, 21, 593990)\n# ('2015-11-21', '2015-11-21 16:26:21.593990)\n\n那获取几小时，几分钟，甚至几秒钟前后的时间呢？该怎么获取？\n看如下的代码：\nfrom datetime import datetime, timedelta\n\n# 获取两小时前的时间\ndate_time = datetime.today() + timedelta(hours=-2)\n其实就是给 timedelta() 这个类传入的参数变一下就可以了\n可传入的参数有 timedelta(weeks, days, hours, second, milliseconds, microseconds) 每个参数都是可选参数，默认值为0，参数值必须是这些（整数，浮点数，正数，负数）\n分别表示：timedelta(周，日，时，分，秒，毫秒，微秒)。也只能传入这7个参数\n说明：timedelta 这个对象其实是用来表示两个时间的间隔\n上面我们都是使用 datetime.today() 加上 timedelta()，那如果是 datetime.today() 减去 timedelta() 这样呢？ 其实得出结果就是相反而已，不明白可以动手试一下，对比一下 + 或 - 之后的结果。\n1.2 下面来说说获取N年前/后，N月前/后的技巧\n因为 timedelta() 这个对象传入的参数最大日期时间单位是周，最小的是 微秒，所以，关于 年 和 月 需要我们手动处理一下\nimport datetime\nimport calendar\n\ndef conver(value, years=0, months=0):\n    if months:\n        more_years, months = divmod(months, 12)\n        years += more_years\n\n        if not (1 <= months + value.month <= 12):\n            more_years, months = divmod(months + value.month, 12)\n            months -= value.month\n            years += more_years\n\n    if months or years:\n        year = value.year + years\n        month = value.month + months\n\n        # 此月份的的天号不存在转换后的月份里，将引发一个 ValueError 异常\n        # 比如，1月份有31天，2月份有29天，我需要1月31号的后一个月的日期，也就是2月31号，但是2月份没有31号\n        # 所以会引发一个 ValueError 异常\n        # 下面这个异常处理就是为了解决这个问题的\n        try:\n            value = value.replace(year=year, month=month)\n        except ValueError:\n            _, destination_days = calendar.monthrange(year, month)\n            day = value.day - destination_days\n            month += 1\n            if month > 12:\n                month = 1\n                year += 1\n            value = value.replace(year=year, month=month, day=day)\n\n    return value\n\ntoday = datetime.datetime.today()\nprint today  # 今天日期\nprint conver(today, months=1)  # 1月后\nprint conver(today, months=-1)  # 1月前\nprint conver(today, years=1)  # 1年后\n# 结果\n# datetime.datetime(2015, 11, 20, 16, 26, 21, 593990)\n# datetime.datetime(2015, 12, 20, 16, 26, 21, 593990)\n# datetime.datetime(2015, 10, 20, 16, 26, 21, 593990)\n# datetime.datetime(2016, 11, 20, 16, 26, 21, 593990)\n代码取自 when.py 的 _add_time 函数部分代码\n更新中...\n\n                ", "mainLikeNum": ["0 "], "mainBookmarkNum": "6"}