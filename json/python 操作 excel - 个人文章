{"title": "python 操作 excel - 个人文章 ", "index": "python", "content": "读excel\nimport xlrd\nfname = './test.xls'\nbk = xlrd.open_workbook(fname)\nshxrange = range(bk.nsheets)\nnrows = sh.nrows\nncols = sh.ncols\nfor i in range(1, nrows):\n    row_data = sh.row_values(i)\n    row_list.append(row_data)\n根据表单sheet的是个数组可以遍历所有表单\nsh = bk.sheet_by_index(0)\nsh = bk.sheet_by_name('xxx')\n两种方式获取表单sh.cell_value(0,0)定位获取单元值\n写excel\n# -*- coding: utf-8 -*-\n#导入xlwt模块\nimport xlwt\n# 创建一个Workbook对象，这就相当于创建了一个Excel文件\nbook = xlwt.Workbook(encoding='utf-8', style_compression=0)\n'''\nWorkbook类初始化时有encoding和style_compression参数\nencoding:设置字符编码，一般要这样设置：w = Workbook(encoding='utf-8')，就可以在excel中输出中文了。\n默认是ascii。当然要记得在文件头部添加：\n#!/usr/bin/env python\n# -*- coding: utf-8 -*-\nstyle_compression:表示是否压缩，不常用。\n'''\n#创建一个sheet对象，一个sheet对象对应Excel文件中的一张表格。\n# 在电脑桌面右键新建一个Excel文件，其中就包含sheet1，sheet2，sheet3三张表\nsheet = book.add_sheet('test', cell_overwrite_ok=True)\n# 其中的test是这张表的名字,cell_overwrite_ok，表示是否可以覆盖单元格，其实是Worksheet实例化的一个参数，默认值是False\n# 向表test中添加数据\nsheet.write(0, 0, 'EnglishName')  # 其中的'0-行, 0-列'指定表中的单元，'EnglishName'是向该单元写入的内容\nsheet.write(1, 0, 'Marcovaldo')\ntxt1 = '中文名字'\nsheet.write(0, 1, txt1.decode('utf-8'))  # 此处需要将中文字符串解码成unicode码，否则会报错\ntxt2 = '马可瓦多'\nsheet.write(1, 1, txt2.decode('utf-8'))\n \n# 最后，将以上操作保存到指定的Excel文件中\nbook.save(r'e:\\test1.xls')  # 在字符串前加r，声明为raw字符串，这样就不会处理其中的转义了。否则，可能会报错\n修改已有excel\nimport xlwt;  \nimport xlrd;  \n#import xlutils;  \nfrom xlutils.copy import copy;  \n   \n#init xls file  \n#styleBlueBkg= xlwt.easyxf('pattern: pattern solid, fore_colour sky_blue;');  \n#styleBold   = xlwt.easyxf('font: bold on');  \nstyleBoldRed  =xlwt.easyxf('font: color-index red, bold on');  \nheaderStyle=styleBoldRed;  \nwb=xlwt.Workbook();  \nws=wb.add_sheet(gConst['xls']['sheetName']);  \nws.write(0,0,\"Header\",        headerStyle);  \nws.write(0,1,\"CatalogNumber\", headerStyle);  \nws.write(0,2,\"PartNumber\",    headerStyle);  \nwb.save(gConst['xls']['fileName']);  \n   \n   \n#open existed xls file  \n#newWb = xlutils.copy(gConst['xls']['fileName']);  \n#newWb = copy(gConst['xls']['fileName']);  \noldWb=xlrd.open_workbook(gConst['xls']['fileName']);  \nprintoldWb;#<xlrd.book.Book object at 0x000000000315C940>  \nnewWb=copy(oldWb);  \nprintnewWb;#<xlwt.Workbook.Workbook object at 0x000000000315F470>  \nnewWs=newWb.get_sheet(0);  \nnewWs.write(1,0,\"value1\");  \nnewWs.write(1,1,\"value2\");  \nnewWs.write(1,2,\"value3\");  \nprint\"write new values ok\";  \nnewWb.save(gConst['xls']['fileName']);  \nprint\"save with same name ok\";  \n\n                ", "mainLikeNum": ["0 "], "mainBookmarkNum": "2"}