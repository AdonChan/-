{"title": " Python 读写excel文件 - Python提高班 ", "index": "python,xlswt,pythonc操作excel,openshift,excel", "content": "最近需要用到Python来操作excel表，读取表格内容到数据库。所以就搜索了相关资料。查找了一下，可以操作excel表的几个库有以下几个：\nopenpyxl\n这个是推荐使用的库，可以读写Excel 2010以上格式，以.xlsx结尾的文件。\nxlsxwriter\n这个支持.xlsx,但是只支持写入，格式化等操作，不支持读取。\nxlrd\n这个支持读取数据，支持以xls结尾的文件，也就是比较老的格式。\nxlwt\n这个和上面的相对应，支持写入书和格式化数据，支持xls结尾的文件格式。\nxlutils\n这个是整合了xlrd和xlwt两个库的功能。\n经过对比我还是选择了openpyxl这个库，下面针对这个库的使用进行说明\n公众号【智能制造专栏】，以后技术类文章会发在专栏。以下参考官方文档本文代码托管在github上，点击链接\n创建一个工作簿\nfrom openpyxl import Workbook\nwb = Workbook()\nws = wb.active             #默认创建第一个表，默认名字为sheet\nws1 = wb.create_sheet()    #创建第二个表\nws1.title = \"New Title\"    #为第二个表设置名字\nws2 = wb.get_sheet_by_name(\nNew Title\")                #通过名字获取表，和第二个表示一个表\nws1.save('your_name.xlsx') #保存\n\n读取一个工作簿中的内容\n from openpyxl import load_workbook\n wb = load_workbook('myname.xlsx')  #加载一个工作簿\n print wb.get_sheet_names()         #获取各个sheet的名字\n简单的用法\nfrom openpyxl import Workbook\nfrom openpyxl.compat import range\nfrom openpyxl.cell import get_column_letter\nwb = Workbook()\ndest_filename = 'empty_book.xlsx'\nws1 = wb.active              #第一个表\nws1.title = \"range names\"    #第一个表命名\n#遍历第一个表的1到39行，每行赋值从1到599.\nfor row in range(1,40):\n    ws1.append(range(600))\nws2 = wb.create_sheet(title=\"Pi\") # 创建第二个表\nws2['F5'] = 3.14     #为第二个表的F5单元格赋值为3.14\nws3 = wb.create_sheet(title=\"Data\")  #创建第三个表\n /* 下面遍历第三个表的10到19行，27到53列，并对每一行的单元格赋一个当前列名的名字如下图 */\nfor row in range(10,20):\n    for col in range(27,54):\n        _=ws3.cell(column=col,row=row,value=\"%s\" % get_column_letter(col)) #_当作一个普通的变量，一般表示后边不再使用\nwb.save(filename=dest_filename) #保存\n\n\n                ", "mainLikeNum": ["6 "], "mainBookmarkNum": "32"}