{"title": "python_send_mail_implement_example - blair ", "index": "python", "content": "python_send_mail_example\npython 中 email模块、smtplib模块 使得处理邮件变得比较简单.\n我这里参考网上小五义的一些代码，实现了一个简单的发送邮件例子，具体代码如下 :\n常量脚本 constant_mail.py\n#!/usr/bin/env python\n# _*_ coding: utf-8 _*_\n\n## date: 20160127\n\n## 邮件相关配置变量\nmail_to_list = [\"yourname01@x.com\", \"yourname02@x.com\"]\n#mail_host = \"smtp.exmail.qq.com:465\"\nmail_host = \"smtp.exmail.qq.com:25\"\nmail_user = \"yourname\"\nmail_password = \"yourpassword\"\nmail_postfix = \"x.com\"\nmail_from = mail_user + \" <\" +  mail_user + \"@\" + mail_postfix + \">\"\nmail_user_address = \"yourname@x.com\"\n\n# 发送内容相关配置\nsubject = \"default-email-subject\"\nmail_type = \"plain\"\n主脚本 send_mail.py\nimport sys\nsys.path.append(\"./\")\nimport constant_mail\nimport os, smtplib, mimetypes, base64\nfrom email.mime.text import MIMEText\n\n## about var\nmail_to_list = constant_mail.mail_to_list\nmail_host = constant_mail.mail_host\nmail_user = constant_mail.mail_user\nmail_user_address = constant_mail.mail_user_address\nmail_password = constant_mail.mail_password\nmail_postfix = constant_mail.mail_postfix\nmail_from = constant_mail.mail_from\nmail_subject = constant_mail.subject\nmail_type = constant_mail.mail_type\n\ndef get_mail_to_list(mailto):\n    to_list = mailto.split(\",\")\n    for i in range(0, len(to_list)):\n        to_list[i] = to_list[i].strip()+\"@\" + mail_postfix\n    return to_list\n\ndef send_mail(mail_to_list, subject, content, mail_type):\n    me = mail_from\n    message = MIMEText(content, _subtype=mail_type, _charset=\"utf-8\")\n    message[\"Subject\"] = subject\n    message[\"From\"] = me\n    message[\"To\"] = ';'.join(mail_to_list)\n\n    try:\n        server = smtplib.SMTP()\n        server.connect(mail_host)\n        server.login(mail_user_address, mail_password)\n        server.sendmail(my_info, mail_to_list, message.as_string())\n        server.close()\n        return True\n    except Exception, e:\n        print >> sys.stderr, \"[ERROR]: %s\" % str(e)\n        sys.exit(-1)\n\ndef main():\n    print len(sys.argv)\n    if len(sys.argv) < 4 :\n        print >> sys.stderr, \"args count : \" + str(len(sys.argv)) + \" is error!\"\n        return\n    mail_subject = sys.argv[1]\n    content=sys.argv[2]\n    mail_to_list = get_mail_to_list(sys.argv[3])\n    if send_mail(mail_to_list, mail_subject, content, mail_type):\n        print >> sys.stdout, \"[INFO] Email Auto Send Success!\"\n    else:\n        print >> sys.stderr, \"[ERROR] Email Auto Send Failure!\"\n\nif __name__ == '__main__':\n    main()\n参考 : 小五义\n\n                ", "mainLikeNum": ["0 "], "mainBookmarkNum": "1"}