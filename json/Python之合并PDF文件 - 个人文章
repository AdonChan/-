{"title": "Python之合并PDF文件 - 个人文章 ", "index": "python", "content": "  在日常的学习生活工作中，我们有时会遇到需要合并PDF文件的需求。这时，我们可以利用相关的PDF软件（如Adobe Acrobat Reader DC）来完成这个任务，幸运的是，Python也为我们提供了这方面的处理模块PyPDF2, 借用它，我们可以利用Python代码来很好地完成这项任务。  PyPDF2模块的相关参考文档网址为：https://pythonhosted.org/PyPDF2/ . 本文将介绍如何利用PyPDF2来完成PDF文件的合并。  首先我们在E盘的Cheats文件夹下有如下的PDF文件：\n\n  我们的Python代码完整如下：\n# -*- coding:utf-8*-\n# 利用PyPDF2模块合并同一文件夹下的所有PDF文件\n# 只需修改存放PDF文件的文件夹变量：file_dir 和 输出文件名变量: outfile\n\nimport os\nfrom PyPDF2 import PdfFileReader, PdfFileWriter\nimport time\n\n# 使用os模块的walk函数，搜索出指定目录下的全部PDF文件\n# 获取同一目录下的所有PDF文件的绝对路径\ndef getFileName(filedir):\n\n    file_list = [os.path.join(root, filespath) \\\n                 for root, dirs, files in os.walk(filedir) \\\n                 for filespath in files \\\n                 if str(filespath).endswith('pdf')\n                 ]\n    return file_list if file_list else []\n\n# 合并同一目录下的所有PDF文件\ndef MergePDF(filepath, outfile):\n\n    output = PdfFileWriter()\n    outputPages = 0\n    pdf_fileName = getFileName(filepath)\n\n    if pdf_fileName:\n        for pdf_file in pdf_fileName:\n            print(\"路径：%s\"%pdf_file)\n\n            # 读取源PDF文件\n            input = PdfFileReader(open(pdf_file, \"rb\"))\n\n            # 获得源PDF文件中页面总数\n            pageCount = input.getNumPages()\n            outputPages += pageCount\n            print(\"页数：%d\"%pageCount)\n\n            # 分别将page添加到输出output中\n            for iPage in range(pageCount):\n                output.addPage(input.getPage(iPage))\n\n        print(\"合并后的总页数:%d.\"%outputPages)\n        # 写入到目标PDF文件\n        outputStream = open(os.path.join(filepath, outfile), \"wb\")\n        output.write(outputStream)\n        outputStream.close()\n        print(\"PDF文件合并完成！\")\n\n    else:\n        print(\"没有可以合并的PDF文件！\")\n\n# 主函数\ndef main():\n    time1 = time.time()\n    file_dir = r'E:\\Cheats' # 存放PDF的原文件夹\n    outfile = \"Cheat_Sheets.pdf\" # 输出的PDF文件的名称\n    MergePDF(file_dir, outfile)\n    time2 = time.time()\n    print('总共耗时：%s s.' %(time2 - time1))\n\nmain()\n  运行上述Python代码，则会在同一目录下生成Cheat_Sheets.pdf文件，如下：\n\n  本次分享到此结束，欢迎代价交流~~\n\n                ", "mainLikeNum": ["0 "], "mainBookmarkNum": "2"}