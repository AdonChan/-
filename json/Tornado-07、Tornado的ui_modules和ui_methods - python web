{"title": "Tornado-07、Tornado的ui_modules和ui_methods - python web ", "index": "ubuntu,tornado,python", "content": "1.ui_modules和ui_methods\n第一步：新建文件uimethods.py ，这里的文件名是随意的只要在import时合法就行\ndef methods1(self):  #注意这里要加上self\n    return  'ui_methods 1'\n\ndef methods2(self):\n    return  'ui_methods 2'\n\n新建文件uimodules.py，使用ui_modules需要继承UIModule类\nfrom tornado.web import UIModule\nclass UiModule(UIModule):\n    def render(self, *args, **kwargs):\n        return '我是ui_module'\n\n第二步：在项目中导入\nimport util.uimethods\nimport util.uimodules\n\n第三步：在application配置参数，值是导入的模块名\nui_methods=util.uimethods,\nui_modules=util.uimodules,\n#也可以写成字典的形式，其实在tornado内部就是解析成字典的形式\nui_modules={'UiModule':util.uimodules.UiModule},\n\nclass Calculation:\n    def sum(self,a,b):\n        return a+b\n\nclass UiHandler(tornado.web.RequestHandler):\n    def fun(self):\n        return 'hujing'\n\n    def get(self):\n        username = 'haha'\n        self.render('module.html',\n                    username=username,\n                    fun=self.fun,\n                    cal=Calculation\n                    )\n\n\n第四步：在HTML中调用，导入的ui_modules需要使用module语句调用\n<!--调用ui_modules-->\n{% module UiModule() %}<br>\n<br>\n<!--调用ui_methodes-->\n{{ methods1() }}\n\nui_modules和ui_methods提高了方法和类的复用性，可以在全局使用。\n最后只需要在需要的页面添加如下代码就行\n{% module Advertisement() %}<br>\n\n\n\n最后在模板还提供了一些其他的功能\nset设置局部变量\n<!--通过set设置局部变量-->\n{% set su = Count().sum %}\n{{ su(6,9) }} <br>\n\n{% set args = Count().args %}\n{% for a in args(1,2,3,4,5) %}\n    {{ a }}<br>\n{% end %}\n\n使用apply语句，使用函数的作用范围到最近的{%end%}为止\n{% apply upper %}\n    hello world<br>\n    hahaha\n{% end %}\n{{ upper('hahaha') }} <br>\n\nlinkify生成一个链接\n{{ linkify('百度: http://www.baidu.com') }} <br>\n{%raw linkify('百度: http://www.baidu.com') %}\n\n\n\n\n\n2.附录\n\nmodule.html\n    <!DOCTYPE html>\n    <html lang=\"en\">\n    <head>\n        <meta charset=\"UTF-8\">\n        <title>Module</title>\n    </head>\n    <body>\n        {{ username }}<br>\n    \n        {{ fun() }}<br>\n    \n        {{ cal().sum(6,9) }}<br>\n    \n        {% import time %}\n        {{ time.time() }}<br>\n    \n        {% from util.mode_file import sub,upper,Count %}\n    \n        {{ sub(5,3) }}<br>\n    \n        {{ upper('wenmang') }}<br>\n    \n        {{ Count().url }}<br>\n        {% raw Count().url %}<br>\n    \n        {{ Count().sum(6,9) }}<br>\n        {{ Count.sum(6,9) }}<br>\n    \n        {{ Count().args(1,2,3,4) }}<br>\n    \n        {{ methods1() }}<br>\n    \n        {% module UiModule() %}<br>\n    \n        <!--通过set设置局部变量-->\n        {% set su = Count().sum %}\n        {{ su(6,9)}}\n    \n        {% set args = Count().args %}\n        {% for a in args(1,2,3,4,5)%}\n            {{ a }}<br>\n        {% end %}\n    \n        {% apply upper %}\n            <br>\n            ren hao e  <br>\n            xieyulong bu e\n        {% end %}\n        <br>\n        {{ upper('hahaha') }}\n    \n        <br>\n        {{ linkify('百度：http://www.baidu.com') }} <br>\n        {% raw linkify('百度：http://www.baidu.com') %} <br>\n    </body>\n    </html>\n\nuimodules.py\n    from tornado.web import UIModule\n    \n    class UiModule(UIModule):\n        def render(self, *args, **kwargs):\n            return '我是 ui_module'\n\n\n\nuimethods.py\ndef methods1(self):\n    return 'ui_methods1'\n\ndef methods2(self):\n    return 'ui_methods2'\nstart1.py\nimport tornado.httpserver\nimport tornado.ioloop\nimport tornado.options\nimport tornado.web\n\nimport util.uimodules\nimport util.uimethod\n\nfrom tornado.options import define,options\n\ndefine('port',default=9000,help='run port',type=int)\n\nclass Calculation:\n    def sum(self,a,b):\n        return a+b\n\nclass UiHandler(tornado.web.RequestHandler):\n    def fun(self):\n        return 'hujing'\n\n    def get(self):\n        username = 'haha'\n        self.render('module.html',\n                    username=username,\n                    fun=self.fun,\n                    cal=Calculation\n                    )\n\n\nif __name__ == '__main__':\n    tornado.options.parse_command_line()\n\napp = tornado.web.Application(\n    handlers=[\n        (r'/ui',UiHandler),\n    ],\n    template_path='templates',\n    static_path='static',\n    ui_methods=util.uimethod,\n    ui_modules=util.uimodules,\n    # ui_modules={'UiModule':util.uimodules.UiModule},\n    debug=True,\n)\nhttp_server = tornado.httpserver.HTTPServer(app)\nhttp_server.listen(options.port)\ntornado.ioloop.IOLoop.instance().start()\n\n\n\n\n                ", "mainLikeNum": ["0 "], "mainBookmarkNum": "0"}