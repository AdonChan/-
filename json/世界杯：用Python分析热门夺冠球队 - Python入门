{"title": "世界杯：用Python分析热门夺冠球队 - Python入门 ", "index": "python", "content": "2018年，火热的世界杯即将拉开序幕。在比赛开始之前，我们不妨用 Python 来对参赛队伍的实力情况进行分析，并大胆的预测下本届世界杯的夺冠热门球队。\n文中有获取本文源代码的方式。\n通过数据分析，可以发现很多有趣的结果，比如：\n找出哪些队伍是首次进入世界杯的黑马队伍\n找出2018年32强中之前已经进入过世界杯，但在世界杯上没有赢得过一场比赛的队伍\n当然，我们本次的主要任务是要通过数据分析来预测2018年世界杯的夺冠热门队伍。\n本次分析的数据来源于 Kaggle， 包含从 1872 年到今年的数据，包括世界杯比赛、世界杯预选赛、亚洲杯、欧洲杯、国家之间的友谊赛等比赛，一共大约 40000 场比赛的情况。\n本次的环境为\nwindow 7 系统\npython 3.6\nJupyter Notebook\npandas version 0.22.0\n先来看看数据的情况：\nimport pandas as pd\nimport matplotlib.pyplot as plt\n%matplotlib inline\nplt.style.use('ggplot')\ndf = pd.read_csv('results.csv')\ndf.head()\n该数据集包含的数据列的信息如下：\n日期\n主队名称\n客队名称\n主队进球数 （不含点球）\n客队进球数 （不含点球）\n比赛的类型\n比赛所在城市\n比赛所在国家\n是否中立\n结果如下：\n▼\n1、 获取所有世界杯比赛的数据（不含预选赛）\ndf_FIFA_all = df[df['tournament'].str.contains('FIFA', regex=True)]\ndf_FIFA = df_FIFA_all[df_FIFA_all['tournament']=='FIFA World Cup']\ndf_FIFA.head()\n结果如下：\n▼\n数据做一个初步整理\ndf_FIFA.loc[:,'date'] = pd.to_datetime(df_FIFA.loc[:,'date'])\ndf_FIFA['year'] = df_FIFA['date'].dt.year\ndf_FIFA['diff_score'] = df_FIFA['home_score']-df_FIFA['away_score']\ndf_FIFA['win_team'] = ''\ndf_FIFA['diff_score'] = pd.to_numeric(df_FIFA['diff_score'])\n创建一个新的列数据，包含获胜队伍的信息\nThe first method to get the winners\ndf_FIFA.loc[df_FIFA['diff_score']> 0, 'win_team'] = df_FIFA.loc[df_FIFA['diff_score']> 0, 'home_team']\ndf_FIFA.loc[df_FIFA['diff_score']< 0, 'win_team'] = df_FIFA.loc[df_FIFA['diff_score']< 0, 'away_team']\ndf_FIFA.loc[df_FIFA['diff_score']== 0, 'win_team'] = 'Draw'\ndf_FIFA.head()\nThe second method to get the winners\ndef find_win_team(df):\nwinners = []\nfor i, row in df.iterrows():\n   if row['home_score'] > row['away_score']:\n\n       winners.append(row['home_team'])\n\n   elif row['home_score'] < row['away_score']:\n\n       winners.append(row['away_team'])\n\n   else:\n\n       winners.append('Draw')\n\nreturn winners\ndf_FIFA['winner'] = find_win_team(df_FIFA)\ndf_FIFA.head()\n结果如下：\n▼\n2、 获取世界杯所有比赛的前20强数据情况\n2.1 获取世界杯所有比赛获胜场数最多的前20强数据\ns = df_FIFA.groupby('win_team')['win_team'].count()\ns.sort_values(ascending=False, inplace=True)\ns.drop(labels=['Draw'], inplace=True)\n用pandas可视化如下：\n柱状图\ns.head(20).plot(kind='bar', figsize=(10,6), title='Top 20 Winners of World Cup')\n▼\n水平柱状图\ns.sort_values(ascending=True,inplace=True)\ns.tail(20).plot(kind='barh', figsize=(10,6), title='Top 20 Winners of World Cup')\n▼\n饼图\ns_percentage = s/s.sum()\ns_percentage\ns_percentage.tail(20).plot(kind='pie', figsize=(10,10), autopct='%.1f%%',\n                      startangle=173, title='Top 20 Winners of World Cup', label='')\n\n▼\n分析结论1：\n从赢球场数来看，巴西、德国、意大利、阿根廷四支球队实力最强。\n通过上面的分析，我们还可以来查看部分国家的获胜情况\ns.get('China', default = 'NA')\ns.get('Japan', default = 'NA')\ns.get('Korea DPR', default = 'NA')\ns.get('Korea Republic', default = 'NA')\ns.get('Egypt', default = 'NA')\n运行结果分别是 ‘NA’，4，1，5，‘NA’。\n从结果来看，中国队，在世界杯比赛上（不含预选赛）还没有赢过。当然，本次世界杯的黑马-埃及队，之前两度进入世界杯上，但也没有赢过~~\n上面分析的是赢球场数的情况，下面我们来看下进球总数情况。\n2.2 各个国家队进球总数量情况\ndf_score_home = df_FIFA[['home_team', 'home_score']]\ncolumn_update = ['team', 'score']\ndf_score_home.columns = column_update\ndf_score_away = df_FIFA[['away_team', 'away_score']]\ndf_score_away.columns = column_update\ndf_score = pd.concat([df_score_home,df_score_away], ignore_index=True)\ns_score = df_score.groupby('team')['score'].sum()\ns_score.sort_values(ascending=False, inplace=True)\ns_score.sort_values(ascending=True, inplace=True)\ns_score.tail(20).plot(kind='barh', figsize=(10,6), title='Top 20 in Total Scores of World Cup')\n▼\n分析结论2：\n从进球总数量来看，德国、巴西、阿根廷、意大利四支球队实力最强。\n上面分析的是自1872年以来的所有球队的数据情况，下面，我们重点来分析下2018年世界杯32强的数据情况。小编推荐一个学Python的学习裙【 二二七，四三五，四五零 】，无论你是大牛还是小白，是想转行还是想入行都可以来了解一起进步一起学习！裙内有开发工具，很多干货和技术资料分享！希望新手少走弯路\n3、2018年世界杯32强分析\n2018年世界杯的分组情况如下：\n第一组：俄罗斯、德国、巴西、葡萄牙、阿根廷、比利时、波兰、法国\n第二组：西班牙、秘鲁、瑞士、英格兰、哥伦比亚、墨西哥、乌拉圭、克罗地亚\n第三组：丹麦、冰岛、哥斯达黎加、瑞典、突尼斯、埃及、塞内加尔、伊朗\n第四组：塞尔维亚、尼日利亚、澳大利亚、日本、摩洛哥、巴拿马、韩国、沙特阿拉伯\n获取32强的所有数据\n首先，判断是否有队伍首次打入世界杯。\nteam_list = ['Russia', 'Germany', 'Brazil', 'Portugal', 'Argentina', 'Belgium', 'Poland', 'France',\n        'Spain', 'Peru', 'Switzerland', 'England', 'Colombia', 'Mexico', 'Uruguay', 'Croatia',\n\n       'Denmark', 'Iceland', 'Costa Rica', 'Sweden', 'Tunisia', 'Egypt', 'Senegal', 'Iran',\n\n       'Serbia', 'Nigeria', 'Australia', 'Japan', 'Morocco', 'Panama', 'Korea Republic', 'Saudi Arabia']\n\nfor item in team_list:\nif item not in s_score.index:\n   print(item)\n\nout:\nIceland\nPanama\n通过上述分析可知，冰岛队和巴拿马队是首次打入世界杯的。\n由于冰岛队和巴拿马队是首次进入世界杯，所以这里的32强数据，事实上是没有这两支队伍的历史数据的。\ndf_top32 = df_FIFA[(df_FIFA['home_team'].isin(team_list))&(df_FIFA['away_team'].isin(team_list))]\n3.1 自1872年以来，32强数据情况\n赢球场数情况\ns_32 = df_top32.groupby('win_team')['win_team'].count()\ns_32.sort_values(ascending=False, inplace=True)\ns_32.drop(labels=['Draw'], inplace=True)\ns_32.sort_values(ascending=True,inplace=True)\ns_32.plot(kind='barh', figsize=(8,12), title='Top 32 of World Cup since year 1872')\n▼\n进球数据情况\ndf_score_home_32 = df_top32[['home_team', 'home_score']]\ncolumn_update = ['team', 'score']\ndf_score_home_32.columns = column_update\ndf_score_away_32 = df_top32[['away_team', 'away_score']]\ndf_score_away_32.columns = column_update\ndf_score_32 = pd.concat([df_score_home_32,df_score_away_32], ignore_index=True)\ns_score_32 = df_score_32.groupby('team')['score'].sum()\ns_score_32.sort_values(ascending=False, inplace=True)\ns_score_32.sort_values(ascending=True, inplace=True)\ns_score_32.plot(kind='barh', figsize=(8,12), title='Top 32 in Total Scores of World Cup since year 1872')\n▼\n分析结论3：\n自1872年以来，32强之间的世界杯比赛，从赢球场数和进球数量来看，德国、巴西、阿根廷三支球队实力最强。\n自1872年到现在，已经有100多年，时间跨度较大，有些国家已发生重大变化，后续分别分析自1978年（近10届）以及2002年（近4届）以来的比赛情况。\n程序代码是类似的，这里只显示可视化的结果。\n3.2 自1978年以来，32强数据情况\n赢球场数情况\n▼\n进球数据情况\n▼\n分析结论4：\n自1978年以来，32强之间的世界杯比赛，从赢球场数来看，阿根廷、德国、巴西三支球队实力最强。从进球数量来看，前3强也是这三支球队，但德国队的数据优势更明显。\n3.3 自2002年以来，32强数据情况\n赢球场数情况\n▼\n进球数据情况\n▼\n分析结论5：\n自2002年以来，32强之间的世界杯比赛，从赢球场数和进球数量来看，德国、阿根廷、巴西三支球队实力最强。其中，德国队的数据优势更明显。\n4、综合结论\n2018年世界杯的32支队伍，根据以往的世界杯比赛数据来看，预测前三强为 德国、阿根廷和巴西，其中德国队应该是夺冠的最大热门。\n特别说明：以上数据分析，纯属个人学习用，预测结果与实际情况可能偏差很大，不能用于其他用途。\n本文是一次比较综合的项目实战，希望可以给大家带来一些启发。\n\n                ", "mainLikeNum": ["0 "], "mainBookmarkNum": "0"}