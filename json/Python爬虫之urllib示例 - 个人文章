{"title": "Python爬虫之urllib示例 - 个人文章 ", "index": "python", "content": "1、最简单：直接抓取页面代码\nimport urllib.request\nimport urllib.error\n\nurl = 'http://test.com/test.html'\ntry:\n    resp = urllib.request.urlopen(url)\nexcept urllib.error.HTTPError as e:\n    print(e.code, e.msg)\nexcept urllib.error.URLError as e:\n    print(e.reason)\nelse:\n    result = resp.read().decode('utf-8')\n    print(result)\n2、使用 Request\nimport urllib.request\nimport urllib.error\n\nurl = 'http://test.com/test.html'\ntry:\n    req = urllib.request.Request(url)  # 构造一个Request对象，推荐\n    resp = urllib.request.urlopen(req)\nexcept urllib.error.HTTPError as e:\n    print(e.code, e.msg)\nexcept urllib.error.URLError as e:\n    print(e.reason)\nelse:\n    result = resp.read().decode('utf-8')\n    print(result)\n3、发送数据，GET\nimport urlib.request\nimport urllib.parse\n\nurl = 'http://test.com/a.php?act=login&id=123'\nreq = urllib.request.Request(url)\nresp = urllib.request.urlopen(req)\n\n# or\n\nurl = 'http://test.com/a.php'\nparams = {\n    'act': 'login',\n    'id': 123,\n    'name': u'张三'\n}\ngeturl = url + '?' + urllib.parse.urlencode(params)\nreq = urllib.request.Request(geturl)\nresp = urllib.request.urlopen(req)\n\nprint(resp.read().decode('utf-8'))\n# {\"act\":\"login\",\"name\":\"\\u5f20\\u4e09\",\"id\":\"123\"}\n4、发送数据，POST\nimport urllib.request\nimport urllib.parse\n\nurl = 'http://test.com/a.php'\nparams = {\n    'act': 'login',\n    'login[name]': u'张三',\n    'login[password]': '123456'\n}\ndata = urllib.parse.urlencode(params).encode('utf-8')\n\nreq = urllib.request.Request(url, data)\nresp = urllib.request.urlopen(req)\n\nprint(resp.read().decode('utf-8'))\n# {\"act\":\"login\",\"login\":{\"password\":\"123456\",\"name\":\"\\u5f20\\u4e09\"}}}\n5、发送数据和header\nimport urllib.request\nimport urllib.parse\n\nurl = 'http://test.com/a.php'\nparams = {\n    'act': 'login',\n    'login[name]': u'张三',\n    'login[password]': '123456'\n}\ndata = urllib.parse.urlencode(params).encode('utf-8')\n\nheaders = {\n    'User-Agent': 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) '\n                  'Chrome/54.0.2840.99 Safari/537.36',\n    'Referer': 'http://www.baidu.com',\n    'haha': 'xixi'\n}\n\nreq = urllib.request.Request(url, data, headers)\nresp = urllib.request.urlopen(req)\n\nprint(resp.read().decode('utf-8'))\n\n                ", "mainLikeNum": ["0 "], "mainBookmarkNum": "1"}