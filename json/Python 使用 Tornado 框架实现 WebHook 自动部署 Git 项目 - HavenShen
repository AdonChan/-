{"title": "Python 使用 Tornado 框架实现 WebHook 自动部署 Git 项目 - HavenShen ", "index": "自动部署,git,webhooks,tornado,python", "content": "gohook\nPython 使用 Tornado 框架实现 WebHook 自动部署 Git 项目\n为了方便开发测试或项目部署至服务器不那么繁琐，搞一个自动部署的小轮子也是必要的。\n小轮子需要涉及到 Coding 项目托管平台(也可以用 Github 平台)，Linux服务器的Nginx、Python( Tornado框架 )。\n同时配置项目托管平台的个人私钥或项目公钥，保证 git pull 能直接拉取。\nGitHub 传送门: https://github.com/HavenShen/gohook\n安装\n1.下载或克隆此项目\ngit clone git@github.com:HavenShen/gohook.git\n2.部署代码的服务器必须安装 Python 的 Tornado框架\npip install tornado\n#或\neasy_instal tornado\n修改配置\n1.修改 main.py 中 file_path 变量路径\n#希望自动部署项目路径\nfile_path = '/home/wwwroot/xxx'\n2.配置 Nginx 的conf文件\n# http 节点下增加\nupstream frontends{\n        server 127.0.0.1:8765;\n    }\n    \n#增加 server 配置\nserver {\n    listen 80;\n\n    server_name xxx.xxx.com; #你的域名\n\n    location / {\n            proxy_pass_header Server;\n            proxy_set_header Host $http_host;\n            proxy_redirect off;\n            proxy_set_header X-Real-IP $remote_addr;\n            proxy_set_header X-Scheme $scheme;\n            proxy_pass http://frontends;\n    }\n}\n在此可以重启下 Nginx\n启动\n1.运行tornado框架开启后台进程运行\n#下面路径修改成你自己gohook存放目录文件夹用户组必须跟nginx一致\nsetsid python /home/wwwroot/gohook/main.py &\n配置 Coding 项目 WebHook\n1.url 填你的域名 http://xxx.xxx.com/gohook\n2.token 填 gohook\n测试\n1.本地于服务器自动部署的git项目中使用 git 提交更新一下代码\ntouch test.md\ngit add .\ngit commit -m \"test gohook\"\ngit push -u origin master \n2.查看服务器上自动部署的git项目中是否存在 test.md\ndone.\n\n                ", "mainLikeNum": ["2 "], "mainBookmarkNum": "19"}