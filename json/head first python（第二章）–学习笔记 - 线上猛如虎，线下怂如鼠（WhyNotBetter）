{"title": "head first python（第二章）–学习笔记 - 线上猛如虎，线下怂如鼠（WhyNotBetter） ", "index": "python", "content": "head first python（第二章）--学习流程图\n\n1.函数转换为模块\n\n函数转换为模块后，就可以灵活的使用模块，方便代码分类，避免代码堆积在一个文件上。当你写的python代码达到一定数量并且功能开始丰富的时候，就必须要这么做了。而模块会存在python本地副本目录里面，所以需要打包，需要安装模块到副本目录，以便python解释器能够找到模块，然后使用。\n\npython搜索模块的目录位置：（大致需要知道就行了）\n\npython\n\nPython 2.6.6 (r266:84292, Jan 22 2014, 09:37:14) \n[GCC 4.4.7 20120313 (Red Hat 4.4.7-4)] on linux2\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n>>> import sys\n>>> sys.path\n['', '/usr/lib/python26.zip', '/usr/lib/python2.6', '/usr/lib/python2.6/plat-linux2', '/usr/lib/python2.6/lib-tk', '/usr/lib/python2.6/lib-old', '/usr/lib/python2.6/lib-dynload', '/usr/lib/python2.6/site-packages']\n>>> \n\n\n1.1 创建目录和文件\n\n创建目录nester\n\nmkdir nester\n\n\n进入nester目录并创建nester.py 和setup.py\n\ncd netster\n\nvi nester.py\n\n\"\"\"This is the \"nester.py\" module and it provides one function called print_lol() \n    which prints lists that may or may not include nested lists.\"\"\"\n\ndef print_lol(the_list):\n    \"\"\"This function takes one positional argument called \"the_list\", which \n        is any Python list (of - possibly - nested lists). Each data item in the \n        provided list is (recursively) printed to the screen on it’s own line.\"\"\"\n\nfor each_item in the_list:\n    if isinstance(each_item, list):\n        print_lol(each_item)\n    else:\n        print(each_item)\n\n\nnester.py代码模块文件，格式要严谨，不必加上其他的东西。\n\nvi setup.py\n\nfrom distutils.core import setup\n\nsetup( \n    name         = 'nester', \n    version      = '1.0.0', \n    ## TODO: be sure to change these next few lines to match your details!\n    py_modules   = ['nester'],\n    author       = 'hfpython',\n    author_email = 'hfpython@headfirstlabs.com',\n    url          = 'http://www.headfirstlabs.com',\n    description  = 'A simple printer of nested lists',\n )\n\n\nsetup.py是模块发布的元文件metafile，里面包含模块的一些发布信息。按照格式和要求编写即可。\n\n1.2 使用python setup.py sdist命令打包代码，生成发布包\n\npython setup.py sdist\nrunning sdist\nwarning: sdist: manifest template 'MANIFEST.in' does not exist (using default file list)\nwarning: sdist: standard file not found: should have one of README, README.txt\nwriting manifest file 'MANIFEST'\ncreating nester-1.0.0\nmaking hard links in nester-1.0.0...\nhard linking nester.py -> nester-1.0.0\nhard linking setup.py -> nester-1.0.0\ncreating dist\ntar -cf dist/nester-1.0.0.tar nester-1.0.0\ngzip -f9 dist/nester-1.0.0.tar\ntar -cf dist/nester-1.0.0.tar nester-1.0.0\ngzip -f9 dist/nester-1.0.0.tar\nremoving 'nester-1.0.0' (and everything under it)\n\n\n打包后会生成目录dist和文件MANIFEST\n\n├── dist\n│   └── nester-1.0.0.tar.gz\n├── MANIFEST\n├── nester.py\n└── setup.py\n\n\ncat MANIFEST\n\nnester.py\nsetup.py\n\n\n\n  发布后会多了dist目录和MANIFEST文件，这2个是发布的生成的包和相关配置文件。\n\n\n1.3 安装打包代码，即使安装nester模块\n\npython setup.py install\n\nrunning install\nrunning build\nrunning build_py\ncopying nester.py -> build/lib\nrunning install_lib\ncopying build/lib/nester.py -> /usr/lib/python2.6/site-packages\nbyte-compiling /usr/lib/python2.6/site-packages/nester.py to nester.pyc\nrunning install_egg_info\nRemoving /usr/lib/python2.6/site-packages/nester-1.0.0-py2.6.egg-info\nWriting /usr/lib/python2.6/site-packages/nester-1.0.0-py2.6.egg-info\n\n\n安装后\n\n.\n├── build\n│   └── lib\n│   └── nester.py\n├── dist\n│   └── nester-1.0.0.tar.gz\n├── MANIFEST\n├── nester.py\n└── setup.py\n\n\n\n  安装后悔出现build目录，这个就是用发布包解压出来的库和模块代码，会统一放到python的模块搜索目录里面去。\n\n\n1.4 模块使用的时候就是import nester\n\n不过出现了错误\n\n>>> import nester\n>>> print_lol(a)\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\nNameError: name 'print_lol' is not defined\n>>> \n\n\n\n  是因为命名空间的关系,主python程序中（以及idle shell中）的代码与一个名为main的命名空间关联。所以的话不能直接使用print_lol，而要加上命名空间nester.print_lol()\n\n\n知识点：\n\n1.命名空间是为了让python解释器就会知道去哪里找这个函数，命名空间格式：首先是模块名字，然后是一个点号，再后面是函数名。\n\n2.如果使用from nester import print_lol,就会把指定的函数print_lol增加到当前命名空间中，这样就不用加上命名空间来调用函数了。\n\n\n\n2.用额外的参数控制行为（需要对嵌套列表进行缩进）\n\n这样可以增加功能而不用增加多余函数代码（print_lol2）。\n\n\n  写新代码之前先考虑BIF（内置函数）\n\n\n\n  rang() 返回一个迭代器，根据需要生成一个指定范围的数字。\n\n\n根据需求写了这样的代码，但运行报错\n增加了一个level参数，默认等于0，遇到嵌套列表就是用rang（level）来进行缩进\n\ndef print_lol(a_list, level=0):\n    \"\"\"Prints each item in a list, recursively descending\n    into nested lists (if necessary).\"\"\"\n\nfor each_item in a_list:\n    if isinstance(each_item, list):\n        print_lol(each_item, level)\n    else:\n        for l in range(level):\n            print(\"\\t\", end='')\n        print(each_item)\n\n\n出现错误了：TypeError:print_lol() take exactly 2 positional arguments (1 given)\n\n原因是print_lol需要2个参数，目前只有一个。\n\n要改成\n\ndef print_lol(a_list, level=0):\n    \"\"\"Prints each item in a list, recursively descending\n    into nested lists (if necessary).\"\"\"\n\nfor each_item in a_list:\n    if isinstance(each_item, list):\n        print_lol(each_item, level+1)  #因为不加1的话函数调用还是会出现level=0，就没有意义了\n    else:\n        for l in range(level):\n            print(\"\\t\", end='')\n        print(each_item)\n\n\n然后更新代码发布包\n\nfrom distutils.core import setup\n\nsetup( \n    name         = 'nester', \n    version      = '1.1.0',     #这里改成1.1.0了，更新了新代码版本\n    ## TODO: be sure to change these next few lines to match your details!\n    py_modules   = ['nester'],\n    author       = 'hfpython',\n    author_email = 'hfpython@headfirstlabs.com',\n    url          = 'http://www.headfirstlabs.com',\n    description  = 'A simple printer of nested lists',\n )\n\n\n\n3.改变了API\n\n因为增加了level参数，改变了默认的行为（最原始的默认行为不想要缩进），导致打印出来的格式有异常，需要再增加一个可选参数，来控制缩进功能的使用。\n\n增加一个indent参数来控制缩进是否打开\n\ndef print_lol(a_list, indent=False, level=0):\n    \"\"\"Prints each item in a list, recursively descending\n    into nested lists (if necessary).\"\"\"\n\nfor each_item in a_list:\n    if isinstance(each_item, list):\n        print_lol(each_item, indent, level+1)\n    else:\n        if indent:\n            for l in range(level):\n                print(\"\\t\", end='')\n        print(each_item)\n\n\n\n  需要注意的是所有代码如果不是idel中运行的话，都需要加上#!/usr/bin/python在顶部。\n\n\n\n原文链接：http://www.godblessyuan.com/2015/04/13/head_first_python_chapter_2_lea...\n\n                ", "mainLikeNum": ["0 "], "mainBookmarkNum": "6"}