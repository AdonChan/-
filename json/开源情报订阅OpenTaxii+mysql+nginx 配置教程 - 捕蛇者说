{"title": "开源情报订阅OpenTaxii+mysql+nginx 配置教程 - 捕蛇者说 ", "index": "python,mysql,nginx", "content": "转自我的博客\n安装过程中注意点\n\n官方给出的service.yml配置文件中默认使用https作为请求方式，所以如果不能提供https服务的话，请注释掉\nopentaxii默认安装是0.1.9，但是0.1.9有个关于格式的问题，所以，如果实际环境中发现无法push 和pull 数据，请使用0.1.8版本\n经测试，opentaxii+mysql 不如 opentaxii+sqllite的性能，很是奇怪。所以实际使用过程中可以都测试看看。\n\n环境需求：\npython版本：2.7,3.4pip:python包管理工具mysql: 无版本需求nginx: 无版本需求\n安装步骤：\n\npip install taxii gunicorn\n创建mysql数据库:taxii_data,taxii_auth\n修改配置文件taxii.yml文件，9行和15行里的mysql连接信息配置\n修改配置文件taxii.yml第一行域名为实际的域名\n运行命令export OPENTAXII_CONFIG=taxii.yml文件的路径\n根据实际的情况，修改service.yml和collections.yml\n创建服务：opentaxii-create-services -c services.yml\n创建集合：opentaxii-create-collections -c collections.yml\n添加一个用户名密码：opentaxii-create-account -u username -p password\n运行opentaxii(注意修改日志路径):gunicorn opentaxii.http:app --workers 2 --log-level debug --log-file /home/worker/log/opentaxii.log --timeout 30 --bind 0.0.0.0:19000 -D\n\n测试安装是否成功\n\npip install cabby\ntaxii-discovery --path http://localhost:9000/service...：discovery-a为service.xml里配置的discovery，没有输出错误信息，则成功\ntaxii-collections --path http://localhost:9000/service...为service.xml里配置的collection_management，没有输出错误信息，则成功\n\nHTTPS配置\n\n准备好https证书\n生成dbparam：openssl dhparam -out dhparam.pem 2048\n\nnginx 增加server配置如下(注意修改 cert.pem,cert.key,ssl_dhparam,access_log,error_log配置项的文件路径)：\nserver {\nlisten 443 ssl;\nserver_name taxii.example.com;\nssl_certificate      /usr/local/nginx/ssl/cert.pem;\nssl_certificate_key  /usr/local/nginx/ssl/cert.key;\nssl_protocols TLSv1 TLSv1.1 TLSv1.2;\nssl_ciphers \"ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA256:ECDHE-RSA-AES256-SHA:ECDHE-RSA-AES128-SHA:DHE-RSA-AES256-SHA256:DHE-RSA-AES128-SHA256:DHE-RSA-AES256-SHA:DHE-RSA-AES128-SHA:ECDHE-RSA-DES-CBC3-SHA:EDH-RSA-DES-CBC3-SHA:AES256-GCM-SHA384:AES128-GCM-SHA256:AES256-SHA256:AES128-SHA256:AES256-SHA:AES128-SHA:DES-CBC3-SHA:HIGH:!aNULL:!eNULL:!EXPORT:!DES:!MD5:!PSK:!RC4\";\nssl_prefer_server_ciphers on;\nssl_session_cache shared:SSL:10m;\n\naccess_log  /var/log/nginx/taxii_access.log;\nerror_log  /var/log/nginx/taxii_error.log;\nlocation / {\n    proxy_pass http://127.0.0.1:19000;\n    proxy_set_header Host $host;\n    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n}\n}\n\n重启nginx\n\n\n                ", "mainLikeNum": ["0 "], "mainBookmarkNum": "1"}