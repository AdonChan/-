{"title": "[新手开源] 爬取韩寒“一个”文章且自动邮件发送功能 - 学无止尽 ", "index": "ubuntu,linux,python", "content": "源码地址：https://github.com/xcc3641/pySendOneToEmail\n准备\n\n一台云服务器\n写好的Python脚本\n\n效果\n因为现在“一个”的Android客户端启动越来越慢，而且很多自己不感兴趣的东西（我只是想看看文章），所以就写了这个小爬虫。它可以在“一个”更新后把我要的内容发到我的邮箱里。\n放在云服务器里，所以不用担心电费啊其他问题~\n实践\n云服务器\n自己配置的是阿里云的服务器，学生特惠9.9，Ubuntu系统。这个系统自带了Python2.7环境，所以不用自己手动去安装。\n本地是用的Window10系统，最好安装下SecureCRSecureFXPortable。远程连接自己的服务器，而且命令行和文件操作会简便很多。\n因为“一个”是每天22点会更新，所以自己的服务器要做一个定时服务，ubuntu下自带了Crontab定时任务。\n配置Crontab\n\n\n加入需要执行的脚本\ncrontab -e\n1 22 * * * 路径/python 路径/xxx.py\n保存重启 /etc/init.d/cron restart\n\nPython最好写全路径，这是一个坑\n需要在root用户下进行\n具体的Crontab可以参考Crontab\n\nPython代码\n这里主要是用到了python自带的邮件服务的库和第三方网络解析库，代码量不多而且也不难，有编程基础的很容易学会。\n邮件相关\n邮件类库\n   from email.mime.multipart import MIMEMultipart\n   from email.header import Header\n   from email.mime.text import MIMEText\n   from email.utils import parseaddr, formataddr\n   import smtplib\n配置邮件&发送邮件的关键代码\n    msg = MIMEMultipart()\n\n    msg['From'] = _format_addr(u'Xie CC <%s>' % from_addr)\n    msg['To'] = _format_addr(u'管理员 <%s>' % to_addr)\n    msg['Subject'] = Header(u'The One    ' + title, 'utf-8').encode()\n\n    msg.attach(MIMEText('<html><body><div style=\"text-align: center;\"><p><img src=\"' + img + '\"></p></div>' +\n                        '<p style=\"text-align:center;\\\"> <br /><br /><strong><span style=\"font-size:14px;\\\">' + text +\n                        '</span></p><br /><br /><br /><br /><br />' + story + '</body></html>', 'html', 'utf-8'))\n\n    server = smtplib.SMTP(smtp_server, 25)\n    server.set_debuglevel(1)\n    server.login(from_addr, password)\n    server.sendmail(from_addr, [to_addr], msg.as_string())\n    server.quit()\n这里自己就不详细介绍这个库，具体可以参考这个教程，Python不是很难理解.\n爬取信息\n类库\n   import requests\n   from bs4 import BeautifulSoup\n有一次用urllib，urllib2发现会遇到各种编码问题需要自己去解决，特别烦人。然后转到了requests这个库，完全没有遇到像url那样恶心的编码问题，而且很多需求都可以满足，所以后面爬静态网页都习惯用这个库了。\n以前还是蛮喜欢用正则的，这次就学习了下bs4的用法，感觉还是挺容易上手的。具体的实现都不难，都是基础的爬虫知识，而且“一个”并没有反爬虫的设定，所以蛮适合初学者的。\n用工具方便自己，我觉得这就是自己编程的意义，这让我很开心。\n\n                ", "mainLikeNum": ["0 "], "mainBookmarkNum": "9"}