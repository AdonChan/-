{"title": "第一个网络爬虫-抓取CodeSnippet代码片段 - 用Python写网络爬虫 ", "index": "windows,visual-studio-code,flask,python", "content": "CodeSnippet 抓取代码片段\n目标\n抓取CodeSnippet中的代码片段\n\n分析\n\n代码\n<body>\n    <div id=\"container\">\n        <div class=\"content bor round\">\n            <ul>\n                <li class=\"con-logo bbor\">\n                    <a href=\"http://www.codesnippet.cn/index.html\" title=\"分享你的世界\"></a>\n                </li>\n                <li class=\"con-code bbor\">\n                    <pre class=\"brush:php;\">\n                    <!--代码块-->\n                    </pre>\n                </li> \n                <li class=\"con-btn bbor\">\n                    <ul>\n                        <li><a href=\"http://www.codesnippet.cn/pcode.html\" class=\"button\">发布代码片段</a></li>\n                        <li><a href=\"http://www.codesnippet.cn/list.html\" class=\"button\">片段列表</a></li> \n                    </ul>\n                    <br class=\"clearfloat\" />\n                </li>\n                <li class=\"con-motto bbor\">\n                    <div>一个线程如果是个人英雄主义，那么多线程就是集体主义，你不再是一个独行侠，而是一个指挥家。</div>\n                </li>\n                <li class=\"con-count bbor\">\n                    <div>\n                        共有<span> {15106} </span>个代码片段 \n                    </div>  \n                </li> \n                <li class=\"con-copyright\">\n                    <div>京ICP备13038605号 \n                        <script src=\"http://s14.cnzz.com/stat.php?id=4720394&web_id=4720394\" language=\"JavaScript\"></script> \n                    </div>  \n                </li> \n            </ul>\n        </div>\n    </div> \n</body>\n\n我们想要抓取的内容在为 li class=\"con-code bbor\" 所以 BeautifulSoup find()方法获取到该标签然后获取其文本内容\n准备\n准备我们爬虫比用的两个模块\nfrom urllib2 import urlopen\n\nfrom bs4 import BeautifulSoup\n编写抓取代码\n# 抓取http://www.codesnippet.cn/index.html 中的代码片段\n\ndef GrapIndex():\n    html = \"http://www.codesnippet.cn/index.html\"\n    bsObj = BeautifulSoup(urlopen(html), 'html.parser')\n    return bsObj.find(\"li\",  {\"class\":\"con-code bbor\"}).get_text()\n\n当我们抓取到我们想要的数据之后接下来要做的就是把数据写到数据库里，由于我们现在抓取数据简单，所以只写文件即可！\ndef SaveResult():\n    codeFile=open(\"code.txt\", \"a\") # 追加\n    for list in GrapIndex():\n        codeFile.write(list)\n    codeFile.close()\n\n当我们在写文件的时候出现了以下错误，而下面这个错误的造成原因则是由于python2.7是基于ascii去处理字符流，当字符流不属于ascii范围内，就会抛出异常（ordinal not in range(128)）\nUnicodeEncodeError: 'ascii' codec can't encode character u'u751f' in position 0: ordinal not in range(128)\n分析\npython2.7是基于ascii去处理字符流，当字符流不属于ascii范围内，就会抛出异常（ordinal not in range(128)）\n解决办法\nimport sys\nreload(sys)\nsys.setdefaultencoding('utf-8')\n完整代码展示\nfrom urllib2 import urlopen\n\nfrom bs4 import BeautifulSoup\n\nimport os\nimport sys\nreload(sys)\nsys.setdefaultencoding('utf-8')\n\ndef GrapIndex():\n    html = \"http://www.codesnippet.cn/index.html\"\n    bsObj = BeautifulSoup(urlopen(html), 'html.parser')\n    return bsObj.find(\"li\",  {\"class\":\"con-code bbor\"}).get_text()\n\ndef SaveResult():\n    codeFile=open(\"code.txt\", \"a\")\n    for list in GrapIndex():\n        codeFile.write(list)\n    codeFile.close()\n\nif __name__ == '__main__':\n    for i in range(0,9):\n        SaveResult()\n\n                ", "mainLikeNum": ["0 "], "mainBookmarkNum": "0"}