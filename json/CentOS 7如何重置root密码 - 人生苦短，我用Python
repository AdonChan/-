{"title": "CentOS 7如何重置root密码 - 人生苦短，我用Python ", "index": "python,linux,mysql,人工智能,区块链", "content": "推荐本人的《Python 自动化运维实战》课程，提供在线实验环境，边敲代码边学习。\n搬砖过程中杂七杂八的环境和配置问题，每次总能碰到不一样的错误。Google一下发现别人能解决的方法不一定适合你。这次我遇到问题的环境是：\nWindows 10 企业版 2016 LTSVMware® Workstation 14 Pro 14.1.0 build-7370693\nCentOS Linux release 7.5.1804 (Core)\n\nVMWare中安装的CentOS 7 root密码忘记了，于是只能重置\n一、启动客户机\n\n进入如上界面之后按e，然后进入如下界面\n\n二、修改启动文件\n光标往下，找到Linux16，ro的位置\n\n将ro改成rw init=/sysroot/bin/sh，按Ctrl + x重新启动。\n这里说明一下，有的教程说改成rw init=/bin/sh，反正我是没成功！改成rw init=/bin/sh之后重启客户机报错如下\n\n说我BIOS使hw-PMU资源奔溃，客户机操作系统已禁用CPU。请关闭或重置虚拟机。于是按照这个报错去Google了好久，说是Windows系统没有开启CPU虚拟化，于是重启笔记本进入BIOS\n\n发现Intel virtualization Technology是开启，问题越扯越离谱，还是改成rw init=/sysroot/bin/sh吧！\n三、重新启动\n重启客户机后进入如下界面，执行chroot /sysroot\n\n执行passwd root更改root用户密码\n:/# passwd root\nChanging password for user root\nNew password:\nRetype new password:\npasswd: Authentication token manipulation error\n四、更新/etc/shadow\n如果有报错提示Authentication token manipulation error，表示root密码更改失败，正确答案在这里。因为没有/etc/shadow文件，如图\n\n只有gshadow和gshadow-。通过pwconv重新生成shadow文件，并设置权限为-rw-r-----\n\n五、重新挂载root分区\nmount -o remount,rw /\n此时再更改root密码，发现可以了\n:/# passwd root\nChanging password for user root\nNew password:\nRetype new password:\npasswd: all authentication tokens updated successfully\n\n重启客户机登录成功！\n推荐本人的《Python 自动化运维实战》课程，提供在线实验环境，边敲代码边学习。\n\n                ", "mainLikeNum": ["12 "], "mainBookmarkNum": "8"}