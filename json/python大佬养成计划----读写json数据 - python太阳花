{"title": "python大佬养成计划----读写json数据 - python太阳花 ", "index": "python", "content": "json\n使用 Python 语言来编码和解码 JSON 对象。JSON(JavaScript Object Notation) 是一种轻量级的数据交换格式，易于人阅读和编写。使用json函数需要导入json模块\njson.dumps\n将 Python 对象编码成 JSON 字符串\njson.loads\n用于解码 JSON 数据。该函数返回 Python 字段的数据类型。\n基础命令\n将python对象编码成为json的字符串格式\nd = {'name':'sheen',\n     'age':17}\njsonStr = json.dumps(d) #{\"name\": \"sheen\", \"age\": 17} <class 'str'>\n\nl = [1,3,5,1.2]\njsonList = json.dumps(l)    #[1, 3, 5, 1.2] <class 'str'>\n将获取的json字符串解码为python的对象\npydict = json.loads(jsonStr)    #{'name': 'sheen', 'age': 17} <class 'dict'>\n\npylist = json.loads(jsonList)   #[1, 3, 5, 1.2] <class 'list'>\n将python对象编码成为json的字符串格式并写入文件中\nwith open('json.txt','w') as f :\n    json.dump(d,f)\n将文件中的json字符串解码为python的对象\nwith open('json.txt') as f:\n    jsondict = json.load(f) #{'name': 'sheen', 'age': 17} <class 'dict'>\njson示例\n给100个不同的用户一个value值，存放到文件'json_dump.txt'，并且是json格式json.dump()参数\nindent\n应该是一个非负的整型，如果是0，或者为空，则一行显示数据；否则会换行且按照indent的数量显示前面的空白\nsort_keys\n将数据根据keys的值进行排序\nseparators = (\"每个元素间的分隔符\"， “key和value之间的分隔符”)\n#给100个不同的用户一个value值\n#存放到文件'json_dump.txt'，并且是json格式\nimport json\nimport string\nfrom random import choice\n\nkeys = ['user'+str(i) for i in range(100)]\nvalues = string.ascii_lowercase+string.ascii_uppercase  #大小写字符串\n\ndict = {choice(keys):choice(values) for i in range(100)}\n\nwith open('json_dump.txt','w') as f:\n    #indent：应该是一个非负的整型，如果是0，或者为空，则一行显示数据；否则会换行且按照indent的数量显示前面的空白\n    #sort_keys：将数据根据keys的值进行排序\n    #separators = (\"每个元素间的分隔符\"， “key和value之间的分隔符”)\n    json.dump(dict,f,indent=4,sort_keys=True, separators=(';', '='))\n\n\n#为何最后文件不够100行？\n#因为随机选取的key值可能会重复，字典类型的key不允许重复，最后得到的数据会少于你给定的100次\n\n查询IP地址\n根据IP查询所在地、运营商等信息的一些API如下：\n1. 淘宝的API（推荐）：http://ip.taobao.com/service/getIpInfo.php?ip=110.84.0.129\n2. 国外freegeoip.net（推荐）：http://freegeoip.net/json/110.84.0.129 这个还提供了经纬度信息（但不一定准）\n3. 新浪的API：http://int.dpool.sina.com.cn/iplookup/iplookup.php?format=json&ip=110.84.0.129\n4. 腾讯的网页查询(返回的非json格式): http://ip.qq.com/cgi-bin/searchip?searchip1=110.84.0.129\n5. ip.cn的网页（返回的非json格式）：http://www.ip.cn/index.php?ip=110.84.0.129\n6. ip-api.com： http://ip-api.com/json/110.84.0.129\n\n上述的API接口，大多有一个特点是， 返回的直接是个json格式\nimport json\nfrom urllib.request import urlopen\n\n# ip = input(\"请输入你要查询的Ip:\")\nip = '8.8.8.8'\nurl = \"http://ip.taobao.com/service/getIpInfo.php?ip=%s\" %(ip)\nprint(url)\n# 根据url获取网页的内容， 并且解码为utf-8格式， 识别中文;\ntext = urlopen(url).read().decode('utf-8')\n# print(text,type(text))\ndata = json.loads(text)['data']\ncountry = data['country']\ncountry_id = data['country_id']\nprint(country,country_id)\n\n\n\n                ", "mainLikeNum": ["1 "], "mainBookmarkNum": "1"}