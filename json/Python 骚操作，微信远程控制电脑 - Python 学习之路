{"title": "Python 骚操作，微信远程控制电脑 - Python 学习之路 ", "index": "python", "content": "\n阅读文本大概需要 5 分钟。\n今天带给大家一个非常有意思的 python 程序，基于 itchat 实现微信控制电脑。你可以通过在微信发送命令，来拍摄当前电脑的使用者，然后图片会发送到你的微信上。甚至你可以发送命令来远程关闭电脑。\n\n应用场景\n你可爱又迷人的女朋友，在看到这篇教程之后，非常的开心。在你的电脑上部署了这个脚本，并且在你不知情的情况下，默默的登录上。随后跟你说我出去跟闺蜜逛街啦，今天就不陪你了。要记得不准吃鸡。\n你心想老子终于可以放松一天了！开心的吃鸡！口上说着：“好的！亲爱的玩得开心！”等着女朋友出门以后，你就开启了吃鸡模式，在绝地求生里大开杀戒。\n你的女朋友早已对你了如指掌，通过脚本，先让电脑截图留下现场证据，随后再打电话质问你是否在吃鸡，你如果撒谎就把电脑远程关机。\n最后你想了下不对我没有女朋友啊，随后你转头微笑地看着你的室友。\n程序思路\n此次程序使用的环境是 python3.6 + windows10，在运行程序之前请先确保你已经安装好了 opencv-python 和 matplotlib。通过 pip install 即可安装。\n程序主要是通过使用 itchat 库来登录到微信网页端，然后通过 itchat 来发送消息和接收消息。并通过 opencv 来调用电脑的摄像头，把当前使用电脑的用户拍照下来，发送到你的微信上。至于远程关机是通过调用 os 库，发送 cmd 命名即可实现。\n程序源码\nimport itchat\nimport os\nimport time\nimport cv2\n\nsendMsg = u\"{消息助手}：暂时无法回复\"\nusageMsg = u\"使用方法：\\n1.运行CMD命令：cmd xxx (xxx为命令)\\n\" \\\n           u\"-例如关机命令:\\ncmd shutdown -s -t 0 \\n\" \\\n           u\"2.获取当前电脑用户：cap\\n3.启用消息助手(默认关闭)：ast\\n\" \\\n           u\"4.关闭消息助手：astc\"\nflag = 0 #消息助手开关\nnowTime = time.localtime()\nfilename = str(nowTime.tm_mday)+str(nowTime.tm_hour)+str(nowTime.tm_min)+str(nowTime.tm_sec)+\".txt\"\nmyfile = open(filename, 'w')\n\n@itchat.msg_register('Text')\ndef text_reply(msg):\n    global flag\n    message = msg['Text']\n    fromName = msg['FromUserName']\n    toName = msg['ToUserName']\n\n    if toName == \"filehelper\":\n        if message == \"cap\":\n            cap = cv2.VideoCapture(0)\n            ret, img = cap.read()\n            cv2.imwrite(\"weixinTemp.jpg\", img)\n            itchat.send('@img@%s'%u'weixinTemp.jpg', 'filehelper')\n            cap.release()\n        if message[0:3] == \"cmd\":\n            os.system(message.strip(message[0:4]))\n        if message == \"ast\":\n            flag = 1\n            itchat.send(\"消息助手已开启\", \"filehelper\")\n        if message == \"astc\":\n            flag = 0\n            itchat.send(\"消息助手已关闭\", \"filehelper\")\n    elif flag == 1:\n        itchat.send(sendMsg, fromName)\n        myfile.write(message)\n        myfile.write(\"\\n\")\n        myfile.flush()\n\nif __name__ == '__main__':\n    itchat.auto_login()\n    itchat.send(usageMsg, \"filehelper\")\n    itchat.run()\n程序并不复杂，定义了一些发送的消息，然后通过调用 itchat 和 cv2 相关库的操作，即可实现。关于 itchat 库的一些操作，可以去网上找相关的文档。\n使用教程\n获取源代码，然后在你的电脑上运行。随后会弹出一个微信网页登录的二维码。\n\n使用你的手机微信扫描登录，等待一会儿，微信文件助手就会收到相应操作信息。\n\n发送消息「cmd shutdown -s -t 0」即可让当前的电脑关闭。\n发送消息「cap」即可调用电脑摄像头拍摄当前用户，然后把图片发送到微信上。\n当然 cmd 命名还可以做更多有趣的事，大家可以自己去网上搜索下。\n这波骚操作学会了吗？明天会继续更新新的骚操作「Python 发一个高逼格的朋友圈」。\n本文首发于公众号「痴海」，后台回复「1024」即可获取最新编程资源。\n推荐阅读：\n史上最全 Python 学习资料，PDF 电子书大合集\n\n\n                ", "mainLikeNum": ["1 "], "mainBookmarkNum": "1"}