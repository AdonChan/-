{"title": "Condition 实现消费者生产者 - python学习 ", "index": "python", "content": "# -*- coding:utf-8 -*-\n\"\"\" Created by FizLin\n     https://github.com/Fiz1994\n\"\"\"\n\n# Consume one item\n# with cv:\n#     while not an_item_is_available():\n#         cv.wait()\n#     get_an_available_item()\n#\n# # Produce one item\n# with cv:\n#     make_an_item_available()\n#     cv.notify()\n\n\nfrom threading import Thread, Condition\nimport time\n\nqueue = []\nMAX_NUM = 10\ncondition = Condition()\n\ndef producer():\n    global queue\n    while True:\n        condition.acquire()\n        if len(queue) <= 0:\n            # 生产\n            queue.extend([i for i in range(10)])\n            print('生成数据，通知消费者 现在条数:', len(queue))\n            condition.notify()\n            condition.wait()\n        else:\n            print('生产者判断现在含有的数据: 大于0 不需要再生产', len(queue))\n            condition.notify()\n\n        condition.release()\n        time.sleep(1)\n\n\ndef consumer():\n    global queue\n    while True:\n        condition.acquire()\n        if len(queue) <= 0:\n            print('消费者无法消费到数据，处于等待状态')\n            condition.wait()\n        else:\n            print('消费数据：', queue.pop(0))\n            time.sleep(1)\n            condition.notify()\n        condition.release()\n\n\n\n\np = Thread(target=producer)\nc = Thread(target=consumer)\np.start()\nc.start()\n\n\n\n                ", "mainLikeNum": ["1 "], "mainBookmarkNum": "0"}