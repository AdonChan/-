{"title": "vertibi python 实现 - 个人文章 ", "index": "python", "content": "题目阐释：\nviterbi算法实现。 用python实现viterbi的hidden state 和 表现层的转移\n动态规划问题，归结到\n    相邻两个step之间存在 state转移概率，state2emibission转移概率。\n    计算后可以得到每个step的每个state max_probablity\n    由于step_n依赖于 step_n-1,跟 step_n-2无关，所以可以一直如此往复，得到最后的max_prob\n整个问题抽象为，下一个step依赖于上一个step的所有state，所以只需要计算每一层step的所有state的prbo即可。\n难点：\n三层for循环，为了保留，计算每个step的state的概率，所以要 next_state 嵌套在 source_state之外。\n\n\nstates=['Rainy','Sunny']\nobservations=['walk','shop','clean']\nobservations=('walk','clean','walk')\n\nemission_probability={'Rainy':{'walk':0.1,'shop':0.4,'clean':0.5},\n                   'Sunny': {'walk': 0.6, 'shop': 0.3, 'clean': 0.1}\n                    }\ntrans_probability={'Rainy':{'Rainy':0.7,'Sunny':0.3},\n                     'Sunny':{'Rainy':0.4,'Sunny':0.6}\n                     }\nstart_probability={'Rainy':0.6,'Sunny':0.4}\n\ndef vertibi(states,objservations,start_prob,trans_prob,emi_prob):\n    T={state:[start_prob[state],[state],start_prob[state]] for state in states}\n    for objservation in objservations:\n        U={}\n        for next_state in states:\n            total=0\n            argmax=None\n            valmax=0\n            for source_state in states:\n                prob,v_path,v_prob=T[source_state]\n                p=emi_prob[source_state][objservation]*trans_prob[source_state][next_state]\n                prob*=p\n                v_prob*=p\n\n                if v_prob>valmax:\n                    valmax=v_prob\n                    argmax=v_path+[next_state]\n                    total+=prob\n            U[next_state]=[total,argmax,valmax]\n        T=U\n\n    total = 0\n    argmax = None\n    valmax = 0\n    for state in states:\n        prob, v_path, v_prob=T[state]\n        if v_prob>valmax:\n            argmax=v_path\n            total=prob\n            valmax=v_prob\n    return total,argmax,valmax\n\ntotal,argmax,valmax=vertibi(states,observations,start_probability,trans_probability,emission_probability)\nprint(total)\nprint(argmax)\nprint(valmax)\n\n\n\n\n                ", "mainLikeNum": ["0 "], "mainBookmarkNum": "0"}