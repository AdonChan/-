{"title": "量化交易之股票买卖因子——跳空缺口 - Python量化交易 ", "index": "python", "content": "前言\n跳空缺口是指相邻的两根K线之间出现了没有交易的空白区间，如今日最低价与昨日最高价之间没有重合部分，即向上缺口，或者今日最高价与昨日最低价之间没有重叠部分，即向下缺口。理论上，市场或个股在前一天收盘后如果没有任何消息刺激，次日应当是平开的，但是如果这期间出现突发的利好就会刺激投资者在9:30之前的集合竞价（9:15--9:29）期间挂高价格追买股票，因为他们恐怕挂低了买不到股票，这样便形成了向上的跳空高开，反之跳空低开也是这个道理。但是如果高开低走，跌到昨日最高价之内，回补掉了这个空档，那只能叫跳空高开，不能叫缺口，缺口是指当日价格没有被反向回补。\n\n跳空缺口分类\n股价留下缺口，不仅仅是当日投资者激烈情绪的反映，很多情况下对于判断后市是具有一定意义的。因此，按缺口出现的意义，我们可以将缺口分成普通缺口、突破缺口、中继缺口和衰竭缺口。\n\n普通缺口，在整理形态内出现，价格趋势未脱离形态本身，比如仍处在头肩形、箱形、三角形等形态当中。股价在很短的时间内（一般三五天内）会把缺口补掉。这种缺口出现对中期趋势的方向判断不具有太多价值，仅对短线走势具有一定预测作用。\n突破缺口，某个底部或顶部形态完成之后，比如头肩形、M头或W底、箱体等，缺口突破了重要的支撑或阻力位，这类缺口短期内不会被封闭。突破缺口是趋势反转的信号，因此当我们准确判断该缺口是底部完成之后的向上突破，则应当立即追进股票；反之，当头部形态完成后的向下突破缺口出现，就应当赶紧杀跌出局。\n中继缺口，出现在上涨途中或者下跌中途的缺口。这类缺口前面的涨跌幅度不大，但已经离开底部（或顶部）形态有一段距离，该类缺口出现后股价仍将保持原来方向继续前进，后期前进幅度大致等于前期涨跌幅度。这类缺口的典型特征是成交量放大（尤其向上的中继缺口最为明显），而且短期内股价不会出现反向回补。同时后面股价涨跌速度一般会有所加快，因此这类缺口被有些人称之为“逃逸缺口”。    \n衰竭缺口，出现在股价巨幅拉升或大幅下跌后（比如前期涨跌幅度已经超过50%），是多头（上升趋势）或空头（下降趋势）力量消耗殆尽、涨跌已到尽头的表现，这也是为什么叫它衰竭缺口的原因。这类缺口与突破和中继缺口最大的区别就在于，前两个缺口不会被回补，而衰竭缺口短期内就会被反向补掉。\n\n\n策略实现\n以浙大网新为例，从2017.1.1日至今的历史走势中寻找出跳空缺口，此处为过滤掉夹杂在其中的普通缺口，对跳空缺口重定义为，如果是今天是上涨趋势，今天的最低价格大于昨日收盘价格达到设定的阈值为向上跳空缺口，如果今天是下跌趋势，昨天收盘价格大于今天最高价格达到设定的阈值为向下跳空缺口。\n跳空阈值选择收盘价中位数的1%，大于阈值表明缺口存在很强的支撑或者阻力\njump_threshold = stock.Close.median()*0.01 \n\n计算跳空能力jump_power，由缺口的高度/阈值获得，再次量化支撑或者阻力的大小，正数为向上跳空能量，负数为向下跳空能量\n代码实现如下：\nfor kl_index in np.arange(0, stock.shape[0]):\n    today = stock.ix[kl_index]\n    \"\"\" 检测跳空缺口 \"\"\"\n    if (today.changeRatio > 0) and ((today.Low-today.preClose) > jump_threshold):\n    #向上跳空 (今最低-昨收)/阈值\n        today['jump_power'] = (today.Low-today.preClose)/jump_threshold\n        jump_pd = jump_pd.append(today)\n    elif (today.changeRatio < 0) and ((today.preClose-today.High) > jump_threshold):\n    #向下跳空 (昨收-今最高)/阈值\n        today['jump_power'] = (today.High-today.preClose)/jump_threshold\n        jump_pd = jump_pd.append(today)\nformat = lambda x: '%.2f' % x\njump_pd = jump_pd.applymap(format)\nprint jump_pd.filter(['jump_power','preClose','changeRatio','Close'])\n\n在符合条件的跳空缺口中增加“涨跌幅大于8%”和“成交量大于50万手”条件再次筛选，最终得到2017.8.16日的向上跳空缺口\njump_pd = jump_pd[(np.abs(jump_pd.changeRatio) > 8)&(jump_pd.Volume > 50000000)]#abs取绝对值\n\n\n策略总结\n单纯以筛选后的跳空缺口作为买入因子来分析，此处从走势上可以看出后续上涨幅度达到了32%，但实际交易过程中仍然需要通过多种因子相互联系来制定操作策略，本文仅以此为例来说明量化交易的实现原理和过程。\n\n更多python量化交易内容互动请加微信公众号：PythonQT-YuanXiao\n\n                ", "mainLikeNum": ["0 "], "mainBookmarkNum": "4"}