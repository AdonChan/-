{"title": "CentOS7.4，anaconda3，python3.6，tensorflow环境下gdal的编译和问题解决 - Elam的深度学习笔记 ", "index": "centos7,tensorflow,python", "content": "CentOS7.4，anaconda3，python3.6，tensorflow环境下gdal的编译和问题解决\n\n这是gdal可能会用到的额外的包，按自己需要先提前编译。这里的话我主要用了proj,Libtiff,Geotiff,Geos,Hdf5这5个包，基本能满足需要\n安装步骤\n新建一个安装目录：\ncd /home/Elam\nmkdir gdalsrc\ncd gdalsrc\n编译额外包：\n1.proj\nyum install gcc-c++\nwget http://download.osgeo.org/proj/proj-4.8.0.tar.gz\ntar -zxvf proj-4.8.0.tar.gz \ncd proj-4.8.0\nmkdir build\n./configure --prefix=/home/Elam/gdalsrc/proj-4.8.0/build\n# compile\nmake -j\n# install into build dir\nmake install\n创建一个统一的添加环境变量的文件夹:\ncd /home/Elam/gdalsrc\nmkdir envsh\ncd envsh\nvim export_path.sh\n添加下面两行代码\nexport LD_LIBRARY_PATH=\"/home/Elam/gdalsrc/proj-4.8.0/build/lib:$LD_LIBRARY_PATH\"\nexport PATH=\"/hoem/Elam/gdalsrc/proj-4.8.0/build/bin:$PATH\"\n可以source export_path.sh  然后键入proj看看是否编译成功\n2.libtiff\nyum install gcc-c++ zlib-devel libjpeg-turbo-devel\ncd /home/Elam/gdalsrc\nwget http://download.osgeo.org/libtiff/tiff-4.0.9.tar.gz  最新版本是4.0.9\ntar -zxvf tiff-4.0.9.tar.gz\ncd tiff-4.0.9\nls一下发现build文件夹已经存在，因此不需要重新创建直接configure\n./configure --prefix=/home/Elam/gdalsrc/tiff-4.0.9/build/ \\\n            --exec-prefix=/home/Elam/gdalsrc/tiff-4.0.9/build\nmake -j\nmake check\n# install to build dir\nmake install\n# confirm install\n./build/bin/tiffinfo\n进入刚才创建的export_path添加新的环境变量，如下图：\n\nsource一下\n3.Geotiff\n在gdalsrc目录下\nwget http://download.osgeo.org/geotiff/libgeotiff/libgeotiff-1.4.2.tar.gz\ntar -xvfz libgeotiff-1.4.2.tar.gz \ncd libgeotiff-1.4.2/\nmkdir build\n./configure --prefix=/home/Elam/gdalsrc/libgeotiff-1.4.2/build \\\n            --with-proj=/home/Elam/gdalsrc/proj-4.8.0/build \\\n            --with-libtiff=/home/Elam/gdalsrc/tiff-4.0.9/build \\\n            --with-zlib --with-jpeg\n# compile\nmake -j\n# install into build dir\nmake install\n进入export_path添加新的环境变量，如下图：\n\nsource一下\n4.Geos\nyum install gcc-c++ swig python-devel\ncd /home/Elam/gdalsrc\nwget http://download.osgeo.org/geos/geos-3.6.2.tar.bz2\ntar -xvjf geos-3.6.2.tar.bz2 \ncd geos-3.6.2\nmkdir build\n./configure --prefix=/home/Elam/gdalsrc/geos-3.6.2/build --enable-python\n# compile    \nmake -j$threads\nmake check\n# install into build dir\nmake install\n# check install\n./build/bin/geos-config --version\ngdal编译过程中碰到的问题主要出现在编译这个库中\n错误:\n./configure --prefix=/home/Elam/gdalsrc/geos-3.6.2/build --enable-python\nconfigure出现cannot find Python library path错误:\n\n解决方法：vim configure在左下角输入/cannot find Python library path回车找到对应行附近将libpython$PYTHOH_VERSION改成你自己对应的.so和.a版本（具体版本可以到上面include路径同一路径下lib文件夹中查看）如上 我改成了libpython3.6m修改后：wq重新configure\n\n继续修改configure文件\n\n重新configure如果后续还报/usr/bin/ld: cannot find -lpython3.6错误继续修改\n\n重新configure然后继续\nmake –j  \nmake check\nmake install\n添加新的环境变量\n\nsource\n5.hdf5\nyum install gcc-c++ zlib-devel\ncd /home/Elam/gdalsrc\nwget http://www.hdfgroup.org/ftp/HDF5/current/src/hdf5-1.8.11.tar.gz\ntar xvfz hdf5-1.8.11.tar.gz\ncd hdf5-1.8.11\ntouch release_docs/INSTALL_VMS.txt\nmkdir build\nCFLAGS=-O0 \\\n./configure \\\n  --prefix=/home/Elam/gdalsrc/hdf5-1.10.1/build \\\n  --enable-shared \\\n  --enable-build-all \\\n  --with-zlib \\\n  --with-pthread \\\n  --enable-cxx \\\n# compile\nmake -j\n# test build -- all tests should pass\nmake -j check\n# install into build dir\nmake install\n添加新的环境变量，注意这里还有include文件夹\n\ngdal编译\n我从网上下了一个2.3.0版本的，网址：http://download.osgeo.org/gdal/\nyum install subversion gcc-c++ sqlite-devel libxml2-devel python-devel numpy swig expat-devel libcurl-devel xerces-c-devel unixODBC-devel postgresql postgresql-devel\ncd /home/Elam/gdalsrc\ntar -zxvf gdal-2.3.0.tar.gz\ncd gdal-2.3.0\nmkdir build\n./configure \\\n--prefix=/home/Elam/gdalsrc/gdal-2.3.0/build \\\n--with-jpeg=external \\\n--without-libtool \\\n--with-python=/usr/local/anaconda3/bin/python \\\n--with-static-proj4=/home/Elam/gdalsrc/proj-4.8.0/build \\\n--with-libtiff=/home/Elam/gdalsrc/tiff-4.0.9/build \\\n--with-geotiff=/home/Elam/gdalsrc/libgeotiff-1.4.2/build \\\n--with-geos=/home/Elam/gdalsrc/geos-3.6.2/build/bin/geos-config \\\n--with-hdf5=/home/Elam/gdalsrc/hdf5-1.10.1/build \\\n\nmake -j\n# install into build dir\nmake install\n添加新的环境变量：\n\n进入build/bin里面\ngdal-config –-version\n看看是否编译成功\ncd /home/Elam/gdalsrc/gdal-2.3.0/swig\nmake -j\ncd python\npython setup.py install --prefix=/home/Elam/gdalsrc/gdal-2.3.0/build\n\n添加环境变量，或者直接用sys的路子添加路径\n\nsource重新新建一个终端先用\necho $PATH\necho $LD_LIBRARY_PATH\n查看各个库的路径是否都在如果不在，则重新source一下那个export_path.sh 如果不想每次都重新source，就直接添加到系统的环境变量当中去进入python终端看看能不能import \n\nbinggo！\n\n                ", "mainLikeNum": ["0 "], "mainBookmarkNum": "0"}