{"title": "快速上手——我用scrapy写爬虫（一） - 泰客笔记 ", "index": "网页爬虫,scrapy,python", "content": "写在前面\n用python写爬虫的人很多，python的爬虫框架也很多，诸如pyspider 和 scrapy，笔者还是笔记倾向于scrapy，本文就用python写一个小爬虫demo。本文适用于有一定python基础的，并且对爬虫有一定了解的开发者。\n安装 Scrapy\n检查环境，python的版本为3.6.2，pip为9.0.1\nF:\\techlee\\python>python --version\nPython 3.6.2\n\nF:\\techlee\\python>pip --version\npip 9.0.1 from d:\\program files\\python\\python36-32\\lib\\site-packages (python 3.6)\n安装scrapy框架\nF:\\techlee\\python>pip install scrapy\nCollecting scrapy\n  Downloading Scrapy-1.4.0-py2.py3-none-any.whl (248kB)\n    100% |████████████████████████████████| 256kB 188kB/s\n    // 漫长的安装过程\nSuccessfully installed Twisted-17.9.0 scrapy-1.4.0\n如果报错：\nerror: Microsoft Visual C++ 14.0 is required. Get it with \"Microsoft Visual C++ Build Tools\": http://landinghub.visualstudio.com/visual-cpp-build-tools\n请安装Visual C++ 2015 Build Toolshttp://landinghub.visualstudi...\n安装完成\nF:\\techlee\\python>scrapy version\nScrapy 1.4.0\n创建项目\nF:\\techlee\\python>scrapy startproject scrapyDemo\nNew Scrapy project 'scrapyDemo', using template directory 'd:\\\\program files\\\\python\\\\python36-32\\\\lib\\\\site-packages\\\\scrapy\\\\templates\\\\project', created in:\n    F:\\techlee\\python\\scrapyDemo\n\nYou can start your first spider with:\n    cd scrapyDemo\n    scrapy genspider example example.com\n\n目录结构\nscrapyDemo/\n    scrapy.cfg            # 部署配置文件\n\n    scrapyDemo/           # python模块\n        __init__.py\n\n        items.py          # 数据容器\n\n        pipelines.py      # project pipelines file\n\n        settings.py       # 配置文件\n\n        spiders/          # Spider类定义了如何爬取某个(或某些)网站\n            __init__.py\n创建执行爬取的类ImoocSpider在 scrapyDemo/spiders中\n# -*- coding: utf-8 -*-\nimport scrapy\nfrom urllib import parse as urlparse\n\n# 慕课网爬取\nclass ImoocSpider(scrapy.Spider):\n    # spider的名字定义了Scrapy如何定位(并初始化)spider，所以其必须是唯一的\n    name = \"imooc\"\n\n    # URL列表\n    start_urls = ['http://www.imooc.com/course/list']\n    #  域名不在列表中的URL不会被爬取。\n    allowed_domains = ['www.imooc.com']\n\n    def parse(self, response):        \n        learn_nodes = response.css('a.course-card')\n        for learn_node in learn_nodes :\n            learn_url = learn_node.css(\"::attr(href)\").extract_first()\n            yield scrapy.Request(url=urlparse.urljoin(response.url,learn_url),callback=self.parse_learn)\n        \n    def parse_learn(self, response):\n        title = response.xpath('//h2[@class=\"l\"]/text()').extract_first()\n        content = response.xpath('//div[@class=\"course-brief\"]/p/text()').extract_first()\n        url = response.url\n        print ('标题：' + title)\n        print ('地址：' + url)\n开始爬取\nF:\\techlee\\python\\scrapyDemo>scrapy crawl imooc\n如果出现，则缺少win32api库，选择相应的版本\n下载地址：https://sourceforge.net/proje...\nimport win32api\nModuleNotFoundError: No module named 'win32api'\n大功告成\n看到如下输出，就说明爬取成功啦\nF:\\techlee\\python\\scrapyDemo>scrapy crawl imooc\n2017-10-17 14:28:32 [scrapy.utils.log] INFO: Scrapy 1.4.0 started (bot: scrapyDemo)\n……\n2017-10-17 14:28:32 [scrapy.core.engine] INFO: Spider opened\n2017-10-17 14:28:32 [scrapy.extensions.logstats] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)\n2017-10-17 14:28:32 [scrapy.extensions.telnet] DEBUG: Telnet console listening on 127.0.0.1:6023\n2017-10-17 14:28:32 [scrapy.core.engine] DEBUG: Crawled (200) <GET http://www.imooc.com/robots.txt> (referer: None)\n2017-10-17 14:28:33 [scrapy.core.engine] DEBUG: Crawled (200) <GET http://www.imooc.com/course/list> (referer: None)\n2017-10-17 14:28:33 [scrapy.core.engine] DEBUG: Crawled (200) <GET http://www.imooc.com/learn/876> (referer: http://www.imooc.com/course/list)\n标题：集成MultiDex项目实战\n地址：http://www.imooc.com/learn/876\n2017-10-17 14:28:33 [scrapy.core.engine] DEBUG: Crawled (200) <GET http://www.imooc.com/learn/893> (referer: http://www.imooc.com/course/list)\n标题：阿里D2前端技术论坛——2016初心\n地址：http://www.imooc.com/learn/893\n2017-10-17 14:28:33 [scrapy.core.engine] DEBUG: Crawled (200) <GET http://www.imooc.com/learn/890> (referer: http://www.imooc.com/course/list)\n2017-10-17 14:28:33 [scrapy.core.engine] DEBUG: Crawled (200) <GET http://www.imooc.com/learn/888> (referer: http://www.imooc.com/course/list)\n标题：Hadoop进阶\n地址：http://www.imooc.com/learn/890\n标题：Javascript实现二叉树算法\n地址：http://www.imooc.com/learn/888\n2017-10-17 14:28:33 [scrapy.core.engine] DEBUG: Crawled (200) <GET http://www.imooc.com/learn/894> (referer: http://www.imooc.com/course/list)\n标题：Fragment应用上\n地址：http://www.imooc.com/learn/894\n2017-10-17 14:28:34 [scrapy.core.engine] DEBUG: Crawled (200) <GET http://www.imooc.com/learn/887> (referer: http://www.imooc.com/course/list)\n标题：PHP-面向对象\n地址：http://www.imooc.com/learn/887\n2017-10-17 14:28:34 [scrapy.core.engine] DEBUG: Crawled (200) <GET http://www.imooc.com/learn/900> (referer: http://www.imooc.com/course/list)\n2017-10-17 14:28:34 [scrapy.core.engine] DEBUG: Crawled (200) <GET http://www.imooc.com/learn/889> (referer: http://www.imooc.com/course/list)\n2017-10-17 14:28:34 [scrapy.core.engine] DEBUG: Crawled (200) <GET http://www.imooc.com/learn/901> (referer: http://www.imooc.com/course/list)\n标题：Sketch的基础实例应用\n地址：http://www.imooc.com/learn/900\n标题：ElasticSearch入门\n地址：http://www.imooc.com/learn/889\n标题：使用Google Guice实现依赖注入\n地址：http://www.imooc.com/learn/901\n2017-10-17 14:28:34 [scrapy.core.engine] DEBUG: Crawled (200) <GET http://www.imooc.com/learn/867> (referer: http://www.imooc.com/course/list)\n标题：Docker入门\n地址：http://www.imooc.com/learn/867\n2017-10-17 14:28:34 [scrapy.core.engine] DEBUG: Crawled (200) <GET http://www.imooc.com/learn/878> (referer: http://www.imooc.com/course/list)\n标题：Android图表绘制之直方图\n地址：http://www.imooc.com/learn/878\n2017-10-17 14:28:34 [scrapy.core.engine] DEBUG: Crawled (200) <GET http://www.imooc.com/learn/892> (referer: http://www.imooc.com/course/list)\n标题：UI版式设计\n地址：http://www.imooc.com/learn/892\n2017-10-17 14:28:35 [scrapy.core.engine] DEBUG: Crawled (200) <GET http://www.imooc.com/learn/877> (referer: http://www.imooc.com/course/list)\n2017-10-17 14:28:35 [scrapy.core.engine] DEBUG: Crawled (200) <GET http://www.imooc.com/learn/886> (referer: http://www.imooc.com/course/list)\n标题：RxJava与RxAndroid基础入门\n地址：http://www.imooc.com/learn/877\n标题：iOS开发之Audio特辑\n地址：http://www.imooc.com/learn/886\n2017-10-17 14:28:35 [scrapy.core.engine] DEBUG: Crawled (200) <GET http://www.imooc.com/learn/861> (referer: http://www.imooc.com/course/list)\n标题：基于Websocket的火拼俄罗斯（基础）\n地址：http://www.imooc.com/learn/861\n2017-10-17 14:28:35 [scrapy.core.engine] DEBUG: Crawled (200) <GET http://www.imooc.com/learn/895> (referer: http://www.imooc.com/course/list)\n2017-10-17 14:28:35 [scrapy.core.engine] DEBUG: Crawled (200) <GET http://www.imooc.com/learn/882> (referer: http://www.imooc.com/course/list)\n标题：2017AWS 技术峰会——大数据技术专场\n地址：http://www.imooc.com/learn/895\n标题：基于websocket的火拼俄罗斯（单机版）\n地址：http://www.imooc.com/learn/882\n\n原文 https://www.tech1024.cn/origi...\n保存数据到mysql数据库 https://www.tech1024.cn/origi...\n\n\n                ", "mainLikeNum": ["0 "], "mainBookmarkNum": "10"}