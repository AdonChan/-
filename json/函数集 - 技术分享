{"title": "函数集 - 技术分享 ", "index": "python,javascript,php", "content": "统计数组元素个数\n$arr = array(\n      '1011,1003,1008,1001,1000,1004,1012',\n      '1009',\n      '1011,1003,1111'\n    );\n$result = array();\nforeach ($arr as $str) {\n  $str_arr = explode(',', $str);\n  foreach ($str_arr as $v) {\n    // $result[$v] = isset($result[$v]) ? $result[$v] : 0;\n    // $result[$v] = $result[$v] + 1;\n    $result[$v] = isset($result[$v]) ? $result[$v]+1 : 1;\n  }\n}\nprint_r($result);//Array(\n[1011] => 2\n[1003] => 2\n[1008] => 1\n[1001] => 1\n[1000] => 1\n[1004] => 1\n[1012] => 1\n[1009] => 1\n[1111] => 1\n)\n循环删除目录\nfunction cleanup_directory($dir) {\n  foreach (new DirectoryIterator($dir) as $file) {\n    if ($file->isDir()) {\n      if (! $file->isDot()) {\n        cleanup_directory($file->getPathname());\n      }\n    } else {\n       unlink($file->getPathname());\n    }\n  }\n   rmdir($dir);\n}\n3.无限极分类生成树\n\nfunction generateTree($items){\n\n    $tree = array();\n\n    foreach($items as $item){\n\n        if(isset($items[$item['pid']])){\n\n            $items[$item['pid']]['son'][] = &$items[$item['id']];\n\n        }else{\n\n            $tree[] = &$items[$item['id']];\n\n        }\n\n    }\n\n    return $tree;\n\n}\nfunction generateTree2($items){\n\n    foreach($items as $item)\n\n        $items[$item['pid']]['son'][$item['id']] = &$items[$item['id']];\n\n    return isset($items[0]['son']) ? $items[0]['son'] : array();\n\n}\n\n\n$items = array(\n\n    1 => array('id' => 1, 'pid' => 0, 'name' => '安徽省'),\n\n    2 => array('id' => 2, 'pid' => 0, 'name' => '浙江省'),\n\n    3 => array('id' => 3, 'pid' => 1, 'name' => '合肥市'),\n\n    4 => array('id' => 4, 'pid' => 3, 'name' => '长丰县'),\n\n    5 => array('id' => 5, 'pid' => 1, 'name' => '安庆市'),\n\n);\n\nprint_r(generateTree($items));\n/**\n\n * 如何取数据格式化的树形数据\n\n */\n\n$tree = generateTree($items);\n\nfunction getTreeData($tree){\n\n    foreach($tree as $t){\n\n        echo $t['name'].'<br>';\n\n        if(isset($t['son'])){\n\n            getTreeData($t['son']);\n\n        }\n\n    }\n\n}\n4.数组排序 a - b 是数字数组写法 遇到字符串的时候就要\nvar test = ['ab', 'ac', 'bd', 'bc'];\ntest.sort(function(a, b) {\n    if(a < b) {\n        return -1;\n    }\n\n    if(a > b) {\n        return 1;\n    }\n\n    return 0;\n});\n5.array_reduce\n$raw = [1,2,3,4,5,];\n// array_reduce 的第三个参数是 $result 的初始值\narray_reduce($raw, function($result, $value) {\n    $result[$value] = $value;\n\n    return $result;\n}, []);\n// [1 => 1, 2 => 2, ... 5 => 5]\n\n6.arraymap 闭包中只接受一个或者多个参数，闭包的参数数量和 arraymap 本身的参数数量必须一致\n$input = ['key' => 'value'];\narray_map(function($key, $value) {\n\n    echo $key . $value;\n}, array_keys($input), $input)\n// 'keyvalue'\n$double = function($item) {\n  return 2 * $item;\n}\n\n$result = array_map($double, [1,2,3]);\n\n// 2 4 6\n7.繁殖兔子\n$month = 12;\n   $fab = array();\n \n   $fab[0] = 1;\n   $fab[1] = 1;\n \n     for ($i = 2; $i < $month; $i++)\n     {\n         $fab[$i] = $fab[$i - 1] + $fab[$i - 2];\n     }\n \n     for ($i = 0; $i < $month; $i++)\n     {\n         echo sprintf(\"第{%d}个月兔子为：{%d}\",$i, $fab[$i]).\"<br/>\";\n     }\n8 .datetime\nfunction getCurMonthFirstDay($date)\n{\n    return date('Y-m-01', strtotime($date));\n}\n getCurMonthLastDay('2015-07-23')\nfunction getCurMonthLastDay($date)\n{\n    return date('Y-m-d', strtotime(date('Y-m-01', strtotime($date)) . ' +1 month -1 day'));\n}\n9.加密解密\nfunction encrypt($data, $key)\n\n{\n\n    $key    =   md5($key);\n\n    $x      =   0;\n\n    $len    =   strlen($data);\n\n    $l      =   strlen($key);\n\n    $char   =   '';\n\n    for ($i = 0; $i < $len; $i++)\n\n    {\n\n        if ($x == $l)\n\n        {\n\n            $x = 0;\n\n        }\n\n        $char .= $key{$x};\n\n        $x++;\n\n    }\n\n    $str    =   '';\n\n    for ($i = 0; $i < $len; $i++)\n\n    {\n\n        $str .= chr(ord($data{$i}) + (ord($char{$i})) % 256);\n\n    }\n\n    return base64_encode($str);\n\n}\n\n \n\nfunction decrypt($data, $key)\n\n{\n\n    $key = md5($key);\n\n    $x = 0;\n\n    $data = base64_decode($data);\n\n    $len = strlen($data);\n\n    $l = strlen($key);\n\n    $char = '';\n\n    for ($i = 0; $i < $len; $i++)\n\n    {\n\n        if ($x == $l)\n\n        {\n\n            $x = 0;\n\n        }\n\n        $char .= substr($key, $x, 1);\n\n        $x++;\n\n    }\n\n    $str = '';\n\n    for ($i = 0; $i < $len; $i++)\n\n    {\n\n        if (ord(substr($data, $i, 1)) < ord(substr($char, $i, 1)))\n\n        {\n\n            $str .= chr((ord(substr($data, $i, 1)) + 256) - ord(substr($char, $i, 1)));\n\n        }\n\n        else\n\n        {\n\n            $str .= chr(ord(substr($data, $i, 1)) - ord(substr($char, $i, 1)));\n\n        }\n\n    }\n\n    return $str;\n\n}\n10 . 多维数组降级\nfunction array_flatten($arr) {\n    $result = [];\n\n    array_walk_recursive($arr, function($value) use (&$result) {\n        $result[] = $value;\n    });\n\n    return $result;\n}\nprint_r(array_flatten([1,[2,3],[4,5]]));// [1,[2,3],[4,5]] => [1,2,3,4,5]\n//  var new_array = old_array.concat(value1[, value2[, ...[, valueN]]])\nvar test = [1,2,3,[4,5,6],[7,8]];\n[].concat.apply([], test); // [1,2,3,4,5,6,7,8] 对于 test 数组中的每一个 value， 将它 concat 到空数组 [] 中去，而因为 concat 是 Array 的 prototype，所以我们用一个空 array 作载体\nvar test1 = [1,2,[3,[4,[5]]]];\n\nfunction flatten(arr) {\n   return arr.reduce(function(pre, cur) {\n        if(Array.isArray(cur)) {\n            return flatten(pre.concat(cur));\n        }\n\n        return pre.concat(cur);\n   }, []);\n}\n\n// [1,2,3,4,5]\n11.json_encode中文\n\nfunction json_encode_wrapper ($result)\n{\n    if(defined('JSON_UNESCAPED_UNICODE')){\n        return json_encode($result,JSON_UNESCAPED_UNICODE|JSON_NUMERIC_CHECK);\n    }else {\n        return preg_replace(\n            array(\"#\\\\\\u([0-9a-f][0-9a-f][0-9a-f][0-9a-f])#ie\", \"/\\\"(\\d+)\\\"/\",),\n            array(\"iconv('UCS-2', 'UTF-8', pack('H4', '\\\\1'))\", \"\\\\1\"),\n            json_encode($result)\n        );\n    }\n}\n12.二维数组去重\n$arr = array(\n\n    array('id'=>'2','title'=>'...','ding'=>'1','jing'=>'1','time'=>'...','url'=>'...','dj'=>'...'),\n\n    array('id'=>'2','title'=>'...','ding'=>'1','jing'=>'1','time'=>'...','url'=>'...','dj'=>'...')\n\n);\nfunction about_unique($arr=array()){  \n   /*将该种二维数组看成一维数组，则      该一维数组的value值有相同的则干掉只留一个，并将该一维      数组用重排后的索引数组返回，而返回的一维数组中的每个元素都是      原始key值形成的关联数组    */    \n$keys =array();\n   $temp = array();\n   foreach($arr[0] as $k=>$arrays) {\n    /*数组记录下关联数组的key值*/     \n    $keys[] = $k;\n   }\n   //return $keys;    /*降维*/    \nforeach($arr as $k=>$v) {\n    $v = join(\",\",$v);  //降维     \n    $temp[] = $v;\n   }\n   $temp = array_unique($temp); //去掉重复的内容    \nforeach ($temp as $k => $v){\n    /*再将拆开的数组按索引数组重新组装*/     \n    $temp[$k] = explode(\",\",$v);  \n   } \n   //return $temp;    /*再将拆开的数组按关联数组key值重新组装*/    \nforeach($temp as $k=>$v) {\n    foreach($v as $kkk=>$ck) {\n     $data[$k][$keys[$kkk]] = $temp[$k][$kkk];\n    }\n   }\n   return $data;\n  }\n13.格式化字节大小\n/**\n* 格式化字节大小\n* @param  number $size      字节数\n* @param  string $delimiter 数字和单位分隔符\n* @return string            格式化后的带单位的大小\n* @author \n*/\nfunction format_bytes($size, $delimiter = '') {\n  $units = array('B', 'KB', 'MB', 'GB', 'TB', 'PB');\n  for ($i = 0; $size >= 1024 && $i < 6; $i++) $size /= 1024;\n  return round($size, 2) . $delimiter . $units[$i];\n}\n14.3分钟前\n/**\n* 将指定时间戳转换为截止当前的xx时间前的格式  例如 return '3分钟前''\n* @param string|int $timestamp unix时间戳\n* @return string\n*/\nfunction time_ago($timestamp) {\n    $etime = time() - $timestamp;\n    if ($etime < 1) return '刚刚';     \n    $interval = array (         \n      12 * 30 * 24 * 60 * 60  =>  '年前 ('.date('Y-m-d', $timestamp).')',\n      30 * 24 * 60 * 60       =>  '个月前 ('.date('m-d', $timestamp).')',\n      7 * 24 * 60 * 60        =>  '周前 ('.date('m-d', $timestamp).')',\n      24 * 60 * 60            =>  '天前',\n      60 * 60                 =>  '小时前',\n      60                      =>  '分钟前',\n      1                       =>  '秒前'\n    );\n    foreach ($interval as $secs => $str) {\n        $d = $etime / $secs;\n        if ($d >= 1) {\n            $r = round($d);\n            return $r . $str;\n        }\n    };\n}\n15.身份证号\n/**\n* 判断参数字符串是否为天朝身份证号\n* @param $id 需要被判断的字符串或数字\n* @return mixed false 或 array[有内容的array boolean为真]\n*/\nfunction is_citizen_id($id) {\n    //长度效验  18位身份证中的X为大写\n    $id  = strtoupper($id);\n    if(!(preg_match('/^\\d{17}(\\d|X)$/',$id) || preg_match('/^\\d{15}$/',$id))) {\n      return false;\n    }\n    //15位老号码转换为18位 并转换成字符串\n    $Wi          = array(7, 9, 10, 5, 8, 4, 2, 1, 6, 3, 7, 9, 10, 5, 8, 4, 2, 1); \n    $Ai          = array('1', '0', 'X', '9', '8', '7', '6', '5', '4', '3', '2'); \n    $cardNoSum   = 0;\n    if(strlen($id)==16) {\n        $id        = substr(0, 6).'19'.substr(6, 9); \n        for($i = 0; $i < 17; $i++) {\n          $cardNoSum += substr($id,$i,1) * $Wi[$i];\n        }  \n        $seq       = $cardNoSum % 11; \n        $id        = $id.$Ai[$seq];\n    }\n    //效验18位身份证最后一位字符的合法性\n    $cardNoSum   = 0;\n    $id17        = substr($id,0,17);\n    $lastString  = substr($id,17,1);\n    for($i = 0; $i < 17; $i++) {\n        $cardNoSum += substr($id,$i,1) * $Wi[$i];\n    }  \n    $seq         = $cardNoSum % 11;\n    $realString  = $Ai[$seq];\n    if($lastString!=$realString) {return false;}\n    //地域效验\n    $oCity       =  array(11=>\"北京\",12=>\"天津\",13=>\"河北\",14=>\"山西\",15=>\"内蒙古\",21=>\"辽宁\",22=>\"吉林\",23=>\"黑龙江\",31=>\"上海\",32=>\"江苏\",33=>\"浙江\",34=>\"安徽\",35=>\"福建\",36=>\"江西\",37=>\"山东\",41=>\"河南\",42=>\"湖北\",43=>\"湖南\",44=>\"广东\",45=>\"广西\",46=>\"海南\",50=>\"重庆\",51=>\"四川\",52=>\"贵州\",53=>\"云南\",54=>\"西藏\",61=>\"陕西\",62=>\"甘肃\",63=>\"青海\",64=>\"宁夏\",65=>\"新疆\",71=>\"台湾\",81=>\"香港\",82=>\"澳门\",91=>\"国外\");\n    $City        = substr($id, 0, 2);\n    $BirthYear   = substr($id, 6, 4);\n    $BirthMonth  = substr($id, 10, 2);\n    $BirthDay    = substr($id, 12, 2);\n    $Sex         = substr($id, 16,1) % 2 ;//男1 女0\n    //$Sexcn       = $Sex?'男':'女';\n    //地域验证\n    if(is_null($oCity[$City])) {return false;}\n    //出生日期效验\n    if($BirthYear>2078 || $BirthYear<1900) {return false;}\n    $RealDate    = strtotime($BirthYear.'-'.$BirthMonth.'-'.$BirthDay);\n    if(date('Y',$RealDate)!=$BirthYear || date('m',$RealDate)!=$BirthMonth || date('d',$RealDate)!=$BirthDay) {\n        return false;\n    }\n    return array('id'=>$id,'location'=>$oCity[$City],'Y'=>$BirthYear,'m'=>$BirthMonth,'d'=>$BirthDay,'sex'=>$Sex);\n}\n16.获取二维数组中某个key的集合\n$user = array( 0 => array( 'id' => 1, 'name' => '张三', 'email' => 'zhangsan@sina.com', ), 1 => array( 'id' => 2, 'name' => '李四', 'email' => 'lisi@163.com', ), 2 => array( 'id' => 5, 'name' => '王五', 'email' => '10000@qq.com', ), ...... );\n$ids = array(); $ids = array_map('array_shift', $user);\n$ids = array_column($user, 'id');//php5.5\n$names = array(); $names = array_reduce($user, create_function('$v,$w', '$v[$w[\"id\"]]=$w[\"name\"];return $v;'));\n17.判断一个数是否为素数\nfunction isPrime(number) {\n\n   // If your browser doesn't support the method Number.isInteger of ECMAScript 6,\n   // you can implement your own pretty easily\n   if (typeof number !== 'number' || !Number.isInteger(number)) {\n      // Alternatively you can throw an error.\n      return false;\n   }\n \n   if (number < 2) {\n      return false;\n   }\n    \n   if (number === 2) {\n      return true;\n   } else if (number % 2 === 0) {\n      return false;\n   }\n \n   var squareRoot = Math.sqrt(number);\n   for(var i = 3; i <= squareRoot; i += 2) {\n      if (number % i === 0) {\n         return false;\n      }\n   }\n \n   return true;\n}\nfunction isPrime($n) {//TurkHackTeam AVP production\n    if ($n <= 3) {\n        return $n > 1;\n    } else if ($n % 2 === 0 || $n % 3 === 0) {\n        return false;\n    } else {\n        for ($i = 5; $i * $i <= $n; $i += 6) {\n            if ($n % $i === 0 || $n % ($i + 2) === 0) {\n                return false;\n            }\n        }\n        return true;\n    }\n}\n18.闭包\nvar nodes = document.getElementsByTagName('button');\nfor (var i = 0; i < nodes.length; i++) {\n   nodes[i].addEventListener('click', (function(i) {\n      return function() {\n         console.log('You clicked element #' + i);\n      }\n   })(i));\n}\n//将函数移动到循环外部即可（创建了一个新的闭包对象）\nfunction handlerWrapper(i) {\n   return function() {\n      console.log('You clicked element #' + i);\n   }\n}\n \nvar nodes = document.getElementsByTagName('button');\nfor (var i = 0; i < nodes.length; i++) {\n   nodes[i].addEventListener('click', handlerWrapper(i));\n}\n19.事件循环 Event Loop\nfunction printing() {\n   console.log(1); \n   setTimeout(function() { console.log(2); }, 1000); \n   setTimeout(function() { console.log(3); }, 0); \n   console.log(4);\n}\n //即使setTimeout的延迟为0，其回调也会被加入到那些没有延迟的函数队列之后。\nprinting();//1432\n20.字典排序\ndef mysort():\n    dic = {'a':31, 'bc':5, 'c':3, 'asd':4, 'aa':74, 'd':0}\n    dict= sorted(dic.iteritems(), key=lambda d:d[1], reverse = True)\n    print dict//[('aa', 74), ('a', 31), ('bc', 5), ('asd', 4), ('c', 3), ('d', 0)]\n\n\n21.数值缩写\nvar abbr = function (number) {\n    var abbrList = ['', 'K', 'M', 'G', 'T', 'P', 'E', 'Z', 'Y'];\n    var step = 1000;\n    var i = 0;\n    var j = abbrList.length;\n\n    while (number >= step && ++i < j) {\n        number = number / step;\n    }\n\n    if (i === j) {\n        i = j - 1;\n    }\n    \n\n    return number + abbrList[i];\n};\n22.数字千位分隔符\nvar format = function (number) {\n    return String(number).replace(/(\\d)(?=(\\d{3})+$)/g, '$1,');\n};\n\n23.实现随机颜色值\nvar randomColor = function () {\n    var letters = '0123456789ABCDEF';\n    var ret = '#';\n\n    for (var i = 0; i < 6; i++) {\n        ret += letters[Math.round(Math.random() * 15)];\n    }\n\n    return ret;\n};\nvar randomColor = function () {\n    return '#' + Math.random().toString(16).substr(2, 6);\n};\n24.时间格式化输出\n//formatDate(new Date(1409894060000), 'yyyy-MM-dd HH:mm:ss 星期w') 2014-09-05 13:14:20 星期五\nfunction formatDate(oDate, sFormation) {\n    var obj = {\n        yyyy:oDate.getFullYear(),\n        yy:(\"\"+ oDate.getFullYear()).slice(-2),//非常精辟的方法\n        M:oDate.getMonth()+1,\n        MM:(\"0\"+ (oDate.getMonth()+1)).slice(-2),\n        d:oDate.getDate(),\n        dd:(\"0\" + oDate.getDate()).slice(-2),\n        H:oDate.getHours(),\n        HH:(\"0\" + oDate.getHours()).slice(-2),\n        h:oDate.getHours() % 12,\n        hh:(\"0\"+oDate.getHours() % 12).slice(-2),\n        m:oDate.getMinutes(),\n        mm:(\"0\" + oDate.getMinutes()).slice(-2),\n        s:oDate.getSeconds(),\n        ss:(\"0\" + oDate.getSeconds()).slice(-2),\n        w:['日', '一', '二', '三', '四', '五', '六'][oDate.getDay()]\n    };\n    return sFormation.replace(/([a-z]+)/ig,function($1){return obj[$1]});\n}\n25.斐波那契数列\nfunction fibonacci(n) {\n    if(n ==1 || n == 2){\n        return 1\n    }\n    return fibonacci(n - 1) + fibonacci(n - 2);\n}\n26.数组去重\n\nArray.prototype.distinct=function(){\n    var arr=[];\n    var obj={};\n    for(var i=0;i<this.length;i++){\n        if(obj[this[i]]==undefined)\n            obj[this[i]]=this[i];\n        else if(obj[this[i]])\n            arr.push(this[i]);\n    }\n    return arr;\n }\n27.删除元素\nfunction array_delete($array, $element) {\n    return array_diff($array, [$element]);\n   // if(($key = array_search($array, $element)) !== false) {\n      //  unset($array[$key]);\n   // }\n//$array = array_filter($array, function($e) use ($del_val) {\n //   return ($e !== $del_val);\n//});\n//$array = array(14,22,37,42,58,61,73,82,96,10);\n//array_splice($array, array_search(58, $array ), 1);\n}\n\narray_delete( [312, 401, 1599, 3], 401 ) // returns [312, 1599, 3]\n\n28.RandomString\ndef random_string(length):\n    return ''.join(random.choice(string.letters + string.digits) for i in xrange(length))\n\n\nfunction generateRandomString($length = 10) {\n    $characters = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';\n    $charactersLength = strlen($characters);\n    $randomString = '';\n    for ($i = 0; $i < $length; $i++) {\n        $randomString .= $characters[rand(0, $charactersLength - 1)];\n    }\n    return $randomString;\n}\n//$randomString = substr(str_shuffle(\"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\"), 0, $length);\n//$string = bin2hex(openssl_random_pseudo_bytes(10));20 char long hexdec string\n29.保存文件\n$ch = curl_init('http://example.com/image.php');\n$fp = fopen('/my/folder/flower.gif', 'wb');\ncurl_setopt($ch, CURLOPT_FILE, $fp);\ncurl_setopt($ch, CURLOPT_HEADER, 0);\ncurl_exec($ch);\ncurl_close($ch);\nfclose($fp);\n\n30.插入数组元素\nfunction array_insert(&$array, $position, $insert)\n{\n    if (is_int($position)) {\n        array_splice($array, $position, 0, $insert);\n    } else {\n        $pos   = array_search($position, array_keys($array));\n        $array = array_merge(\n            array_slice($array, 0, $pos),\n            $insert,\n            array_slice($array, $pos)\n        );\n    }\n}\n$arr = [\n    \"name\"  => [\n        \"type\"      => \"string\",\n        \"maxlength\" => \"30\",\n    ],\n    \"email\" => [\n        \"type\"      => \"email\",\n        \"maxlength\" => \"150\",\n    ],\n];\n\narray_insert(\n    $arr,\n    \"email\",\n    [\n        \"phone\" => [\n            \"type\"   => \"string\",\n            \"format\" => \"phone\",\n        ],\n    ]\n);\n// ->\narray (\n  'name' =>\n  array (\n    'type' => 'string',\n    'maxlength' => '30',\n  ),\n  'phone' =>\n  array (\n    'type' => 'string',\n    'format' => 'phone',\n  ),\n  'email' =>\n  array (\n    'type' => 'email',\n    'maxlength' => '150',\n  ),\n)\n31.验证ip\n\nfunction validate_ip($ip)\n    {\n        if (filter_var($ip, FILTER_VALIDATE_IP, FILTER_FLAG_NO_PRIV_RANGE) === false)\n            return false;\n        if (filter_var($ip, FILTER_VALIDATE_IP, FILTER_FLAG_NO_RES_RANGE) === false)\n            return false;\n        if (filter_var($ip, FILTER_VALIDATE_IP, FILTER_FLAG_IPV4) === false && filter_var($ip, FILTER_VALIDATE_IP, FILTER_FLAG_IPV6) === false)\n            return false;\n\n        return true;\n    }\n    function validate_ip($ip)\n{\n    if (filter_var($ip, FILTER_VALIDATE_IP, FILTER_FLAG_NO_PRIV_RANGE | FILTER_FLAG_NO_RES_RANGE) === false)\n    {\n        return false;\n    }\n\n    self::$ip = sprintf('%u', ip2long($ip)); // you seem to want this\n\n    return true;\n}\n32.get ip\nfunction get_ip_address(){\n    foreach (array('HTTP_CLIENT_IP', 'HTTP_X_FORWARDED_FOR', 'HTTP_X_FORWARDED', 'HTTP_X_CLUSTER_CLIENT_IP', 'HTTP_FORWARDED_FOR', 'HTTP_FORWARDED', 'REMOTE_ADDR') as $key){\n        if (array_key_exists($key, $_SERVER) === true){\n            foreach (explode(',', $_SERVER[$key]) as $ip){\n                $ip = trim($ip); // just to be safe\n\n                if (filter_var($ip, FILTER_VALIDATE_IP, FILTER_FLAG_NO_PRIV_RANGE | FILTER_FLAG_NO_RES_RANGE) !== false){\n                    return $ip;\n                }\n            }\n        }\n    }\n}\n33.选出最长的单词\nfunction LongestWord(sen) {\n    var words = sen.match(/\\w+/g);\n    if (words !== null) {\n        var maxWords = {\n            index: 0,\n            length: 0\n        };\n        for (var i = 0, length = words.length; i < length; i++) {\n            if (words[i].length > maxWords.length) {\n                maxWords = {\n                    index: i,\n                    length: words[i].length\n                }\n            }\n        }\n        return words[maxWords.index];\n    }\n    return words;\n}\n34.map\nvar oldArr = [{first_name:\"Colin\",last_name:\"Toh\"},{first_name:\"Addy\",last_name:\"Osmani\"},{first_name:\"Yehuda\",last_name:\"Katz\"}];\n\nfunction getNewArr(){\n        \n    return oldArr.map(function(item,index){\n        item.full_name = [item.first_name,item.last_name].join(\" \");\n        return item;\n    });\n    \n}\n\n35.统计一个数组中有多少个不重复的单词\nvar arr = [\"apple\",\"orange\",\"apple\",\"orange\",\"pear\",\"orange\"];\n//https://github.com/es-shims/es5-shim\nfunction getWordCnt(){\n    var obj = {};\n    \n    for(var i= 0, l = arr.length; i< l; i++){\n        var item = arr[i];\n        obj[item] = (obj[item] +1 ) || 1;//obj[item]为undefined则返回1\n    }\n    \n    return obj;\n}\nfunction getWordCnt(){\n    return arr.reduce(function(prev,next){\n        prev[next] = (prev[next] + 1) || 1;\n        return prev;\n    },{});\n}\n36.约瑟夫环\nfunction yuesefu($n,$m) {  \n    $r=0;  \n    for($i=2; $i<=$n; $i++) {\n        $r=($r+$m)%$i;  \n    }\n    return $r+1;  \n}  \necho yuesefu(10,3).\"是猴王\";\n37.判断一个字符串中的字符是否都在另一个中出现\nfunction charsissubset($h, $n) {\n    return preg_match('/[^' . preg_quote($h) . ']/u', $n) ? 0 : 1;\n}\n\necho charsissubset('abcddcba', 'abcde'); // false\necho charsissubset('abcddcba', 'abcd'); // true\necho charsissubset('abcddcba', 'badc'); // true\necho charsissubset('汉字', '字'); // true\necho charsissubset('汉字', '漢字'); // false\n38.add(2)(3)(4)\nfunction add(a) {\n  var temp = function(b) {\n    return add(a + b);\n  }\n  temp.valueOf = temp.toString = function() {\n    return a;\n  };\n  return temp;\n}\nvar ans = add(2)(3)(4);//9\nfunction add(num){\n  num += ~~add;\n  add.num = num;\n  return add;\n}\nadd.valueOf = add.toString = function(){return add.num};\nvar ans = add(3)(4)(5)(6);  // 18\n39.打印出Fibonacci数\nfunction fn(n) {\n  var a = [];\n  a[0] = 0, a[1] = 1;\n  for(var i = 2; i < n; i++)\n    a[i] = a[i - 1] + a[i - 2];\n  for(var i = 0; i < n; i++)\n    console.log(a[i]);\n}\n40.把URL参数解析为一个对象\nfunction parseQueryString(url) {\n  var obj = {};\n  var a = url.split('?');\n  if(a.length === 1) return obj;\n  var b = a[1].split('&');\n  for(var i = 0, length = b.length; i < length; i++) {\n    var c = b[i].split('=');\n    obj[c[0]] = c[1];\n  }\n  return obj;\n}\nvar url = 'http://witmax.cn/index.php?key0=0&key1=1&key2=2';\nvar obj = parseQueryString(url);\nconsole.log(obj.key0, obj.key1, obj.key2);  // 0 1 2 \n\n41.判断数据类型\nfunction isNumber(obj) {\n    return Object.prototype.toString.call(obj) === '[object Number]'\n}//对于NaN也返回true\nfunction isNumber(obj) {\n    return obj === +obj\n}\n// 判断字符串\nfunction isString(obj) {\n    return obj === obj+''\n}\n// 判断布尔类型\nfunction isBoolean(obj) {\n    return obj === !!obj\n}\n42.javascript sleep\nfunction sleep(numberMillis) {\n    var now = new Date();\n    var exitTime = now.getTime() + numberMillis;\n    while (true) {\n        now = new Date();\n        if (now.getTime() > exitTime)\n        return;\n    }\n}\n43.爬虫\ndef splider():\n    # -*- coding:utf-8 -*-\n    #发送data表单数据\n    import urllib2\n    import urllib\n    url = \"http://www.someserver.com/register.cgi\"\n    values = {\n        'name' : 'Andrew',\n        'location' : 'NJU',\n        'language' : 'Python'\n    }\n    user_agent = 'Mozilla/4.0 (compatible; MSIE 5.5; Windows NT)' \n    header = {'User-Agent' : user_agent}\n    data = urllib.urlencode(values) #data数据需要编码成标准形式\n    #print data\n    http_handler = urllib2.HTTPHandler(debuglevel = 1)#Debug log\n    https_handler = urllib2.HTTPSHandler(debuglevel = 1)\n    opener = urllib2.build_opener(http_handler, https_handler)\n    urllib2.install_opener(opener)\n    req = urllib2.Request(url, data) #发送请求同时传送data表单\n    #req = urllib2.Request(url, data, header) #url 表单数据 伪装头部\n    reponse = urllib2.urlopen(req, timeout=10) #接受反馈数据\n    html = reponse.read() #读取反馈数据\n    print response.info()\n    print response.getcode()\n    redirected = response.geturl() == url\n    \"\"\"\n    full_url = url + '?' + data\n    data = urllib2.open(full_url)\n    \"\"\"\n    #返回错误码, 200不是错误, 不会引起异常\n    headers = {\n    'Referer': 'http://www.cnbeta.com/articles'\n    }\n    proxy_handler = urllib2.ProxyHandler({\"http\" : 'http://some-proxy.com:8080'})\n    opener = urllib2.build_opener(proxy_handler)\n    urllib2.install_opener(opener)  #urllib2.install_opener() 会设置 urllib2 的全局 opener\n    req = urllib2.Request(\n    url = 'http://secure.verycd.com/signin/*/http://www.verycd.com/',\n    data = post_data, \n    headers = headers\n    )\n    try:\n        urllib2.urlopen(req)\n    except urllib2.HTTPError, e:\n        print e.code\n        #print e.read()\n44.判断数据类型\nfunction type(o) {\n    var t, c, n;\n    if (o === null) \n        return \"null\";\n    if (o !== o)\n        return \"nan\";\n    if ((t = typeof o) !== \"object\") \n        return t;  // 识别原始值的类型和函数\n    if ((c = classof(o)) !== \"Object\")\n        return c;  // 识别出大多数内置类型\n    if (o.constructor && typeof o.constructor === \"function\" &&\n        (n = o.constructor.getName()))\n        return n;  //如果对象构造函数名字存在, 则返回\n    return \"Object\";  // 无法识别类型返回\"Object\"\n}\nfunction classof(o) {\n    return Object.prototype.toString.call(o).slice(8, -1);\n}\nFunction.prototype.getName = function() {\n    if (\"name\" in this)\n        return this.name;\n    return this.name = this.toString().match(/function\\s*([^(]*)\\(/)[1];\n}\n45.实现千分位分隔\nfunction mysplit(s){\n        if(/[^0-9\\.]/.test(s)) return \"invalid value\";\n        s=s.replace(/^(\\d*)$/,\"$1.\");\n        s=(s+\"00\").replace(/(\\d*\\.\\d\\d)\\d*/,\"$1\");\n        s=s.replace(\".\",\",\");\n        var re=/(\\d)(\\d{3},)/;\n        while(re.test(s))\n            s=s.replace(re,\"$1,$2\");\n        s=s.replace(/,(\\d\\d)$/,\".$1\");\n        return \"￥\" + s.replace(/^\\./,\"0.\")\n    }\n46.随机产生颜色\nfunction randomVal(val){\n        return Math.floor(Math.random()*(val + 1));\n    }\n\n    function randomColor(){\n        return 'rgb(' + randomVal(255) + ',' + randomVal(255) + ',' + randomVal(255) + ')';\n    }\n47.生成随机的IP地址，规则类似于192.168.11.0/24\nRANDOM_IP_POOL=['192.168.10.222/0']\ndef __get_random_ip():\n    str_ip = RANDOM_IP_POOL[random.randint(0,len(RANDOM_IP_POOL) - 1)]\n    str_ip_addr = str_ip.split('/')[0]\n    str_ip_mask = str_ip.split('/')[1]\n    ip_addr = struct.unpack('>I',socket.inet_aton(str_ip_addr))[0]\n    mask = 0x0\n    for i in range(31, 31 - int(str_ip_mask), -1):\n        mask = mask | ( 1 << i)\n    ip_addr_min = ip_addr & (mask & 0xffffffff)\n    ip_addr_max = ip_addr | (~mask & 0xffffffff)\n    return socket.inet_ntoa(struct.pack('>I', random.randint(ip_addr_min, ip_addr_max)))\n48.倒计时\nvar total = 500;\nvar timer = null;\n\nvar tiktock = document.getElementById('tiktock');\nvar btn = document.getElementById('btn');\n\nfunction countdown(){\n    timer = setInterval(function(){\n        total--;\n        if (total<=0) {\n            clearInterval(timer);\n            tiktock.innerHTML= \"0:00\";\n        }else{\n            var ss = Math.floor(total/100);\n            var ms = total-Math.floor(total/100)*100;\n            tiktock.innerHTML=ss + \":\" + ms;\n        }\n    },10);\n};\nbtn.addEventListener('click', countdown, false);\n\n49.[1,2,3] ->'{1,2,3}'\nclass intSet(object):\n\ndef __init__(self):\n    # creat an empty set of integers\n    self.vals = []\n\ndef insert(self, e):\n    # assume e is an interger, and insert it \n    if not(e in self.vals):\n        self.vals.append(e)\n\ndef member(self, e):\n    return e in self.vals\n\ndef remove(self, e):\n    try:\n        self.vals.remove(e)\n    except:\n        raise ValueError(str(e) + 'not found')\n\n\ndef __str__(self):\n    # return a string representation of self\n    self.vals.sort()\n    return \"{\" + ','.join([str(e) for e in self.vals]) + \"}\"\n50.转义过滤\n//纯数字的参数intval强制取整\n//其他参数值进行过滤或者转义\n//filter_input() 函数来过滤一个 POST 变量\nif (!filter_input(INPUT_POST, 'email', FILTER_VALIDATE_EMAIL))\n {\n echo \"E-Mail is not valid\";\n }\nelse\n {\n echo \"E-Mail is valid\";\n }\n    protected function zaddslashes($string, $force = 0, $strip = FALSE)\n    {   \n        if (!defined('MAGIC_QUOTES_GPC'))\n        {   \n         define('MAGIC_QUOTES_GPC', '');\n        }   \n        if (!MAGIC_QUOTES_GPC || $force)\n        {   \n         if (is_array($string)) {\n             foreach ($string as $key => $val)\n             {   \n                 $string[$key] = $this->zaddslashes($val, $force, $strip);\n             }   \n         }   \n         else\n         {   \n             $string = ($strip ? stripslashes($string) : $string);\n             $string = htmlspecialchars($string);\n         }   \n        }   \n        return $string;\n     }\n51.构造IP\nfunction getIPaddress()\n{\n    $IPaddress = '';\n    if (isset($_SERVER)) {\n        if (isset($_SERVER[\"HTTP_X_FORWARDED_FOR\"])) {\n            $IPaddress = $_SERVER[\"HTTP_X_FORWARDED_FOR\"];\n        } else if (isset($_SERVER[\"HTTP_CLIENT_IP\"])) {\n            $IPaddress = $_SERVER[\"HTTP_CLIENT_IP\"];\n        } else {\n            $IPaddress = $_SERVER[\"REMOTE_ADDR\"];\n        }\n    } else {\n        if (getenv(\"HTTP_X_FORWARDED_FOR\")) {\n            $IPaddress = getenv(\"HTTP_X_FORWARDED_FOR\");\n        } else if (getenv(\"HTTP_CLIENT_IP\")) {\n            $IPaddress = getenv(\"HTTP_CLIENT_IP\");\n        } else {\n            $IPaddress = getenv(\"REMOTE_ADDR\");\n        }\n    }\n    return $IPaddress;\n}\nfunction curlPost($url, $post='', $autoFollow=0){\n        $ch = curl_init();\n        $user_agent = 'Safari Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_1) AppleWebKit/537.73.11 (KHTML, like Gecko) Version/7.0.1 Safari/5\n        curl_setopt($ch, CURLOPT_USERAGENT, $user_agent);\n        \n        curl_setopt($ch, CURLOPT_URL, $url);\n        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); \n        curl_setopt($ch, CURLOPT_HEADER, 0); \n        curl_setopt($ch, CURLOPT_HTTPHEADER, array('X-FORWARDED-FOR:61.135.169.125', 'CLIENT-IP:'.getIPaddress()));  //构造IP\n        curl_setopt($ch, CURLOPT_REFERER, \"http://www.baidu.com/\");   //构造来路\n        curl_setopt($ch, CURLOPT_CUSTOMREQUEST, 'GET');\n        if($autoFollow){\n            curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);  //启动跳转链接\n            curl_setopt($ch, CURLOPT_AUTOREFERER, true);  //多级自动跳转\n        }   \n        //  \n        if($post!=''){\n            curl_setopt($ch, CURLOPT_POST, 1);//post提交方式\n            curl_setopt($ch, CURLOPT_POSTFIELDS, $post);\n        }   \n        \n        $output = curl_exec($ch);\n        curl_close($ch);\n        return $output;\n    }\n52.文件名生成唯一\nfunction unique_filename() {\n    $time = !empty($_SERVER['REQUEST_TIME_FLOAT']) ? $_SERVER['REQUEST_TIME_FLOAT'] : mt_rand();\n    $addr = !empty($_SERVER['REMOTE_ADDR'])        ? $_SERVER['REMOTE_ADDR']        : mt_rand();\n    $port = !empty($_SERVER['REMOTE_PORT'])        ? $_SERVER['REMOTE_PORT']        : mt_rand();\n    $ua   = !empty($_SERVER['HTTP_USER_AGENT'])    ? $_SERVER['HTTP_USER_AGENT']    : mt_rand();\n    return md5(uniqid(mt_rand(), true).$time.$addr.$port.$ua.mt_rand());\n}\n\n53.PHP实现钩子和插件系统\n/**\n * Attach (or remove) multiple callbacks to an event and trigger those callbacks when that event is called.\n * 绑定或移除多个回调函数到事件,当事件被调用时触发回调函数.\n *\n * @param string $event name\n * @param mixed  $value the optional value to pass to each callback\n * @param mixed  $callback the method or function to call - FALSE to remove all callbacks for event\n */\nfunction event($event, $value = NULL, $callback = NULL) {\n    static $events;\n    if($callback !== NULL) {\n        if($callback) {\n            $events[$event][] = $callback; // 添加事件\n        } else {\n            unset($events[$event]); // 移除事件里所有的回调函数\n        }\n    } else if(isset($events[$event])) {\n        foreach($events[$event] as $function) {\n            $value = call_user_func($function, $value); // 调用事件\n        }\n        return $value;\n    }\n}\n// 添加事件\nevent('filter_text', NULL, function($text) { return htmlspecialchars($text); });\nevent('filter_text', NULL, function($text) { return nl2br($text); });\n// 移除事件里所有的回调函数\n// event('filter_text', NULL, FALSE);\n// 调用事件\n$text = event('filter_text', $_POST['text']);\n54.字符串首字母大写的实现方式\nString.prototype.firstUpperCase = function(){\n    return this.replace(/\\b(\\w)(\\w*)/g, function($0, $1, $2) {\n        return $1.toUpperCase() + $2.toLowerCase();\n    });\n}\n//这只能改变字符串首字母\nString.prototype.firstUpperCase=function(){\n    return this.replace(/^\\S/,function(s){return s.toUpperCase();});\n}\n55.获取url参数\n function getQueryString(key){\n        var reg = new RegExp(\"(^|&)\"+key+\"=([^&]*)(&|$)\");\n        var result = window.location.search.substr(1).match(reg);\n        return result?decodeURIComponent(result[2]):null;\n      }\nfunction getRequest() {   \n       var url = window.location.search; //获取url中\"?\"符后的字串   \n       var theRequest = new Object();   \n       if (url.indexOf(\"?\") != -1) {   \n          var str = url.substr(1);   \n          strs = str.split(\"&\");   \n          for(var i = 0; i < strs.length; i ++) {   \n             theRequest[strs[i].split(\"=\")[0]]=decodeURI(strs[i].split(\"=\")[1]); \n\n          }   \n       }   \n       return theRequest;   \n    }\n56.过滤\nvar array = [\n    {\n        \"title\": 123,\n        \"num\": 1,\n        \"type\": [{\"name\": 'A', \"num\": 1}, {\"name\": 'B', \"num\": 1}, {\"name\": 'C', \"num\": 0}]\n    }, {\n        \"title\": 321,\n        \"num\": 1,\n        \"type\": [{\"name\": 'D', \"num\": 0}, {\"name\": 'E', \"num\": 1}, {\"name\": 'F', \"num\": 0}]\n    }];\n\narray.forEach(function (x) {\n    x.type = x.type.filter(function (y) {\n        return y.num != 0;\n    });\n});\n\n57.随机生成-50到50之间的不包括0的整数\nfunction my_rand(){\n    $num = mt_rand(1, 50); \n    $rand = mt_rand(1, 10);\n\n    return $rand > 4 ? $num : -$num;//控制生成正负数的比例为4：6\n}\n58.时间对比\nfunction compareDate(date1, date2){\n      var  difArr, unitArr;\n\n      date1 = new Date(date1);\n      date2 = new Date(date2);\n      difArr = [date1.getFullYear() - date2.getFullYear(), date1.getMonth() -date2.getMonth(),date1.getDate() - date2.getDate(),date1.getHours() - date2.getHours(), date1.getMinutes() - date2.getMinutes(),date1.getSeconds() - date2.getSeconds()];\n      unitArr = ['年','月','日','时','分','秒']\n      for(var i = 0; i < 6;i++){\n        if(difArr[i] !== 0){\n          return Math.abs(difArr[i]) + unitArr[i];\n        }\n      }\n    }\n59.数组去重\n//传入数组\n  function unique(arr){\n    var tmpArr = [];\n    for(var i=0; i<arr.length; i++){\n      //如果当前数组的第i已经保存进了临时数组，那么跳过，\n      //否则把当前项push到临时数组里面\n      if(tmpArr.indexOf(arr[i]) == -1){\n        tmpArr.push(arr[i]);\n      }\n    }\n    return tmpArr;\n  }\n\n60.继承\n/*\n * 基类，定义属性\n */\nfunction Person(name, age) {\n    this.name = name;\n    this.age = age;\n}\n\n/*\n * 基类，定义方法\n */\nPerson.prototype.selfIntroduce = function () {\n    console.log(\"name: \" + this.name);\n    console.log(\"age: \" + this.age);\n}\n\n/*\n * 子类，定义子类的属性\n */\nfunction Student(name, age, school) {\n  // 调用基类的构造函数\n    Person.call(this, name, age);\n    this.school = school;\n}\n\n// 使子类继承基类\nStudent.prototype = new Person();\n\n/*\n * 定义子类的方法\n */\nStudent.prototype.goToSchool = function() {\n  // some code..\n}\n\n/*\n * 扩展并调用了超类的方法\n */\nStudent.prototype.selfIntroduce = function () {\n    Student.prototype.__proto__.selfIntroduce.call(this);\n    console.log(\"school: \" + this.school);\n}\n\nvar student = new Student(\"John\", 22, \"My School\");\nstudent.selfIntroduce();\n\n61.Unicode和Utf-8编码的互相转换\n/**\n * utf8字符转换成Unicode字符\n * @param  [type] $utf8_str Utf-8字符\n * @return [type]           Unicode字符\n */\nfunction utf8_str_to_unicode($utf8_str) {\n    $unicode = 0;\n    $unicode = (ord($utf8_str[0]) & 0x1F) << 12;\n    $unicode |= (ord($utf8_str[1]) & 0x3F) << 6;\n    $unicode |= (ord($utf8_str[2]) & 0x3F);\n    return dechex($unicode);\n}\n\n/**\n * Unicode字符转换成utf8字符\n * @param  [type] $unicode_str Unicode字符\n * @return [type]              Utf-8字符\n */\nfunction unicode_to_utf8($unicode_str) {\n    $utf8_str = '';\n    $code = intval(hexdec($unicode_str));\n    //这里注意转换出来的code一定得是整形，这样才会正确的按位操作\n    $ord_1 = decbin(0xe0 | ($code >> 12));\n    $ord_2 = decbin(0x80 | (($code >> 6) & 0x3f));\n    $ord_3 = decbin(0x80 | ($code & 0x3f));\n    $utf8_str = chr(bindec($ord_1)) . chr(bindec($ord_2)) . chr(bindec($ord_3));\n    return $utf8_str;\n}\n\n62.gzip编码\nfunction curl_get($url, $gzip=false){\n $curl = curl_init($url);\n curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1);\n curl_setopt($curl, CURLOPT_CONNECTTIMEOUT, 10);\n if($gzip) curl_setopt($curl, CURLOPT_ENCODING, \"gzip\"); // 关键在这里\n $content = curl_exec($curl);\n curl_close($curl);\n return $content;\n}\n$url = 'http://api.stackexchange.com/2.2/tags?order=asc&sort=popular&site=stackoverflow&tag=qt';\n//$data = file_get_contents(\"compress.zlib://\".$url);\n63.Python中文时间\n#!/usr/bin/env \n# -*- coding: utf-8 -*-\n\nfrom datetime import datetime\nnt=datetime.now()\nprint(nt.strftime('%Y年%m月%d日 %H时%M分%S秒').decode('utf-8'))#2015年08月10日 11时25分04秒\nprint(nt.strftime('%Y{y}%m{m}%d{d}').format(y='年', m='月', d='日'))\n64.list分组,按照下标顺序分成3组：[3, 8, 9] [4, 1, 10] [6, 7, 2, 5]\na=[1,2,3,4,5,6,7,8,9,10]\n[a[i:i+3] for i in xrange(0,len(a),3)]\n64.curl上传文件\n$ch = curl_init();\n\n$data = array('name' => 'Foo', 'file' => '@/home/vagrant/test.png');\n\ncurl_setopt($ch, CURLOPT_URL, 'http://localhost/test/curl/load_file.php');\ncurl_setopt($ch, CURLOPT_POST, 1);\ncurl_setopt($ch, CURLOPT_SAFE_UPLOAD, false);    // 5.6 给改成 true了, 弄回去 \ncurl_setopt($ch, CURLOPT_POSTFIELDS, $data);\n\ncurl_exec($ch);\n\n65.IP地址转换为整数型\n$ipArr  = explode('.',$_SERVER['REMOTE_ADDR']);\n$ip     = $ipArr[0] * 0x1000000\n        + $ipArr[1] * 0x10000\n        + $ipArr[2] * 0x100\n        + $ipArr[3];\n        //数字型的IP转为字符型:\n$ipVal = $row['client_IP'];\n$ipArr = array(\n        0 => floor(  $ipVal / 0x1000000) );\n$ipVint   = $ipVal-($ipArr[0]*0x1000000); // for clarity\n$ipArr[1] = ($ipVint & 0xFF0000)  >> 16;\n$ipArr[2] = ($ipVint & 0xFF00  )  >> 8;\n$ipArr[3] =  $ipVint & 0xFF;\n$ipDotted = implode('.', $ipArr);\n66.保存base64图片\n$base64_url = 'data:image/jpeg;base64,xxxxxxxxxxxxxxxxxxxxxx';\n$base64_body = substr(strstr($base64_url,','),1);\n$data= base64_decode($base64_body );\n\n//存储or创建图片：\n\nfile_put_contents($file_path,$data);\n\n或$image = imagecreatefromstring($data);\n $size  =  getimagesizefromstring ( $data);var_dump($size);\n\n//读取图片文件，转换成base64编码格式\n$image_file = 'test.jpg';\n$image_info = getimagesize($image_file);\n$base64_image_content = \"data:{$image_info['mime']};base64,\" . chunk_split(base64_encode(file_get_contents($image_file)));\n \n//保存base64字符串为图片\n//匹配出图片的格式\nif (preg_match('/^(data:\\s*image\\/(\\w+);base64,)/', $base64_image_content, $result)){\n  $type = $result[2];\n  $new_file = \"./test.{$type}\";\n  if (file_put_contents($new_file, base64_decode(str_replace($result[1], '', $base64_image_content)))){\n    echo '新文件保存成功：', $new_file;\n  }\n \n}\n?>\n \n<img src=\"<?php echo $base64_image_content;?>\" />\n67.日志记录print_r( $value, true )\n/**\n\n错误日志类\n*/\nclass C_Log\n{\n/**\n\n日志保存目录\n\n@var string\n*/\nprivate $path = '';\n/**\n\n只能运行一个实例\n\n@var [type]\n*/\nprivate static $instance;\n/**\n\n构造函数\n\n初始化日志文件地址\n*/\nfunction __construct($path)\n{\n$this->path = $path;\n}\n\npublic function logPrint($name,$value)\n{\n\n   //获取时间\n   $_o = date('Y-m-d H:m:s',time()).\"\\r\\n\";\n   $_o .= \"==\".  $name . \"==\";\n   //打印内容\n   if( is_array( $value ) || is_object( $value ) ){\n       $_o .= print_r( $value, true ). \"\\r\\n\";\n     } else {\n         $_o .= $value. \"\\r\\n\";\n     }\n     //输出到文件\n     $this->_log($_o);\n}\n/**fdf\n\n打印日志\n\n@return [type] [description]\n*/\nprivate function _log($log){\nerror_log($log,3,$this->path);\n}\n/**\n\n输出日志\n\n@return [type] [description]\n*/\npublic static function log($name, $value)\n{\nif (empty(self::$instance)) {\n\n   self::$instance = new C_Log(__DIR__.\"/error_log.log\");\n}\nself::$instance->logPrint($name, $value);\n}\n}\n\n68.过滤子类\nfunction getByClass(parent, classname) {\n    var tags = parent.getElementsByTagName('*');\n    return [].filter.call(tags, function(t) {\n        return t.classList.contains(classname);\n    });\n}\n//\n\nfunction getByClass(parent, classname) {\n    return parent.querySelectorAll(\".\" + classname);\n}\n69.JSON.stringify\nfunction setProp(obj) {\n    for (var p in obj) {\n        switch (typeof (obj[p])) {\n            case 'object':\n                setProp(obj[p]);\n                break;\n            case 'undefined':\n                obj[p] = '';\n                break;\n        }\n    }\n    return obj;\n}\n\nJSON.stringify(setProp({ a: 1, b: 2, c: undefined }));//{\"a\":1,\"b\":2,\"c\":\"\"}\n\n70.判断用户的IP是否局域网IP\nfunction is_local_ip($ip_addr = null) {\n    if (is_null($ip_addr)) {\n        $ip_addr = $_SERVER['REMOTE_ADDR'];\n    }\n    $ip = ip2long($ip_addr);\n    return $ip & 0xffff0000 == 0xc0a80000 // 192.168.0.0/16\n        || $ip & 0xfff00000 == 0xac100000 // 172.16.0.0/12\n        || $ip & 0xff000000 == 0xa0000000 // 10.0.0.0/8\n        || $ip & 0xff000000 == 0x7f000000 // 127.0.0.0/8\n    ;\n}\n71.遍历出当月的所有日子和星期\nvar d = new Date();         // 这是当天\nd.setDate(1);               // 这就是1号\nvar weekday = d.getDay();   // 1号星期几，从星期天为0开始\n\nd.setMonth(d.getMonth() + 1);\nd.setDate(0);               // 这两句得到最当月最后一天\nvar end = d.getDate();      // 最后一天的日，比如8月就是31\n\nvar days = [];\nfor (var i = 0; i < end; i++) {\n    days[i] = {\n        day: i + 1,\n        week: (weekday + i) % 7\n    }\n}\n\n\nconsole.log(days);\n72.Downloading Data From localStorage\nvar myData = {\n    'a': 'a',\n    'b': 'b',\n    'c': 'c'\n};\n// add it to our localstorage\nlocalStorage.setItem('data', JSON.stringify(myData));\n\n// encode the data into base64\nbase64 = window.btoa(localStorage.getItem('data'));\n\n// create an a tag\nvar a = document.createElement('a');\na.href = 'data:application/octet-stream;base64,' + base64;\na.innerHTML = 'Download';\n\n// add to the body\ndocument.body.appendChild(a);\n\n73.\"数据类型\"判断函数\nfunction datatypeof(arg){\n    return Object.prototype.toString.call(arg).match(/\\[object\\s(\\w+)\\]/)[1];\n}\n74.二维数组去除重复，重复值相加\n$arr = array(\n    array('id' => 123, 'name' => '张三', 'amount'=>'1'),\n    array('id' => 123, 'name' => '李四', 'amount' => '1'),\n    array('id' => 124, 'name' => '王五', 'amount' => '1'),\n    array('id' => 125, 'name' => '赵六', 'amount' => '1'),\n    array('id' => 126, 'name' => '赵六', 'amount' => '2'),\n    array('id' => 126, 'name' => '赵六', 'amount' => '2')\n);\n\n$new = array();\n\nforeach($arr as $row){\n    if(isset($new[$row['name']])){\n        $new[$row['name']]['amount'] += $row['amount'];\n    }else{\n        $new[$row['name']] = $row;\n    }\n}\n\n75.含有从属关系的元素重新排列\n$arr = array(\n    array('id'=>21, 'pid'=>0, 'name'=>'aaa'),\n    array('id'=>22, 'pid'=>0, 'name'=>'bbb'),\n    array('id'=>23, 'pid'=>0, 'name'=>'ccc'),\n    array('id'=>24, 'pid'=>23, 'name'=>'ddd'),\n    array('id'=>25, 'pid'=>23, 'name'=>'eee'),\n    array('id'=>26, 'pid'=>22, 'name'=>'fff'),\n    );\n\n$temp=[];\nforeach ($arr as $item)\n{\n    list($id,$pid,$name) = array_values($item); // 取出数组的值并分别生成变量\n\n    if(array_key_exists($pid, $temp)) \n    // 检查临时数组$temp中是否存在键名与$pid的值相同的键\n    {\n        $temp[$pid]['child'][]=array('id'=>$id,'pid'=>$pid,'name'=>$name);\n        // 如果存在则新增数组至临时数组中键名为 $pid 的子元素 child 内\n    }else\n        $temp[$id]=array('id'=>$id,'pid'=>$pid,'name'=>$name);\n        // 如果不存在则新增数组至临时数组中并设定键名为 $id\n}\n\n$array = array_values($temp);\n// 将临时数组中以 $id 为键名的键修改为数字索引\n\necho \"<pre>\";\nprint_r($array);\n//or \nforeach ($arr as $item)\n{\n    if (array_key_exists($item['pid'], $temp))\n    {       \n        $temp[$item['pid']]['child'][]=$item;\n    }else\n        $temp[$item['id']]=$item;\n}\n76.随机中文字符\n//正则表达式匹配中文[\\u4e00-\\u9fa5]\n//parseInt(\"4E00\",16) 19968 parseInt(\"9FA5\",16);20901\nvar randomHz=function(){\n    eval( \"var word=\" +  '\"\\\\u' + (Math.round(Math.random() * 20901) + 19968).toString(16)+'\"');\n    return word;\n}\nfor(i=0;i<100;i++){\n    console.log(randomHz());\n}\n77.jQuery解析url\n$(document).ready(function () {\n    var url = 'http://iwjw.com/codes/code-repository?id=12#top';\n    var a = $('<a>', { href: url});\n    var sResult = '<b>Protocol:</b> ' + a.prop('protocol') + '<br>'     + '<b>Host name: </b>' + a.prop('hostname') + '<br>'\n    + '<b>Path: </b>' + a.prop('pathname') + '<br>'\n    + '<b>Query: </b>' + a.prop('search') + '<br>'\n    + '<b>Hash: </b>' + a.prop('hash');\n    $('span').html(sResult);\n});\n78.用JS实现一个数组合并的方法（要求去重）\nvar arr1 = ['a'];\nvar arr2 = ['b', 'c'];\nvar arr3 = ['c', ['d'], 'e', undefined, null];\n\nvar concat = (function(){\n  // concat arr1 and arr2 without duplication.\n  var concat_ = function(arr1, arr2) {\n    for (var i=arr2.length-1;i>=0;i--) {\n      arr1.indexOf(arr2[i]) === -1 ? arr1.push(arr2[i]) : 0;\n    }\n  };\n  // concat arbitrary arrays.\n  // Instead of alter supplied arrays, return a new one.\n  return function(arr) {\n    var result = arr.slice();\n    for (var i=arguments.length-1;i>=1;i--) {\n      concat_(result, arguments[i]);\n    }\n    return result;\n  };\n}());\n执行：concat(arr1, arr2, arr3)\n返回：[ 'a', null, undefined, 'e', [ 'd' ], 'c', 'b' ]\nvar merge = function() {\n    return Array.prototype.concat.apply([], arguments)\n  }\n\nmerge([1,2,4],[3,4],[5,6]);\n//[1, 2, 4, 3, 4, 5, 6]\n79.字节转化\nfunction convert($size)\n{\n    $unit = array('b', 'kb', 'mb', 'gb', 'tb', 'pb');\n\n    return @round($size / pow(1024, ($i = floor(log($size, 1024)))), 2) . ' ' . $unit[$i];\n}\necho convert(memory_get_usage());\nfunction cacheMem($key)\n{\n    static $mem = null;\n    if ($mem === null) {\n        $mem = new Memcache();\n        $mem->connect('127.0.0.1', 11211);\n    }\n\n    $data = $mem->get($key);\n    if (empty($data)) {\n        $data = date('Y-m-d H:i:s');\n        $mem->set($key, $data);\n    }\n\n    return $data;\n}\n\n                ", "mainLikeNum": ["3 "], "mainBookmarkNum": "15"}