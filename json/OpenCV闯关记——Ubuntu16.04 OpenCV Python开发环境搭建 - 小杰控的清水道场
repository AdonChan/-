{"title": "OpenCV闯关记——Ubuntu16.04 OpenCV Python开发环境搭建 - 小杰控的清水道场 ", "index": "opencv-python,python", "content": "闯关记简介\n由于近期项目需要完成一个图像分析的任务，而以前也对OpenCV有所耳闻，但没有技术和产品上的需求，所以虽然想找时间玩玩，但苦于时间的紧张，一直没有真正去touch，这次打算正好利用这次机会做深入一点的研究。\n实验环境\n\nUbuntu 16.04 64 Bits\nPython2.7\nOpenCV 3.1.0\n\n那么，我们就愉快的开始这段奇幻之旅吧！\n安装OpenCV的依赖\n更新 apt-get\nsudo apt-get update\nsudo apt-get upgrade\n更新一些必要的第三方开发者工具\nsudo apt-get install build-essential cmake pkg-config\n做图像处理，图像I/O相关的库必不可少\nsudo apt-get install libjpeg8-dev libtiff5-dev libjasper-dev libpng12-dev\n当然也需要一些视频相关的库\nsudo apt-get install libavcodec-dev libavformat-dev libswscale-dev libv4l-dev\nsudo apt-get install libxvidcore-dev libx264-dev\n在带X-Window的系统中OpenCV用到的 highgui 所需的依赖\nsudo apt-get install libgtk-3-dev\nOpenCV矩阵计算算法优化所用到的库\nsudo apt-get install libatlas-base-dev gfortran\nPython语言绑定所需要的开发包\nsudo apt-get install python2.7-dev python3.5-dev\n下载OpenCV源码包\nOpenCV 3.1.0\ncd ~\nwget -O opencv.zip https://github.com/Itseez/opencv/archive/3.1.0.zip\nunzip opencv.zip\nOpenCV 3.1.0 Contribution版也会用到\nwget -O opencv_contrib.zip https://github.com/Itseez/opencv_contrib/archive/3.1.0.zip\nunzip opencv_contrib.zip\n建立Python虚拟环境，以隔离对其他环境的影响\n获取 pip 模块\ncd ~\nwget https://bootstrap.pypa.io/get-pip.py\nsudo python get-pip.py\n安装 virtualenv\nsudo pip install virtualenv\nsudo rm -rf ~/get-pip.py ~/.cache/pip\n创建Python虚拟环境\nmkdir ~/.virtualenvs\ncd ~/.virtualenvs\nvirtualenv cv -p python2\n安装 numpy 模块\n这里比较坑，因为国内网络原因，下载了很多遍都下不下来，考虑过以下几种方法解决，只有最后一种方法对我来说work：\n\n使用国外VPN，我使用的是日本和韩国的VPN，速度会快一些，但是几次都是在最后一点快成功的时候失败了……\n使用douban的源，没办法，直接报错……\n不直接使用“pip install”，而是先wget下whl包，然后在“pip install”这个whl包\n\nsource ~/.virtualenvs/cv/bin/python\nwget https://pypi.python.org/packages/5e/d5/3433e015f3e4a1f309dbb110e8557947f68887fe9b8438d50a4b7790a954/numpy-1.11.2-cp27-cp27mu-manylinux1_x86_64.whl#md5=fa62a11922a9e0776963508fb5254d3d\npip install numpy-1.11.2-cp27-cp27mu-manylinux1_x86_64.whl\n编译OpenCV库\n好啦，前面的准备工作都做好了，接下来要开始编译OpenCV库！\ncd ~/opencv-3.1.0/\nmkdir build\ncd build\ncmake -D CMAKE_BUILD_TYPE=RELEASE \\\n    -D CMAKE_INSTALL_PREFIX=/usr/local \\\n    -D INSTALL_PYTHON_EXAMPLES=ON \\\n    -D INSTALL_C_EXAMPLES=OFF \\\n    -D OPENCV_EXTRA_MODULES_PATH=~/opencv_contrib-3.1.0/modules \\\n    -D PYTHON_EXECUTABLE=~/.virtualenvs/cv/bin/python \\\n    -D BUILD_EXAMPLES=ON ..\n毕竟在前面已经耗费了很多精力，到这里应该很快就能结束战斗了，但是……还是太天真了！在下载“ippicv_linux_20151201.tgz”包的时候，有卡住了，这个30+M的包就是下不下来……果断找资料，原来可以先手动下载这个包，然后在重新开始编译，这样就可以顺序进行下去了。\ncp ippicv_linux_20151201.tgz ~/opencv-3.1.0/3rdparty/ippicv/downloads/linux-808b791a6eac9ed78d32a7666804320e/ippicv_linux_20151201.tgz\ncmake -D CMAKE_BUILD_TYPE=RELEASE \\\n    -D CMAKE_INSTALL_PREFIX=/usr/local \\\n    -D INSTALL_PYTHON_EXAMPLES=ON \\\n    -D INSTALL_C_EXAMPLES=OFF \\\n    -D OPENCV_EXTRA_MODULES_PATH=~/opencv_contrib-3.1.0/modules \\\n    -D PYTHON_EXECUTABLE=~/.virtualenvs/cv/bin/python \\\n    -D BUILD_EXAMPLES=ON ..\nmake -j2    # 2 stand for the cpu number\nsudo make install\nsudo ldconfig\n编译结束，检查编译是否成功\nls -l /usr/local/lib/python2.7/site-packages/ | grep cv2.so\n完成OpenCV Python语言绑定\n创建软连接到虚拟环境\ncd ~/.virtualenvs/cv/lib/python2.7/site-packages/\nln -s /usr/local/lib/python2.7/site-packages/cv2.so cv2.so\n测试Python的OpenCV模块\npython\n>>> import cv2\n>>> cv2.__version__\n'3.1.0'\n>>>\nNow everything done, get ready to roll!\nRefer\nUbuntu 16.04: How to install OpenCV\n注：本文属原创，码字辛苦，未经同意，请勿转载，最后感谢阅读！——小杰控\n\n                ", "mainLikeNum": ["1 "], "mainBookmarkNum": "3"}