{"title": "python制作pdf电子书 - 个人文章 ", "index": "python", "content": "python制作pdf电子书\n准备\n制作电子书使用的是python的pdfkit这个库，pdfkit是 wkhtmltopdf 的Python封装包，因此在安装这个之前要安装wkhtmltopdf\n安装wkhtmltopdf\n\nsudo apt-get install wkhtmltopdf  (ubantu下，不过这里安装的时候可能对应的版本不同，会出现错误，如果不行的话还请自己百度下，我安装的时候是可以的)\nwindows下的用户直接到wkhtmltopdf官网下载稳定版本，然后直接安装即可，但是安装之后需要注意的是一定要将其添加到环境变量中，否则会出现找不到路径的问题\n\npython安装依赖包\n\n以下都是我们需要用到的库\n\npip install requests\npip install BeautifulSoup4\npip install pdfkit\n\n\npdfkit的用法\n初级了解函数\n\npdfkit.from_url([url,],'demo.pdf')  这个是直接传入一个url或者一个url列表，然后通过这个函数直接将其网页转换成demo.pdf,注意这里只能转换静态文本，如果使用js一些脚本的话是不能直接转换的\npdfkit.from_string(\"<h1><a href=\"https://chenjiabing666.gituhb.io\">陈加兵的博客</a></h1>\",'demo.pdf') 这个是直接讲一个字符串转换成pdf格式的电子书，里面可以直接传一个字符串，也可以用html标签包裹这个字符串\npdfkit.from_file([file_name,],'demo.pdf')  这个是直接传入一个文件或者一个列表即是多个文件，不过这里传入的文件一般都是html格式的文件\n\n进阶\n当然知道这个是多么枯燥，生成的电子书书也不能添加各种的样式，下面我们将会介绍一些添加的样式的方法\noptions\n这个参数是上面函数的可选参数，其中制定了一些选项，详情请见http://wkhtmltopdf.org/usage/wkhtmltopdf.txt, 你可以移除选项名字前面的 '--' .如果选项没有值, 使用None, Falseor ,* 作为字典值，例子如下：\n    options = {\n            'page-size': 'Letter',\n            'margin-top': '0.75in',\n            'margin-right': '0.75in',\n            'margin-bottom': '0.75in',\n            'margin-left': '0.75in',\n            'encoding': \"UTF-8\",\n            'custom-header': [\n                ('Accept-Encoding', 'gzip')\n            ],\n            'cookie': [\n                ('cookie-name1', 'cookie-value1'),\n                ('cookie-name2', 'cookie-value2'),\n            ],\n            'outline-depth': 10,\n        }\ncover\n这个参数是用来制作封面的，也是函数中的一个参数，如果想要实现的话可以先写一个html文本，在其中嵌入几张图片或者文字作为封面，然后写入出传入函数即可\noptions = {\n            'page-size': 'Letter',\n            'margin-top': '0.75in',\n            'margin-right': '0.75in',\n            'margin-bottom': '0.75in',\n            'margin-left': '0.75in',\n            'encoding': \"UTF-8\",\n            'custom-header': [\n                ('Accept-Encoding', 'gzip')\n            ],\n            'cookie': [\n                ('cookie-name1', 'cookie-value1'),\n                ('cookie-name2', 'cookie-value2'),\n            ],\n            'outline-depth': 10,\n        }\ncover='demo.html'\npdfkit.from_file('demo.html','demo.pdf',cover=cover,options=options)\ncss\n这里的css也是函数中的一个可选参数，这个参数主要的作用作用就是在其中定义自己喜欢的样式，当然这里也可以传入一个列表，定义多个样式css文件，当然没有这个参数也可以实现定义自己的样式，只需要在自己的html模板中定义内嵌的样式，或者直接用<link>引用外面的样式即可，本人亲试是可以的，具体的使用如下\ncss='demo.css'\npdfkit.from_file('demo.html','demo.pdf',options=options,cover=cover,css=css)\n注意\n\n这里生成pdf的时候可能出现中文的乱码，请一定在html模板开头指定字体utf-8-> <meta charset=\"UTF-8\">\n可能在爬取生成的时候会出现ascii错误，只需要在py文件开头写下：\n\nimport sys\nimport threading\nreload(sys)\nsys.setdefaultencoding('utf8')\n写入文件的时候不想python3一样可以指定编码格式，这里我使用的是codecs库，可以向python3一样指定其中的编码格式\n实战\n\n本人爬了廖雪峰老师的python2.7的教程，并且做成了电子书，截图如下\n\n\n注意\n\n这里并没有使用框架，如果有兴趣的朋友可以用框架写一个爬取全站的\n这里的主要用到的是BeautifulSoup和requests,详情可以看我的博客中的BeautifulSoup用法,后续还会更新requests的用法\n源代码请见https://github.com/chenjiabing666/liaoxuefeng_pdfkit\n\n参考文章\n\nhttp://mp.weixin.qq.com/s/LH8nEFfVH4_tvYWo46CF5Q\nhttp://www.cnblogs.com/taceywong/p/5643978.html\nhttp://beautifulsoup.readthedocs.io/zh_CN/latest/#id44\n\n更多文章请移步本人博客https://chenjiabing666.github.io/\n\n\n                ", "mainLikeNum": ["0 "], "mainBookmarkNum": "4"}