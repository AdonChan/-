{"title": "python初学——网络编程之FTP服务器 - 个人文章 ", "index": "python", "content": "MYFTP是我写的模拟FTP服务端和客户端交互的程序。通过使用socket去模拟ftp的文件下载与上次两个核心功能。并不是使用真实FTP协议去实现。\n基本需求\n\n用户加密认证 # hashlib模块对用户名密码进行加密。\n允许同时多用户登录\n每个用户有自己的家目录，且只能访问自己的家目录 # 使用用户名在配置文件的固定目录中添加用户名的目录。并可以实现ls，dir功能\n对用户进行磁盘配额，每个用户的可用空间不同 # 使用os模块检查用户目录的空间+上文件大小，如果大于quota就不让传输。\n允许用户在ftp server上随意切换目录 cd功能 记录用户输入的目录，进行目录的拼接。\n允许用户查看当前目录下文件 ls功能\n允许上传和下载文件，保证文件一致性(md5)\n文件传输过程中显示进度条\n附加功能：支持文件的断点续传。比较客户端文件与服务端文件的bytes，如果不一致。客户端、服务端就使用文件seek方法移动光标。续传。\n\n需求模型\n用例名\nMYFTP\n场景\n\nwhen：任意时间\nwhere：任何地点\nwho：FTP用户\n\n用例描述\n\nftp使用用户名密码登录。密码需要加密认证、允许支持多用户登录。\n每个用户有自己的家目录，所有的访问必须限制在用户的家目录。但在家目录中创建的目录可以进行目录切换。\n用户的目录有磁盘配额。不允许超过磁盘配额。\n用户可以查看当前目录下的文件列表。\n用户可以上传和下载文件，并且保证文件的一致性。\n文件的传输过程中显示精度条。\n支持断点续传。\n\n用户价值\n实现一套自己的FTP服务端与客户端。\n约束\n暂无\n建模设计\nUML图\n顺序图\n\n登录顺序图\n\n上传顺序图\n\n程序讲解\n程序主体\n请从github下载后使用MYFTPREADME\n目录结构\n+---bin                     # 执行程序目录\n|       create_user.py      # 创建用户程序\n|       myftpc.py           # ftp_server启动程序\n|       myftps.py           # ftp_client启动程序\n|       __init__.py\n|\n+---conf\n|   |   settings.py         # 配置文件\n|   |   __init__.py\n|   |\n|   \\---__pycache__\n|\n+---core\n|   |   logger.py           # 日志生成文件\n|   |   main.py             # 主程序文件\n|   |   __init__.py \n|   |\n|   \\---__pycache__\n|\n+---db                      # 数据库目录\n|   \\---accounts            # 账号表目录\n|---id_user_rs.json         # 账号ID与用户名对应关系\n+---file_upload             # ftp文件服务器目录\n+---lib                     # 类文件\n|   |   account.py          # 账号类\n|   |   db.py               # 数据库类\n|   |   myftp_client.py     # ftp客户端类\n|   |   myftp_server.py     # ftp服务端类\n|   |   process.py          # 进度条展示类（暂时未使用）\n|   |   __init__.py\n|   |\n|   \\---__pycache__\n\\---log\n        __init__.py\n环境\n本系统基于python 3.6版本开发。可运行在安装了python 3.6版本的linux或windows系统中。\n用法\n创建FTP用户\n进入bin目录:\n> cd bin\n执行create_user.py:\n> python ./create_user.py\nAccount:test2       # 用户名\nPassword:test2      # 密码\nHome directory(test2):    # 账号的根目录。默认为账号名称\nQuota(bytes):10           # 账号的quota。默认为1G\n\n===================ACCOUNT INFO===================\n             Account:      test2\n             Home Dir:     test2\n             Quota:        10\n==================================================\n启动ftp服务端\n进入bin目录:\n> cd bin\n执行create_user.py:\n> python ./myftps.py\n启动ftp客户端\n进入bin目录:\n> cd bin\n执行create_user.py:\n> python ./myftpc.py\nFTP用于登录：\nName:test2\nPassword:test2\nAccount [test2] login successful\nftp>: \n客户端命令\n\n\nls: 查看用户当前目录的文件和目录列表\n ftp>: ls\n  驱动器 D 中的卷是 新加卷\n  卷的序列号是 020D-6062\n \n  D:\\deployment\\MYFTP\\file_upload\\test2 的目录\n \n 2018/04/16  12:17    <DIR>          .\n 2018/04/16  12:17    <DIR>          ..\n                0 个文件              0 字节\n                2 个目录 45,605,543,936 可用字节\n Directory [test2] list successful.\n ftp>: \n\n\npwd: 查看当前所在目录\nftp>: pwd\nDirectory [\\] show successful.\n\n\nmdir: 创建目录\n ftp>: mdir temp_dir\n Directory [temp_dir] create successful.\n\n\ncd：切换目录\nftp>: cd temp_dir\nDirectory [temp_dir] change successful.\n\n\nput: 上传文件-支持断点续传\nftp>: get temp_file.md\nStart download -----> temp_file.md\ntrandata: %s b'test123'\n[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>]100% recvsize:7, filesize:7\nFile [temp_file.md] download successful.\n\n\nget: 下载文件-支持断点续传\nftp>: put temp_file.md\n[>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>]100%\nFile [temp_file.md] upload successful.\n\n\n\n                ", "mainLikeNum": ["0 "], "mainBookmarkNum": "1"}