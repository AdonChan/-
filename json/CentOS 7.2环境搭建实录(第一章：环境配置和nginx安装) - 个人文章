{"title": "CentOS 7.2环境搭建实录(第一章：环境配置和nginx安装) - 个人文章 ", "index": "centos,nginx,linux,php,python", "content": "第一章：环境配置和nginx安装\n前提备注\n为了学习python相关内容，笔者在网上买了个服务器，忙活了两天终于把相关的环境搭    \n建起来了，所有的软件用的都是最新版，所以踩了很多的坑，现在把这些步骤写出来，给\n大家提供一个参考，因为第一次写文章，肯定有不足的地方，请大家多多指教。\n\n环境预览\ncentos 7.2\nnginx  1.13.8\nphp    7.2.2\npython 2.7.5/3.6.4\nmysql  5.7.18\npgsql  10.1\n\n服务器Centos\n购买地址：\nhttps://www.vultr.com/\n2.5美元一个月划到180一年，1CPU, 20GBSSD, 512M内存, 每月500G流量做为学习够用了\nhttps://www.aliyun.com/chinaglobal/promotion/overseaall2017\n也可以选择阿里海外版，比这个配置高一点，40G, 1G内存, 用完优惠券大概一年280左右\n\n准备工作\n关闭防火墙：systemctl stop firewalld.service\n查看防火墙状态：firewall-cmd --state\n安装网络工具：yum install net-tools\n安装网络工具：yum install nmap\n安装gcc工具：yum install gcc gcc-c++\n安装pcre库：yum install pcre pcre-devel\n安装zlib库：yum install zlib zlib-devel\n所有用户默认为root\n\n安装nginx\ncd /usr/local/src 该文件夹做为安装包存放点\nwget http://nginx.org/download/nginx-1.13.8.tar.gz\ntar -zxvf nginx-1.13.8.tar.gz\ncd nginx-1.13.8\n\n添加nginx用户及用户组(可以省略，自己玩可以不用添加)\ngroupadd nginx\nuseradd -r -g nginx nginx\n\n编译nginx\n./configure\n--prefix=/usr/local/nginx\n--sbin-path=/usr/local/nginx/sbin/nginx\n--conf-path=/usr/local/nginx/nginx.conf\n--pid-path=/usr/local/nginx/nginx.pid\n--user=nginx(上步省略，可去掉)\n--group=nginx(上步省略，可去掉)\n--with-http_ssl_module\n--with-http_flv_module\n--with-http_mp4_module\n--with-http_stub_status_module\n--with-http_gzip_static_module\n--http-client-body-temp-path=/var/tmp/nginx/client/\n--http-proxy-temp-path=/var/tmp/nginx/proxy/\n--http-fastcgi-temp-path=/var/tmp/nginx/fcgi/\n--http-uwsgi-temp-path=/var/tmp/nginx/uwsgi/\n--http-scgi-temp-path=/var/tmp/nginx/scgi/\n\n编译过程中如果报错，很大概率是缺少插件包，根据提示yum安装就好\n编译结束没问题执行\nmake && make install\n\n安装完成，配置nginx.conf\ncd /usr/local/nginx/\nmkdir conf.d(备用)\n\nvi nginx.conf\n将listen改成8080，43-46前的#号去掉，如下图\n\n在最后加上\ninclude conf.d/*.conf;\n\n测试nginx\n开启nginx\n/usr/local/nginx/sbin/nginx\n打开浏览器\n输入服务器ip地址:8080\n出现下图，安装成功\n\n添加环境变量(可以省略)\nvi /etc/profile\nexport PATH=$PATH:/usr/local/nginx/sbin\nsource /etc/profile\n\nnginx开机启动\ncd /lib/systemd/system/\ntouch nginx.service\n\n输入如下代码：\n# nginx service for systemd (CentOS 7.0+)\n[Unit]\nDescription=nginx\nAfter=network.target\n\n[Service]\nType=forking\nExecStart=/usr/local/nginx/sbin/nginx\nExecReload=/usr/local/nginx/sbin/nginx -s reload\nExecStop=/usr/local/nginx/sbin/nginx -s stop\nPrivateTmp=false\n\n[Install]\nWantedBy=multi-user.target\n\n保存退出\n刷新服务配置 systemctl daemon-reload\n尝试启动服务 systemctl stop nginx.service\n           systemctl start nginx.service\n           systemctl restart nginx.service         \n加入开机启动 systemctl enable nginx.service\n配置完成\n\n备注1：PrivateTmp的值设置成true，服务启动时会在/var/tmp/nginx/client/\n目录下生成类似systemd-private-433ef27ba3d46d8aac286aeb1390e1b-\nnginx.service-RedVyu/的文件夹，用于存放nginx的临时文件，但是我在测试的时\n候，执行systemctl start nginx.service命令时会报下图错误：\n\n但是执行nginx就正常启动，\n执行nginx -t查看配置文件也没有问题，\n我怀疑是用户权限导致的问题，这个问题我会后续查看，为了保险起见这里设定为false不影响使用\n\n备注2：注意下\nnginx，\n/usr/local/nginx/sbin/nginx，\nsystemctl xxxx nginx.service\n三者之间的关系，systemctl命令无法操作nginx命令开启的nginx服务，反之可以\n   \n\nnginx安装总结\n安装包存放点：/usr/local/src/\nnginx配置文件：/usr/local/nginx/nginx.conf\n项目配置目录：/usr/local/nginx/conf.d/\nnginx日志目录：/usr/local/nginx/logs/\nnginxpid文件：/usr/local/nginx/nginx.pid\nnginx启动文件：/usr/local/nginx/sbin/nginx\n\n启动nginx\nnginx(配置完环境变量可使用)\n/usr/local/nginx/sbin/nginx\n\n停止nginx\nnginx -s stop(配置完环境变量可使用)\n/usr/local/nginx/sbin/ngin -s stop\n\n重启nginx\nnginx -s reload(配置完环境变量可使用)\n/usr/local/nginx/sbin/nginx -s reload\n\nsystemctl相关命令\n开启nginx服务 systemctl start nginx.service\n停止nginx服务 systemctl stop nginx.service\n重启nginx服务 systemctl restart nginx.service\n查看nginx服务 systemctl status nginx.service\n加入开机自启 systemctl enable nginx.service\n退出开机自启 systemctl disable nginx.service\n刷新服务配置 systemctl daemon-reload\n查看已开启服务 systemctl list-unit --type=service \n\n其他文章：第二章：php安装 第三章：mysql安装和postgresql安装第四章：python环境配置\n相关链接：CentOS 7 systemd添加自定义系统服务\n\n                ", "mainLikeNum": ["5 "], "mainBookmarkNum": "13"}