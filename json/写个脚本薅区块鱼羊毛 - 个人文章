{"title": "写个脚本薅区块鱼羊毛 - 个人文章 ", "index": "区块链,webdriver,python", "content": "  区块鱼是一个基于区块链的游戏，这个游戏目前有个邀请活动，邀请好友注册，送相应种类的鱼，不同的鱼价格不一样\n\n普通鱼 0.015 ETH起(邀请3个好友)\n稀缺鱼 0.05 ETH起(邀请15个好友)\n史诗鱼 0.35 ETH起(邀请100个好友)\n传奇鱼 1.5 ETH起(邀请1000个好友)\n\n最重要的是，这个网站是用邮箱注册的，并且没有屏蔽掉临时邮件服务，所以我们就有嘿嘿嘿了。\n工具准备\n\n一个临时邮箱服务：我这地方选用的是YOPmail\n\nPython\nchrome webdriver\nselenium\niterm2(安装imgcat 工具): 因为要输入验证码，所以选用iterm2，这样可以把验证码图片输出到终端。\n\n步骤\n获取自己的邀请链接\n  去区块鱼的网站，注册一个账户，获取到自己的邀请链接。\n获取一个临时邮箱\n打开YOPmail网站，获取一个邮箱地址，如下图\n注意第一张图片，有个查看邮箱按钮，输入临时邮箱，点击这个按钮，就可以查看这个临时邮箱收到的邮件，这在获取激活连接有用。整个流程代码实现如下：\n    driver.get('http://www.yopmail.com/zh/email-generator.php')\n    time.sleep(1)\n    email = driver.find_element_by_id(\"login\")\n    email = email.get_attribute('value')\n模拟邀请注册\n\n上一步，我们获取到了临时邮箱\n打开自己的邀请链接，然后依次点击登录->注册，然后填写注册信息，如下图\n\n\n代码如下\n    driver.get('http://my.fishbank.io/go/122169')\n    time.sleep(1)\n    login_btn = driver.find_element_by_css_selector('.button.red.bigrounded.big')\n    login_btn.click()\n    driver.get('https://my.fishbank.io/register')\n    time.sleep(1)\n    email_input = driver.find_element_by_id('user_email')\n    password_one = driver.find_element_by_id('user_plainPassword_first')\n    password_two = driver.find_element_by_id('user_plainPassword_second')\n    cap_input = driver.find_element_by_id('user_captcha')\n    register_btn = driver.find_element_by_css_selector('.button.green.bigrounded.mid')\n因为有验证码的问题，而且简单的验证码识别库还得识别不出来，所以，这地方不打算花太多时间，直接把验证码图打印到终端，手动输入\n    cap = driver.find_element_by_class_name('captcha_image')\n    with open(image_path, 'wb') as fi:\n        fi.write(base64.b64decode(cap.get_attribute('src').split(',')[1]))\n    os.system(imgcat+' '+image_path)\n    code = input('输入验证码')\n填入数据，点击注册按钮\n    password = ''.join(random.sample(string.ascii_letters+string.digits, 10))\n    email_input.send_keys(email)\n    password_one.send_keys(password)\n    password_two.send_keys(password)\n    cap_input.send_keys(code)\n    time.sleep(2)\n    register_btn.click()\n邮箱激活\n注册成功后，我们的临时邮箱就会收到一封注册激活的邮件，打开第一步的邮箱页面，输入邮箱，点击检查按钮，就可以打开邮箱了。\n    driver.get('http://www.yopmail.com/zh/')\n    time.sleep(1)\n    email_input = driver.find_element_by_id('login')\n    check_btn = driver.find_element_by_class_name('sbut')\n    email_input.send_keys(email)\n    check_btn.click()\n打开邮箱页面后，我发现，邮箱的内容是以iframe的形式展现的，所以，这地方要处理一下：\n    driver.switch_to_frame(driver.find_element_by_id('ifmail'))\n    try:\n        html = driver.find_element_by_id('mailmillieu')\n    except Exception as e:\n        input('遇到机器识别的问题，切换到浏览器点击一下，验证完敲一下回车')\n        html = driver.find_element_by_id('mailmillieu')\n    html = html.text\n    active_url = html.split('account:')[1].strip()\n    driver.get(active_url)\n    time.sleep(1)\n    driver.delete_all_cookies()\n    time.sleep(1)\n\n这地方有个需要注意的地方，就是打开邮箱次数多了，YOPmail会出一个机器识别的检测，所以代码中有个try catch语句，来判断是否遇到了这个机器检测，如果遇到了，则需要自己点击一下那个检测，然后继续运行代码。\n获取到注册链接后，直接打开激活就可以了。\n\n成果展示\n\n总结\n\n这个脚本就是简单的利用python的selenium库，来模拟用户注册的流程，以达到邀请用户的目的。\n这个脚本也有很多不完善的地方，比如验证码识别、机器人检测、一些错误判断都没有，待完善的地方还有很多。\n这个脚本只是为了和大家交流学习。\n\n相关资源\n详细代码地址：https://github.com/xiaochao/CatchFish\n\n\n                ", "mainLikeNum": ["0 "], "mainBookmarkNum": "2"}