{"title": "Python脚本用到的库的抽取 - watermelon ", "index": "c++,python", "content": "######################################\n#下面所有部分是相关的pyc抽取函数\n#获得程序中所有模块的路径\ndef getModulesPath():\n    lst = []\n    #sys.modules是一个字典，数据格式如下：\n    #{'site': <module 'site' from 'D:\\Python27\\lib\\site.pyc'>,\n    for v in sys.modules.itervalues() :\n        s = str(v)\n        if \"from\" in s:\n            data = s.split(\"'\")\n            lst.append(data[-2])\n        else :\n            print \"module : \", s\n    return lst\n\n#抽取文件\ndef extractFiles(destDir, files):\n    destDir.replace(\"/\", \"\\\\\")\n    if destDir[-1] != '\\\\' :\n        destDir += '\\\\'\n\n    for f in files :\n        dest = filiterPath(destDir, f)\n        copyF(dest, f)\n\n#过滤路径 去掉最大绝对路径\ndef filiterPath(destDir, srcFile):\n    dest = destDir\n    maxLen = 0\n    for path in sys.path:\n        lenp = len(path)\n        if lenp < len(srcFile) and path == srcFile[:lenp]:\n            if maxLen < lenp:\n                dest = destDir + srcFile[lenp+1:]\n                maxLen = lenp\n\n    dest.replace(\"/\", \"\\\\\")\n    if '.' in dest: #去掉文件名\n        p = dest.rfind('\\\\')\n        if p >= 0:\n            dest = dest[:p]\n    return dest\n\n#拷贝文件\n#如果目标路径不存在，则创建\ndef copyF(destDir, srcFile):\n    if not os.path.isfile(srcFile):\n        print \"error : file %s not exist!\" % srcFile\n        return False\n    if not os.path.isdir(destDir):\n        os.mkdir(destDir)\n        print \"make dir:\", destDir\n    try:\n        shutil.copy2(srcFile, destDir)\n        print \"copy file : %s to %s\" % (srcFile, destDir)\n    except IOError:\n        print \"error : copy %s to %s faild\" % (srcFile, destDir)\n        return False\n    return True\n\ndef test():\n    a = getModulesPath()\n    extractFiles(\"testpg\\\\\", a) #抽取后的文件会放到testpg目录下\n\n\n参考http://blog.csdn.net/you_lan_hai/article/details/7930866http://blog.csdn.net/xiadasong007/article/details/4512797\n\n                ", "mainLikeNum": ["0 "], "mainBookmarkNum": "0"}