{"title": "python下的sqlite使用 - 通读Python官方文档 ", "index": "sqlite3,python", "content": "环境：python2.7\n在处理微信朋友圈数据的过程中，需要对sqlite进行一些处理，只处理增量数据。已经处理过的，不再处理。\n使用rowid\n在sqlite中有64位的 ROWID，ROWID默认是自增的。我们用这个特性，来处理我们的增量数据。\n记录上次ROWID\n创建一个sqlite记录数据\n# coding=utf-8\nimport sqlite3\n\nconn0 = sqlite3.connect('local_info.db')\n# 获取表名列表\ntables = conn0.execute(\"SELECT tbl_name FROM sqlite_master WHERE type='table'\")\n# 如果表不存在，则创建表\nif ('device_rowid_table',) not in list(tables):\n    conn0.execute('''CREATE TABLE device_rowid_table\n                    (\n                    # 设备列表\n                    device CHAR(20) NOT NULL,\n                     # 此前处理过的最大rowid\n                     max_rowid INT NOT NULL\n                     );\n\n    ''')\n\n# 插入一条数据：假设，我们已经处理了3fa5684f7d53设备中的前10条数据\nconn0.execute('INSERT INTO device_rowid_table (device, max_rowid) VALUES (\"3fa5684f7d53\", 40)')\nconn0.commit()\n\ndevice_id = '3fa5684f7d53'\nmax_rowid = 0\nfor device, rowid in conn0.execute('select * from device_rowid_table'):\n    if device==device_id:\n        max_rowid = rowid\n\nprint max_rowid\n\nconn1 = sqlite3.connect('3fa5684f7d53_1479459121.18.db')\nrow_num = conn1.execute('select count(*) from SnsInfo')\nprint list(row_num)\nconn1.execute('DELETE FROM SnsInfo WHERE ROWID<{}'.format(max_rowid))\nconn1.commit()\nrow_num = conn1.execute('select count(*) from SnsInfo')\nprint list(row_num)\n\n\n                ", "mainLikeNum": ["0 "], "mainBookmarkNum": "1"}