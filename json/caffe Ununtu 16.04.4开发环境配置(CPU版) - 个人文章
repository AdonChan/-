{"title": "caffe Ununtu 16.04.4开发环境配置(CPU版) - 个人文章 ", "index": "python", "content": "caffe是一种常用的深度学习框架，主要应用在视频、图像处理方面的应用上。由于没钱买gpu，只能在虚拟机环境下配置Ubuntu CPU版caffe开发环境，大家勿笑。\n\n1.首先，先安装依赖库：\nsudo apt-get install libprotobuf-dev libleveldb-dev libsnappy-dev libopencv-dev libhdf5-serial-dev protobuf-compiler\nsudo apt-get install --no-install-recommends libboost-all-dev\nsudo apt-get install libatlas-base-dev\nsudo apt-get install libgflags-dev libgoogle-glog-dev liblmdb-dev\n\n2.下载编码caffe源码\n如果没有安装git，请先安装：\n    sudo apt-get install git\n下载caffe源码：\n    git clone https://github.com/BVLC/caffe.git\n    cd caffe\n    cp Makefile.config.example Makefile.config\n或：\n    mv Makefile.config.example Makefile.config\n打开配置文件：\n    vim Makefile.config\n修改配置文件\n    # CPU_ONLY:=1\n改为：\n    CPU_ONLY:=1\n   INCLUDE_DIRS := $(PYTHON_INCLUDE) /usr/local/include\nLIBRARY_DIRS := $(PYTHON_LIB) /usr/local/lib /usr/lib改为：\n    INCLUDE_DIRS := $(PYTHON_INCLUDE) /usr/local/include /usr/include/hdf5/serial/\n    LIBRARY_DIRS := $(PYTHON_LIB) /usr/local/lib /usr/lib /usr/lib/x86_64-linux-gnu/hdf5/serial/\n注意：最后面的斜杠/不能去掉，否则编译会报错进入目录，并打开终端\n    cd /usr/lib/x86_64-linux-gnu/\nubuntu 16.04.4自带python3.5，但需要找出该so库的版本号：\n    find .|xargs grep -rl \"libboost_python-py35.so.\"\n    ./libboost_mpi_python-py35.so.1.58.0\n    ./libboost_python-py35.so.1.58.0\n    ./libboost_mpi_python-py35.so.1.58.0\n    ./libboost_python-py35.so.1.58.0\n    ./libboost_python-py35.so\n    ./libboost_mpi_python-py35.so\n该so库的版本号为1.58.0，软链到/usr/local/lib/\n    sudo ln -s /usr/lib/x86_64-linux-gnu/libboost_python-py35.so.1.58.0 /usr/local/lib/libboost_python3.so\n至此，caffe CPU版配置完毕，下面开始编译caffe\n    sudo make all -j4\n    sudo make test\n    sudo make runtest -j4\n    \n注：如何编译报错，去掉后面的-j4再试试\n4.安装python库\n进入python目录\n    cd python\n查看是ubuntu否有安装pip3，如果没安装会出现如下提示:\n    pip3 -v\n    The program 'pip3' is currently not installed. You can install it by typing:sudo apt install python3-pip\n安装pip3:\n    sudo apt install python3-pip\n    \n修改用户配置文件：\nvim ~/.bashrc\n在最后一行加入：\nexport PYTHONPATH=/caffepath/python:$PYTHONPATH\n加载配置文件：\n    sudo ldconfig\n安装numpy库：\n    sudo apt-get install python-numpy\n编译caffe，在caffe目录运行：\n    sudo make pycaffe -j16\n    \n安装成功后，进入python2(python2对caffe的支持比较好)进行测试：\n    python\n    import caffe\n    \n报错：\n    ImportError: No module named skimage.io\n于是考安装skimage.io：\n    sudo pip install scikit-image\n     \n结果发现运行pip报错，真是倒霉的时候喝水都会呛着。错误信息如下：\n    Traceback (most recent call last):\n    File \"/usr/bin/pip\", line 9, in <module>\n    from pip import main\n    ImportError: cannot import name 'main'\n     \n问了一下度娘，还好有解，先修改pip3:\n    sudo vi /usr/bin/pip3\n原文：   from pip import main 修改后： from pip._internal import main然后修改pip：\n    sudo vi /usr/bin/pip\n原文：\n    from pip import main  \n    if __name__ == '__main__':  \n         sys.exit(main()) \n         \n修改为：\n    from pip import __main__\n    if __name__ == '__main__':  \n        sys.exit(__main__._main())\n     \n然后输入pip -V验证：\n    pip -V\n    pip 18.0 from /usr/local/lib/python2.7/dist-packages/pip (python 2.7)\n    \n继续安装scikit-image:\n    sudo pip install scikit-image\n    \n安装成功后，继续输入：\n    import caffe\n    No module named google.protobuf.internal\n    \ngoogle.protobuf缺失，安装protobuf\n   sudo pip install protobuf\n   \n安装完毕后输入\n    python\n    import caffe\n如果无错误提示，则说明caffe已经成功安装！\n\n                ", "mainLikeNum": ["0 "], "mainBookmarkNum": "0"}