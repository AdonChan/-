{"title": "解决Python虚拟环境virtualenv下不能使用sudo提升权限问题 - 个人文章 ", "index": "python,django", "content": "　解决Python虚拟环境下不能使用sudo提升权限问题\n问题描述\n在虚拟环境下，执行某些命令需要有sudo提升权限，会导致该条命令退出虚拟环境:\n如启动django 服务，需要监听80端口:\n$: python manage.py runserver 80\nPerforming system checks...\n \nSystem check identified no issues (0 silenced).\nMarch 15, 2018 - 07:43:40\nDjango version 2.0.3, using settings 'helloworld.settings'\nStarting development server at http://127.0.0.1:80/\nQuit the server with CONTROL-C.\nError: You don't have permission to access that port.\n此时会提示权限不足，无法访问80端口。\n所以通过sudo提升命令权限:\n$: ~/python3env/helloworld$ sudo python manage.py runserver 80\nTraceback (most recent call last):\n  File \"manage.py\", line 11, in <module>\n    \"Couldn't import Django. Are you sure it's installed and \"\nImportError: Couldn't import Django. Are you sure it's installed and available on your PYTHONPATH environment variable? Did you forget to activate a virtual environment?\n\n此时会提示没有找到Django模块，可是经过如下验证，Django模块安装正常:\n$: python\nPython 3.5.2 (default, Nov 23 2017, 16:37:01) \n[GCC 5.4.0 20160609] on linux\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n>>> import django\n>>> django.__version__\n'2.0.3'\n而使用sudo启动python，会发现，Django模块无法导入:\n$: sudo python\nPython 2.7.12 (default, Dec  4 2017, 14:50:18) \n[GCC 5.4.0 20160609] on linux2\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n>>> import django\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\nImportError: No module named django\n原来，在使用sudo执行命令的时候，该命令会退出当前虚拟环境执行:\n$: sudo which python\n/usr/bin/python\n$: which python\n/home/hzc/python3env/venv/bin/python\n解决办法\n\n\n指定python路径\n$: sudo ../venv/bin/python manage.py runserver 80\nPerforming system checks...\n\nSystem check identified no issues (0 silenced).\nMarch 15, 2018 - 07:55:29\nDjango version 2.0.3, using settings 'helloworld.settings'\nStarting development server at http://127.0.0.1:80/\nQuit the server with CONTROL-C.\n\n\n\n在脚本中指定python地址(局限于执行脚本)\n#!/usr/bin/env python 更改前\n#!/home/hzc/python3env/venv/bin/python 更改后\n执行脚本:\n$: sudo ./manage.py runserver 80\nPerforming system checks...\n\nSystem check identified no issues (0 silenced).\nMarch 15, 2018 - 08:02:48\nDjango version 2.0.3, using settings 'helloworld.settings'\nStarting development server at http://127.0.0.1:80/\nQuit the server with CONTROL-C.\n​\n\n\n\n                ", "mainLikeNum": ["0 "], "mainBookmarkNum": "0"}