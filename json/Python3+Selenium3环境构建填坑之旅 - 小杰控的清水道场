{"title": "Python3+Selenium3环境构建填坑之旅 - 小杰控的清水道场 ", "index": "python,windows", "content": "全文简介\n最早使用Selenium还是几年前写GUI自动化用例的时候，当时用的框架是Robot Framework+Selenium2Library。当初使用的时候碰到一些问题，但是安装过程还是比较简单和顺利的。随着Python3的普及，Selenium3也跟上了行程。而Selenium3最大的变化是去掉了Selenium RC，另外就是Webdriver从各自浏览器中脱离，必须单独下载。今天就以Firefox为例，给出Windows10 64位上的安装教程和一些简要的使用例子。\n环境安装\n安装Python3\n前往Python官网下载最新版本的Python3，笔者安装的是Python3.5.2。Python官网传送门\n安装Selenium3\n安装好Python3之后，默认就会有pip，使用pip进行安装：\npip install selenium\n按照以往的经验，安装完之后就可以愉快的玩耍了；但是突然蹦出来了个错误让我顿时懵逼。就如本文简介中所述，Selenium3有了一些比较大的改变，其中之一就是Webdriver从浏览器中分离出来了，所以需要单独安装，以下以Firefox为例给出安装过程。\n安装Firefox geckodriver\n\n\n下载：最新版本是v0.11.1\n\n官网下载地址传送门 需翻墙\nCSDN下载地址传送门 如无积分，可联系我哦：woods2001@126.com\n\n\n\n解压缩：该软件无需安装，解压缩即可\n比如解压缩到路径： D:/browser_drivers/\n\n设置环境变量：需讲上一步的解压缩路径添加的Windows环境变量中\n\n添加Firefox可执行程序到系统环境变量\n本以为做到上一步就万事大吉，可以开始玩了，谁料当我屁颠屁颠coding的时候，又报错了……原来还需要将Firefox的可执行程序路径也添加到环境变量中，最后添加完了所有环境变量。\nSelenium简要教程\n到此，总算可以愉快的玩耍了，所以事情和预期的一样，情况尽在掌握之中！~\n贴出一段简要的代码，仅供参考，这段代码做了以下几件事：\n\n打开Firefox浏览器\n打开baidu页面\n搜索了“pycon”和“python selenium programmer”\n打开了百度用户注册页面\n在注册页面和搜索页面之间进行自由切换\n\nimport time\nfrom selenium import webdriver\nfrom selenium.webdriver.common.keys import Keys\n\ndriver = webdriver.Firefox()\ndriver.get(\"http://www.baidu.com\")\n\n# Record the search window\nsearch_windows = driver.current_window_handle\n\n# Deal with Baidu search\nelem = driver.find_element_by_id(\"kw\")\nelem.clear()\nelem.send_keys(\"pycon\")\nelem.send_keys(\"python selenium programmer\")\nsearch = driver.find_element_by_id(\"su\")\nsearch.click()\n\n# Open a registration page\nlogin = driver.find_element_by_name('tj_login')\nlogin.click()\ndriver.find_element_by_link_text(u'立即注册').click()\n\n# Get all window handles\nall_handles = driver.window_handles\n\n# If handle is not search, input some thing in registration page\nfor handle in all_handles:\n    if handle != search_windows:\n       driver.switch_to.window(handle)\n       print('now register window!')\n       driver.find_element_by_name(\"userName\").send_keys('username')\n       driver.find_element_by_name('phone').send_keys('password')\n       time.sleep(2)\n\n# If handle is search, switch to the search windows and do some search again\nfor handle in all_handles:\n    if handle == search_windows:\n       driver.switch_to.window(search_windows)\n       print('now sreach window!')\n       driver.find_element_by_id('TANGRAM__PSP_2__closeBtn').click()\n       driver.find_element_by_id(\"kw\").send_keys(\"selenium\")\n       driver.find_element_by_id(\"su\").click()\n       time.sleep(2)\n\ndriver.close()\nReferer\n\nSelenium-Python安装文档\nSelenium-Python WebDriver API文档\n\n注：本文属原创，码字辛苦，未经同意，请勿转载，最后感谢阅读！——小杰控\n\n                ", "mainLikeNum": ["3 "], "mainBookmarkNum": "17"}