{"title": "实战：从Python分析17-18赛季NBA胜率超70%球队数据开始… - 互联网业务风险控制 ", "index": "数据分析,python", "content": "Casey    岂安业务风险分析师主要负责岂安科技RED.Q的数据分析和运营工作。\n\n12月19日，科比再次站在斯台普斯中心球馆中央，见证自己的两件球衣高悬于球馆上空。作为一个正奋战在 Python 之路上的球迷，开始了一次数据分析实战，于是，以分析球赛数据为起点的操作开始了......\n前言\npython 作为一个功能强大的编程语言，如今在数据分析、机器学习、人工智能等方面如日中天。如果想做数据分析，那么 python 则为一把利器。初入职场，除了使用 python 中列表、元组、字典等常用数据类型外，经常会接触到一些如 csv 文件、json 格式的数据、或者直接要和数据库打交道。本文，通过几个小例子简述 python 对 csv、json、mysql 的简单操作。\n数据分析实战\n1已知 nba-season_17_18.csv 文件（见下图）存放截至目前17-18赛季 NBA 常规赛联盟全部球队的数据。现在需要将胜率超过 70% 并且场均得分在 110 分的球队信息写入到 result.csv 中。\n\n上述对 csv 文件的操作可通过 python 中的 csv 模块轻松实现，csv 模块分别通过 reader() 和 writer() 实现对 csv 文件的读写，这两种方法都需要传入文件对象。因此，首先需要使用 open 方法打开 nba-season_17_18.csv，并创建文件对象。\n注意：需要先将文件第一行要写入 result.csv，其余行要依次通过if语句判断胜率和场均得分再选择是否写入。判断时要注意 reader 中的 row[3] 和 row[10] 是字符串类型，需要转换成 float 类型。\n实现的代码如下：\n\n最终result.csv如下：\n\n2json 作为一种轻量级的文本数据交换格式，因为在网络传输过程中具有节省流量、加快速度等优点，使其成为理想的数据交换语言。python 对 json 的操作主要通过 json 模块中的 dumps() 函数和 loads() 函数。前者将 python 对象编码 json 字符串，而后者则是将已经编码的 json 字符串解码为 python 对象。\n\n代码中 dumps() 函数将列表data编码为 json，其中参数 separators 默认是\", \"或\": \"（逗号和冒号后边分别有一个空格）。第三行代码表示去掉逗号和冒号后边的空格，参数 indent 设置 json 检验后的缩进位数。代码中 loads() 函数将第三行输出的 json 解码为原来的列表格式。\n如果上述 json 字符串和 python 对象存储在文件中，也不用担心，json 模块中的 dump() 和 load() 正是为此而生的。见第8行代码。输出结果如下：\n\n3方便高效的操作数据库可以节省分析师大量的时间，python 中 pymysql 模块正好满足。该模块操作数据库的过程可分为以下几步：\n\n其中，创建 connection 对象需要传入以下参数：host（MySQL服务器地址）、port（mysql服务器端口号，默认3306）、user（用户名）、passwd（密码）、db（数据库名）等。使用 cursor.execute() 执行的 sql 语句，可以是 select 查询语句，也可以是 insert、update、delete 等操作语句。cursor 获取数据的方法有:☞fecthone() 获取结果集中的下一条数据☞fecthmany(n) 获取结果集中的下 n 条数据☞fetchall() 获取结果集中的剩下所有数据\n下图是获取并打印本地数据库中数据的一个例子：\n\n值得注意的是, connection 对象除了 cursor() 方法外，还为支持事务提供两个重要的方法：commit() 和 rollback()这两个方法分别是提交所有操作，和回滚当前游标的所有操作。例如，在上例中，Tom借了Lucy10元钱，那么此时需要先将Lucy的压岁钱减掉10，然后将Tom的压岁钱增加10。此时使用事务来保证数据库的完整性，即要么两步都执行，要么都不执行。\n\n结果如下：\n\n结语\n本文用 python 对 csv、json、mysql 进行了简单操作。当然要做好数据分析，这些还远远不够。python 知识体系庞大，有大量高效且优秀的库，不得不提的是：\n\n科学计算领域的 NumPy 和 SciPy\n数据分析领域的 Pandas\n机器学习领域的 scikit-learn。\n\n总之，python 的知识点众多，学好不是一朝一夕的事情。但是，初入职场的小白觉得，学习其中任何一个知识点，除了看书、听课、参加讲座等方式外，更重要的是实际操作能力和思考总结能力。\n当然我也一直在学习中。文中有不当之处，敬请批评指正。如果您有关于数据分析的想法，特别欢迎一起交流、共同进步。谢谢。\n\n                ", "mainLikeNum": ["1 "], "mainBookmarkNum": "2"}