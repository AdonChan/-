{"title": "Python实用技法第14篇：根据字段将记录分组：itertools.groupby() - python3 ：公司内部培训专栏 ", "index": "python", "content": "上一篇文章：Python实用技法第13篇：对自定义类对象排序：attrgetter下一篇文章：Python实用技法第15篇：筛选序列中的元素\n\n1、需求🙀\n有一系列的字典或对象实例，我们想根据某个特定的字段来分组迭代数据。\n2、解决方案😸\nitertools.groupby()函数在对数据进行分组时特别有用。\n实例：\nfrom operator import itemgetter\nfrom itertools import groupby\n\nrows=[\n    {'name':'mark','age':18,'uid':'110'},\n    {'name':'miaomiao','age':28,'uid':'160'},\n    {'name':'miaomiao2','age':28,'uid':'150'},\n    {'name':'xiaohei','age':38,'uid':'130'},\n]\n\n#首先根据age排序\nrows.sort(key=itemgetter('age'))\n\nfor age,items in groupby(rows,key=itemgetter('age')):\n    print(age)\n    for i in items:\n        print(i)\n\n\n结果：\n18\n{'name': 'mark', 'age': 18, 'uid': '110'}\n28\n{'name': 'miaomiao', 'age': 28, 'uid': '160'}\n{'name': 'miaomiao2', 'age': 28, 'uid': '150'}\n38\n{'name': 'xiaohei', 'age': 38, 'uid': '130'}\n3、分析\nPython实用技法第5篇：一键多值字典：defaultdict\n函数groupby()通过扫描序列找出拥有相同值（或是由参数key指定的函数所返回的值）的序列项，并将它们分组。groupby()创建了一个迭代器，而在每次迭代时都会返回一个值（value）和一个子迭代器（sub_iterator），这个迭代器可以产生所有在该分组内具有该值得项。\n在这里重要的是首先要根据age对数据进行排序。因为groupby()不会排序。\n如果只是简单的根据日期将数据分组到一起，放进一个大的数据结构中以允许进行随机访问，那么利用defaultdict()构建一个一键多值字典可能会更好：\nfrom collections import defaultdict\n\nrows=[\n    {'name':'mark','age':18,'uid':'110'},\n    {'name':'miaomiao','age':28,'uid':'160'},\n    {'name':'miaomiao2','age':28,'uid':'150'},\n    {'name':'xiaohei','age':38,'uid':'130'},\n]\n\nrows_by_age=defaultdict(list)\nfor row in rows:\n    rows_by_age[row['age']].append(row)\nfor a in rows_by_age[28]:\n    print(a)\n\n结果：\n{'name': 'miaomiao', 'age': 28, 'uid': '160'}\n{'name': 'miaomiao2', 'age': 28, 'uid': '150'}\n不考虑排序的话，defaultdict方法一般比groupby快。\n\n                ", "mainLikeNum": ["1 "], "mainBookmarkNum": "0"}