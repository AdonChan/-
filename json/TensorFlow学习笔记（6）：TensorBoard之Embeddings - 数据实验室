{"title": "TensorFlow学习笔记（6）：TensorBoard之Embeddings - 数据实验室 ", "index": "tensorflow,python", "content": "前言\n本文基于TensorFlow官网的How-Tos写成。\nTensorBoard是TensorFlow自带的一个可视化工具，Embeddings是其中的一个功能，用于在二维或三维空间对高维数据进行探索。\nAn embedding is a map from input data to points in Euclidean space.\n本文使用MNIST数据讲解Embeddings的使用方法。\n代码\n# -*- coding: utf-8 -*-\n# @author: 陈水平\n# @date: 2017-02-08\n# @description: hello world program to set up embedding projector in TensorBoard based on MNIST\n# @ref: http://yann.lecun.com/exdb/mnist/, https://www.tensorflow.org/images/mnist_10k_sprite.png\n# \n\nimport numpy as np\nimport tensorflow as tf\nfrom tensorflow.contrib.tensorboard.plugins import projector\nfrom tensorflow.examples.tutorials.mnist import input_data\nimport os\n\nPATH_TO_MNIST_DATA = \"MNIST_data\"\nLOG_DIR = \"log\"\nIMAGE_NUM = 10000\n\n# Read in MNIST data by utility functions provided by TensorFlow\nmnist = input_data.read_data_sets(PATH_TO_MNIST_DATA, one_hot=False)\n\n# Extract target MNIST image data\nplot_array = mnist.test.images[:IMAGE_NUM]  # shape: (n_observations, n_features)\n\n# Generate meta data\nnp.savetxt(os.path.join(LOG_DIR, 'metadata.tsv'), mnist.test.labels[:IMAGE_NUM], fmt='%d')\n\n# Download sprite image\n# https://www.tensorflow.org/images/mnist_10k_sprite.png, 100x100 thumbnails\nPATH_TO_SPRITE_IMAGE = os.path.join(LOG_DIR, 'mnist_10k_sprite.png')  \n\n# To visualise your embeddings, there are 3 things you need to do:\n# 1) Setup a 2D tensor variable(s) that holds your embedding(s)\nsession = tf.InteractiveSession()\nembedding_var = tf.Variable(plot_array, name='embedding')\ntf.global_variables_initializer().run()\n\n# 2) Periodically save your embeddings in a LOG_DIR\n# Here we just save the Tensor once, so we set global_step to a fixed number\nsaver = tf.train.Saver()\nsaver.save(session, os.path.join(LOG_DIR, \"model.ckpt\"), global_step=0)\n\n# 3) Associate metadata and sprite image with your embedding\n# Use the same LOG_DIR where you stored your checkpoint.\nsummary_writer = tf.summary.FileWriter(LOG_DIR)\n\nconfig = projector.ProjectorConfig()\n# You can add multiple embeddings. Here we add only one.\nembedding = config.embeddings.add()\nembedding.tensor_name = embedding_var.name\n# Link this tensor to its metadata file (e.g. labels).\nembedding.metadata_path = os.path.join(LOG_DIR, 'metadata.tsv')\n# Link this tensor to its sprite image.\nembedding.sprite.image_path = PATH_TO_SPRITE_IMAGE \nembedding.sprite.single_image_dim.extend([28, 28])\n# Saves a configuration file that TensorBoard will read during startup.\nprojector.visualize_embeddings(summary_writer, config)\n首先，从这里下载图片，放到log目录下；然后执行上述代码；最后，执行下面的命令启动TensorBoard。\ntensorboard --logdir=log\n执行后，命令行会显示如下提示信息：\nStarting TensorBoard 39 on port 6006\n(You can navigate to http://xx.xxx.xx.xxx:6006)\n打开浏览器，输入上面的链接地址，点击导航栏的EMBEDDINGS即可看到效果：\n\n资源\n这篇文章对MNIST的可视化做了深入的研究，非常值得细读。\n\n                ", "mainLikeNum": ["2 "], "mainBookmarkNum": "3"}