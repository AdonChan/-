{"title": "Python Execl模块 - 个人文章 ", "index": "python", "content": "Python Execl模块\nPython 使用 xlrd 和 xlwt 两个模块来操作 Execl表格，分别用来读和写\n\nxlrd 读取表格\n# 打开execl文件\nworkbook = xlrd.open_workbook(r'E:\\deploy_log.xlsx')\n# 输出所有sheet，输出为列表\nprint workbook.sheet_names()    \n# 获取 工作表(sheet)名称\nsheet1_name = workbook.sheet_names()[0]\n# 通过索引获取sheet\nsheet1 = workbook.sheet_by_index(0)\n# 通过名称获取sheet\nsheet1 = workbook.sheet_by_name('first_sheet')\nprint \"sheet表名：%s, 行数：%d, 列数：%d\" % (sheet1_name, sheet1.nrows, sheet1.ncols)\n\n# 获取指定行或指定列的内容\nrows = sheet1.row_values(3)\ncols = sheet1.col_values(4)\nprint '第3行', rows\nprint '第4列', cols\n\n# 获取单元格内容\nprint '单元格内容', sheet1.cell(3,0).value\nprint '单元格内容', sheet1.cell_value(3,0)\nprint '单元格内容', sheet1.row(3)[4].value\n\n# 获取单元格内容的数据类型\n# ctype : 0 empty,1 string, 2 number, 3 date, 4 boolean, 5 error\nprint sheet1.cell(3, 0).ctype\nprint sheet1.cell(3, 4).ctype\n\n# 之前时间输出为42851.6937037，下边进行时间转换\nprint \"获取时间: \", xlrd.xldate_as_tuple(sheet1.cell_value(3,4), workbook.datemode) \n\n# 获取合并的单元格\nworkbook_format = xlrd.open_workbook(r'E:\\deploy_log.xlsx', formatting_info=True)\nsheet1_format = workbook_format.sheet_by_index(0)\nprint sheet1.merged_cells\n\nxlwt 写表格\n官方参照：https://pypi.python.org/pypi/...http://xlwt.readthedocs.io/en...\n# 创建表格对象\nf = xlwt.Workbook()\nsheet_new = f.add_sheet(u'first_sheet', cell_overwrite_ok=True)\n\n# 设置表格style\nstyle = xlwt.XFStyle()\nfont = xlwt.Font()\nfont.name = 'Times New Roman'\nfont.bold = bold\nfont.color_index = 4\nfont.height = 220\nstyle.font = True\n\n# 写数据\nsheet_new.write(0, 0, 'host', style)\nsheet_new.write(0, 1, 'warname', style)\nsheet_new.write(0, 2, 'runtime', style)\n\n                ", "mainLikeNum": ["0 "], "mainBookmarkNum": "3"}