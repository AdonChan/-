{"title": "使用python找回在SecureCRT中的Linux登入密码 - 个人文章 ", "index": "python,securecrt,linux", "content": "在笔记本上的虚拟机中装了一个Linux系统，有一段时间没用，突然要用到时发现，密码已经不记得了。还好之前有用过secureCRT软件连接过Linux，那么就能轻松地使用python找回密码啦。\n最终效果\n红框所指的位置就是密码了\n准备\n下载安装python，并配置系统全局变量。这里我用的是python 2.7\npython依赖包\n下载python解密依赖包：https://pypi.python.org/pypi/...解压文件，用命令行工具进入解压后的目录，执行下面命令\npython setup.py build\npython setup.py install\n执行如果出现下图这种情况的还有另一种方法可以安装到这里下载对应自己环境的版本 http://www.voidspace.org.uk/p...\n我下载的版本是PyCrypto 2.6 for Python 2.7 32bit\n\n下载好了直接运行安装\n开始找回\n找到SecureCRT存储密码的位置\n用户名\\AppData\\Roaming\\VanDyke\\ConfigSessions\\\n或者软件目录下\\Data\\Settings\\Config\\Sessions\\\n目录中能看你的回话配置文件，我的是10.0.0.100.ini\n\n复制下面代码，保存文件到上面的这个目录，起名secureDecode.py\nfrom Crypto.Cipher import Blowfish\nimport argparse\nimport re\n\ndef decrypt(password) :\n    c1 = Blowfish.new('5F B0 45 A2 94 17 D9 16 C6 C6 A2 FF 06 41 82 B7'.replace(' ','').decode('hex'), Blowfish.MODE_CBC, '\\x00'*8)\n    c2 = Blowfish.new('24 A6 3D DE 5B D3 B3 82 9C 7E 06 F4 08 16 AA 07'.replace(' ','').decode('hex'), Blowfish.MODE_CBC, '\\x00'*8)\n    padded = c1.decrypt(c2.decrypt(password.decode('hex'))[4:-4])\n    p = ''\n    while padded[:2] != '\\x00\\x00' :\n        p += padded[:2]\n        padded = padded[2:]\n    return p.decode('UTF-16')\n\nREGEX_HOSTNAME = re.compile(ur'S:\"Hostname\"=([^\\r\\n]*)')\nREGEX_PASWORD = re.compile(ur'S:\"Password\"=u([0-9a-f]+)')\nREGEX_PORT = re.compile(ur'D:\"\\[SSH2\\] Port\"=([0-9a-f]{8})')\nREGEX_USERNAME = re.compile(ur'S:\"Username\"=([^\\r\\n]*)')\n\ndef hostname(x) :\n    m = REGEX_HOSTNAME.search(x)\n    if m :\n        return m.group(1)\n    return '???'\n\ndef password(x) :\n    m = REGEX_PASWORD.search(x)\n    if m :\n        return decrypt(m.group(1))\n    return '???'\n\ndef port(x) :\n    m = REGEX_PORT.search(x)\n    if m :\n        return '-p %d '%(int(m.group(1), 16))\n    return ''\n\ndef username(x) :\n    m = REGEX_USERNAME.search(x)\n    if m :\n        return m.group(1) + '@'\n    return ''\n\nparser = argparse.ArgumentParser(description='Tool to decrypt SSHv2 passwords in VanDyke Secure CRT session files')\nparser.add_argument('files', type=argparse.FileType('r'), nargs='+',\n    help='session file(s)')\n\nargs = parser.parse_args()\n\nfor f in args.files :\n    c = f.read().replace('\\x00', '')\n    print f.name\n    print \"ssh %s%s%s # %s\"%(port(c), username(c), hostname(c), password(c))\n接着用命令行工具进入该目录，运行下面命令\npython secureDecode.py 10.0.0.100.ini\n最后成功找回密码\n参考文章找回SecureCRT密码pycrypto模块安装失败如何解决\n\n如果这对你有帮助，或者能帮你节省一些时间，不如，点个赞吧~\n原文地址\n\n                ", "mainLikeNum": ["0 "], "mainBookmarkNum": "0"}