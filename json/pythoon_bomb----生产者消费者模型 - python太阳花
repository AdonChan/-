{"title": "pythoon_bomb----生产者消费者模型 - python太阳花 ", "index": "python", "content": "生产者消费者模型具体来讲，就是在一个系统中，存在生产者和消费者两种角色，他们通过内存缓冲区进行通信，生产者生产消费者需要的资料，消费者把资料做成产品。\nimport time\nimport random\n\n#如果缓冲区长度为5，缓冲区就满了，生产者不能再生存包子了\n#如果不满5，生产者补足\ncachelist =[]\ncachelistlen=5\n\ndef isfull():\n    #缓冲区满了\n    return len(cachelist)==5\n\ndef consumer(name):\n    \"\"\"消费者\"\"\"\n    print(\"%s准备买包子\" %(name))\n    while True:\n        kind = yield\n        print(\"%s买%s包子成功\" %(name,kind))\n\ndef producer(chief):\n    print(\"%s大厨正在做包子\" %(chief))\n    kinds=['梅菜','豆沙','粉条']\n    while True :\n        if not isfull():\n        #模拟生产耗费的时间\n            time.sleep(random.random())\n            kind = random.choice(kinds)\n            print(\"%s已经做好%s包子了\" %(chief,kind))\n            cachelist.append(kind)\n        else:\n            yield\np=producer('杜')\nnext(p)\nconsumers = [consumer('宝宝'+str(i)) for i in range(10)]\nfor i in consumers:\n    if not cachelist:\n        producer(\"目前还没有包子\")\n    else:\n        if isfull():\n            print(\"已经有足够的包子啦\")\n        else:\n            next(p)\n        kind = cachelist.pop()\n        next(i) #执行消费者买包子\n        i.send(kind)\n        \n结果\n杜大厨正在做包子\n杜已经做好豆沙包子了\n杜已经做好豆沙包子了\n杜已经做好粉条包子了\n杜已经做好豆沙包子了\n杜已经做好粉条包子了\n已经有足够的包子啦\n宝宝0准备买包子\n宝宝0买粉条包子成功\n杜已经做好梅菜包子了\n宝宝1准备买包子\n宝宝1买梅菜包子成功\n杜已经做好粉条包子了\n宝宝2准备买包子\n宝宝2买粉条包子成功\n杜已经做好梅菜包子了\n宝宝3准备买包子\n宝宝3买梅菜包子成功\n杜已经做好梅菜包子了\n宝宝4准备买包子\n宝宝4买梅菜包子成功\n杜已经做好粉条包子了\n宝宝5准备买包子\n宝宝5买粉条包子成功\n杜已经做好粉条包子了\n宝宝6准备买包子\n宝宝6买粉条包子成功\n杜已经做好粉条包子了\n宝宝7准备买包子\n宝宝7买粉条包子成功\n杜已经做好粉条包子了\n宝宝8准备买包子\n宝宝8买粉条包子成功\n杜已经做好梅菜包子了\n宝宝9准备买包子\n宝宝9买梅菜包子成功\n\n\n                ", "mainLikeNum": ["0 "], "mainBookmarkNum": "0"}