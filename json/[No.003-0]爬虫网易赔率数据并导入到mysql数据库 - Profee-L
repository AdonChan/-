{"title": "[No.003-0]爬虫网易赔率数据并导入到mysql数据库 - Profee-L ", "index": "beautifulsoup,mysql,python", "content": "    首先，我拥有这个导入赔率的需求，并且，我需要的是所有的数据赔率，我需要把某些脏赔率(极有可能不会出现的赔率，误导彩迷的赔率)删除，并且我需要知道这些赔率的比分，删除这些赔率，可以逆推正确比分以及赔率的区间。\n    所以我不得不做的就是把每天的赔率数据导入到我自己的数据库，根据一定的运算法则，将可能性筛选出来，然后我再做进一步的判断。\n\n\n#encoding:utf-8\nimport urllib2\nfrom bs4 import BeautifulSoup\n\nwebsite = \"http://caipiao.163.com/order/jczq-hunhe/#from=leftnav\"\npage = urllib2.urlopen(website)\nsoup = BeautifulSoup(page)\nfor incident in soup('td'):\n    print incident\n得到类似于以下的结果集：\n<td gametype=\"bf\" index=\"30\" sp=\"120.00\">负其他\n\n<div>120.00</div>\n\n</td>\n<td gametype=\"zjq\" index=\"0\" sp=\"14.00\">0\n\n<div>14.00</div>\n\n</td>\n<td gametype=\"zjq\" index=\"1\" sp=\"5.20\">1\n\n<div>5.20</div>\n\n</td>\n<td gametype=\"zjq\" index=\"2\" sp=\"3.55\">2\n\n<div>3.55</div>\n\n</td>\n<td gametype=\"zjq\" index=\"3\" sp=\"3.50\">3\n\n<div>3.50</div>\n\n</td>\n<td gametype=\"zjq\" index=\"4\" sp=\"4.70\">4\n\n<div>4.70</div>\n\n</td>\n<td gametype=\"zjq\" index=\"5\" sp=\"7.50\">5\n\n<div>7.50</div>\n\n</td>\n<td gametype=\"zjq\" index=\"6\" sp=\"13.00\">6\n\n<div>13.00</div>\n\n</td>\n<td gametype=\"zjq\" index=\"7\" sp=\"18.00\">7+\n\n<div>18.00</div>\n\n</td>\n……\n\n\n这里得到的结果，仅仅是赔率的结果，而且需要吧gametype的内容筛选出来，得到紧缺的，总进球 7球 18赔率的结果；\n\n接下来\n\n提取td中的内容，使用re正则来提取；\n直接在for循环中使用re，避免使用文件作为缓存\n\n#查询半全场的赔率\nfor item in soup.findAll(\"td\",{\"gametype\":\"bqc\"}):\n    print item.find(\"div\").string\n\n\n#查询表中的标签，并将内容筛选出来\n#半全场赔率，依次为\"胜胜\",\"胜平\",\"胜负\",\"平胜\",\"平平\",\"平负\",\"负胜\",\"负平\",\"负负\"\nfor item in soup.findAll(\"td\",{\"gametype\":\"bqc\"}):\n     print item.find(\"div\").string\n\n#再查询比分赔率\n#先是胜赔，1:0~胜其他，之后是平赔，0:0~3:3，平其他，并将其导入比分赔率bfpl\ntemp = [\"1:0\",\"2:0\",\"2:1\",\"3:0\",\"3:1\",\"3:2\",\"4：0\",\"4:1\",\"4:2\",\"5:0\",\"5:1\",\"5:2\",\"胜其他\",\"0:0\",\"1:1\",\"2:2\",\"3:3\",\"平其他\",\"0:1\",\"0:2\",\"1:2\",\"0：3\",\"1:3\",\"2:3\",\"0:4\",\"1:4\",\"2:4\",\"0:5\",\"1:5\",\"2:5\",\"负其他\"]\ni = 1\nbfpl = []\nfor item in soup.findAll(\"td\",{\"gametype\":\"bf\"}):\n    bfpl.append(item.find(\"div\").string)\n\n#---------------------\n#构建比分赔率字典\ni = 1\ntemp = [\"1:0\",\"2:0\",\"2:1\",\"3:0\",\"3:1\",\"3:2\",\"4：0\",\"4:1\",\"4:2\",\"5:0\",\"5:1\",\"5:2\",\"胜其他\",\"0:0\",\"1:1\",\"2:2\",\"3:3\",\"平其他\",\"0:1\",\"0:2\",\"1:2\",\"0：3\",\"1:3\",\"2:3\",\"0:4\",\"1:4\",\"2:4\",\"0:5\",\"1:5\",\"2:5\",\"负其他\"]\nlen\n\n\n\n#再查询总进球赔率\nfor item in soup.findAll(\"td\",{\"gametype\":\"zjq\"}):\n     print item.find(\"div\").string\n\n#----------------------------------------\n#查询所有的主队、客队名字数据以及场次数据\n#主队hostTeam\ni = 1\nhostTeam = []\nfor item in soup.findAll(\"em\",{\"class\":\"hostTeam\"}):\n    hostTeam.append(item.b.string)\n    i+=1\n\nfor item in hostTeam:\n    print hostTeam[item]\n\n#客队guestTeam\ni = 1\nguestTeam = []\nfor item in soup.findAll(\"em\",{\"class\":\"guestTeam\"}):\n    guestTeam.append(item.b.string)\n    i+=1\n\nfor item in guestTeam:\n    print guestTeam[item]\n\n#------------------\n#场次以及主队客队数据\n#------------------\ni = 1\nfor item in hostTeam:\n    print '---------'\n    print screening[i],hostTeam[i],guestTeam[i]\n    i+=1\n\n#-----------------------\n#场次信息 jtip\ni = 1\nscreening = []\nfor item in soup.findAll(\"span\",{\"class\":\"co1\"}):\n    screening.append(item.i.string)\n    i+=1\n\n#遍历场次数据\ni=1\nfor item in screening:\n    print screening[i]\n    i+=1\n\n#------------------\n#做出场次+比分的list-->scbf[]\nfor item in screening:\n    i=0\n    while i<len(temp):\n        scbf[i]=screening[i]+temp[i]\n        i+=1\n\n\n#=====================\n\n\n\n                ", "mainLikeNum": ["0 "], "mainBookmarkNum": "0"}