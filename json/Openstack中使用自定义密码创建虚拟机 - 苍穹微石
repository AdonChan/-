{"title": "Openstack中使用自定义密码创建虚拟机 - 苍穹微石 ", "index": "python,openstack", "content": "假设有个开头\n\nnova.api.openstack.compute.servers.py中的create()函数写道虚拟机的adminPass来自一个名为password的变量。而这个变量是通过_get_server_admin_password函数产生的。\n\n假设有个过程\n\n看一下create函数：\n\npassword = self._get_server_admin_password(server_dict)\n\n\n再看一下_get_server_admin_password函数：\n\n    def _get_server_admin_password(self, server):\n        \"\"\"Determine the admin password for a server on creation.\"\"\"\n        try:\n            password = server['adminPass']\n            self._validate_admin_password(password)\n        except KeyError:\n            password = utils.generate_password()\n        except ValueError:\n            raise exc.HTTPBadRequest(explanation=_(\"Invalid adminPass\"))\n\n        return password\n\n\n由此可见，_get_server_admin_password函数已经具备判断并选择自定义密码的能力，于是只要传入一个adminPass到server_dict里即可。\n\n于是对create函数进行修改，修改后的样子：\n\n        meta_dict = body['server'].get('metadata', None)\n        if meta_dict:\n            if meta_dict.get('password', None):\n                server_dict['adminPass'] = meta_dict['password']\n\n            del server_dict['metadata']\n        password = self._get_server_admin_password(server_dict)\n\n\n调用方法\n\nnova boot ******* --meta password=mypass *****\n\n\n\n另一个地址：http://pages.turtleend.info/2015/03/17/openstack-use-custom-password-f...\n\n                ", "mainLikeNum": ["0 "], "mainBookmarkNum": "0"}