{"title": "分类模型——决策树 - 个人文章 ", "index": "数据分析,python", "content": "Split train and test\nfrom sklearn.cross_validation import train_test_split\nx_train, x_test, y_train, y_test = train_test_split(customer.ix[:,0:customer.columns.size-1], customer.ix[:,customer.columns.size-1], test_size = 0.2)\nx_train, x_test, y_train, y_test = train_test_split(order.ix[:,0:order.columns.size-1], order.ix[:,order.columns.size-1], test_size = 0.2)\n\nDecision tree\n使用信息熵作为划分标准，对决策树进行训练\nfrom sklearn import tree  \nclf = tree.DecisionTreeClassifier(criterion='entropy')\nprint(clf)  \nclf.fit(x_train, y_train)\n\nPredict\nanswer = pd.Series(clf.predict(x_test))\nresult = pd.DataFrame(np.c_[y_test, answer])\nresult['correct'] = np.where(result[0] == result[1], 1, 0) \nsum(result['correct'])/pd.count(result['correct'])\nresult.sum()/result.count()\n\npreds = clf.predict(x_test)\nresult = pd.crosstab(y_test, preds, rownames=['actual'], colnames=['preds'])\nres = result.div(result.sum(1).astype(float), axis=0)\nres\nres2 = res.drop(max(res) < 0.5, axis=1)\nres.to_csv('result.csv', index = True, header = True)\n\n\n\n\n\n                ", "mainLikeNum": ["0 "], "mainBookmarkNum": "0"}