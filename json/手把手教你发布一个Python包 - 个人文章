{"title": "手把手教你发布一个Python包 - 个人文章 ", "index": "python", "content": "本文主题如下：\n编写一个包（Python 源代码），但不是本文的重点。\n编译包，观察编译后的文件。\n发布包，发布的包可以有多种类型。\n如何在 Pypi 中查看已发布的包\n注意：\n本文编写的包在 Python2 环境下测试通过，实际上这个包（只是个例子）比较简单，在 Python3 下也能运行。\n本文知识点可能陈旧，比如 Python Pypi 官方已做了很大改变。\n1. 编写包源代码\n这篇文章主要描述如何发布一个包，不描述如何编写一个包，如果你没有代码（只想学习如何发布包），可下载下面的示例。\n$ wget \"https://files.pythonhosted.org/packages/96/66/43e6df87373557553be2b4343db27d008c6dcefa110ccff38cba1459ca07/ywdblogmath-0.1.tar.gz\"\n2. 查看 setup.py\n为了生成和发布包，必须编写 setup.py 文件，编写该文件必须依赖于 setuptools 包，这个包本身也是一个 Python 包。.\n#!/usr/bin/env python\nfrom setuptools import setup\nsetup(name='ywdblogmath',\n    version='0.1',\n    description='A silly ywdblogmath package',\n    author='ywdblog',\n    author_email='ywdblog@gmail.com',\n    url='http://www.yudadan.com/',\n    packages=['ywdblogmath', 'ywdblogmath.adv'],\n)\n\n望文生义，不过多讲解相应的参数。\n3. 测试本地包\n首先将该代码生成一个本地包，然后编写代码测试该包的功能。\n在开发模式下安装包：\n$ python setup.py develop\n观察安装后生成的文件：\n/usr/local/lib/python2.7/dist-packages/ywdblogmath.egg-link\n\n/usr/local/lib/python2.7/dist-packages/easy-install.pth\n\n这二个文件包含的内容就是 /root/python（一个软连接）。\n编写测试文件 example.py ：\nimport sys\nimport ywdblogmath\nprint(ywdblogmath.add(4,5))\nprint(ywdblogmath.division(4, 2))\nprint(ywdblogmath.multiply(10, 5))\nprint(ywdblogmath.squareroot(48))\n然后运行 example.py：\n$ python  example.py\n    9\n    2\n    50\n    6.92820323028.\n4. 配置 pypi\n（1）为了发布包，必须在 pypi.org 注册一个用户，注册邮箱需要验证。（2）配置 $HOME”.pypirc” 文件:\n[distutils]\nindex-servers=pypi\n[pypi]\nrepository = https://upload.pypi.org/legacy/\nusername = pypi.org 登录名\npassword = pypi.org 登陆密码\n5. 发布包\n在发布包之前，运行下列命令了解所有可用的命令：\n$ python setup.py --help-commands\n先编译包：\n$ python setup.py build\n运行完成后生成 /root/python/build 目录，所以编译的文件保存在该目录下。\n（1）生成 tar.gz 包\n$ python setup.py sdist\n运行后产生下列文件：\n/root/python/dist/ywdblogmath-0.1.tar.gz/root/python/ywdblogmath.egg-info （python setup.py egg_info 命令也会生成该文件）\n（2）生成 egg 包\n$ python setup.py bdist_egg\n运行后产生下列文件：\n/root/python/dist/ywdblogmath-0.1-py2.7.egg/root/python/ywdblogmath.egg-info （python setup.py egg_info 命令也会生成该文件）\n（3）生成 wheel 包\n$ python setup.py bdist_wheel\n运行后产生下列文件：\n/root/python/dist/ywdblogmath-0.1-py2-none-any.whl/root/python/ywdblogmath.dist-info\n最后发布包（任何一个命令都可以）：\n# 发布 .tar.gz 包\n$ python setup.py sdist upload \n# 发布 egg 包\n$ python setup.py bdist_egg upload \n# 发布 wheel 包\n$ python setup.py bdist_wheel upload\n至于发布什么类型的包，读者自己决定，如果想让所有的包安装工具（比如 pip、easy_install ）都能安装你发布的包，可同时发布这三种类型的包。\n登录 pypi.org 查看发布的包\n在发布包的时候，可能会遇到很多命令行提示的错误，这些内容不是本文的重点，另外注意 setpy.py 中的包版本号，可以测试发布多版本的包。\n\n\n                ", "mainLikeNum": ["0 "], "mainBookmarkNum": "0"}