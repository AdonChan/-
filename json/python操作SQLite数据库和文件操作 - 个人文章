{"title": "python操作SQLite数据库和文件操作 - 个人文章 ", "index": "python,sqlite", "content": "最近遇到一个需求，就是要把SQLite数据中没有存储的文件名的文件删除掉，想来想去还是决定用python。所以也就花了一天半的时间学习了下，随手写了个小例子。直接上代码\n要用到的头文件包\n#coding=utf-8\n#!/usr/bin/python\n#!/usr/bin/env python\nimport os\nimport shutil\nimport sqlite3\n定义记录变量\n#记录所文件数\nsumCount=0;\n#记录留存文件数\ncount=0;\n#记录删除文件数\ndelCount=0;\n#定义存储遍历所有文件数组\ndelList = []\n#文件存储路径\ndelDir = \"/Users/liudengtan/Desktop/testFile/\"\n#获取路径下所有文件\ndelList = os.listdir(delDir)\n#打开连接数据库\nconn = sqlite3.connect('images.db')\nprint \"开始处理...\";\n把文件目录下的所有文件与数据库的存的对比，如果文件在数据中，就存留，否则删除文件\n#遍历\nfor f in delList:\n    #获取到文件路径\n    filePath = os.path.join(delDir, f)\n    if os.path.isfile(filePath):\n        sumCount=sumCount+1\n       #将文件全路径中存储路径替换，只留文件名\n        fileName=filePath.replace(delDir,'')\n        #数据库查看当前文件名是否存在\n        cursor = conn.execute(\"SELECT  image FROM '表名'  where image=(?)\",(fileName))\n        res = cursor.fetchall()\n        #条件判断>0文件存在\n        if len(res) > 0:\n            count = count + 1;\n        else:#文件不存在将其删除\n            if os.path.isfile(delDir + fileName):\n                #删除文件操作\n                os.remove(delDir + fileName)\n                print delDir + fileName + \" 删除!\"\n            delCount = delCount + 1;\n\n#关闭数据库\nconn.close()\nprint \"处里结束：\";\nprint \"所有文件总数 ： \",sumCount;\nprint \"删除文件数 ： \",delCount;\n\n                ", "mainLikeNum": ["0 "], "mainBookmarkNum": "2"}