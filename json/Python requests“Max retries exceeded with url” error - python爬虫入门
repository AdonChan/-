{"title": " Python requests“Max retries exceeded with url” error - python爬虫入门 ", "index": "python", "content": "19-4-29补充：\nerror1:\nNewConnectionError('<urllib3.connection.VerifiedHTTPSConnection object at 0x00000000038F2B00>: Failed to establish a new connection: [WinError 10060] 由于连接方在一段时间后没有正确答复或连接的主机没有反应，连接尝试失败。',))\n解决办法：\nsession.keep_alive=False\nerror2:\npython hostname doesn't match either of  facebookXXXXX解决办法：\nimport sslssl.match_hostname = lambda cert, hostname: True多方查阅后发现了解决问题的原因：http连接太多没有关闭导致的。\n解决办法：\n\n增加重试连接次数requests.adapters.DEFAULT_RETRIES = 5\n\n关闭多余的连接\n\nrequests使用了urllib3库，默认的http connection是keep-alive的，requests设置False关闭。\n操作方法\ns = requests.session()\ns.keep_alive = False\n\n\n只用session进行操作。即只创建一个连接，并设置最大连接数或者重试次数。\nimport requests   from requests.adapters import HTTPAdapter   from requests.packages.urllib3.util.retry import Retry\nsession = requests.Session()   retry = Retry(connect=3, backoff_factor=0.5)   adapter = HTTPAdapter(max_retries=retry)   session.mount('http://', adapter)   session.mount('https://', adapter)\nsession.get(url)\n import requests\n   from requests.adapters import HTTPAdapter\n   from requests.packages.urllib3.util.retry import Retry\n   s = requests.Session()\n   retry = Retry(connect = 5, backoff_factor = 1)\n   adapter = HTTPAdapter(max_retries = retry)\n   s.mount('http://', adapter)\n   s.keep_alive = False\n   res = s.post(self.conn.host + '/sign-in', data = json.dumps({\n       'name': \"XXX\",\n       'pwd': \"XXX\"\n   }))\n   response = res.json()\n\n\n但是在starkoverflow上有人给出了这样的解释。\n安装 py\npip install -U pyopenssl5、设定固定的睡眠时间在发送请求之间https://github.com/requests/r...https://stackoverflow.com/que...\n\n                ", "mainLikeNum": ["0 "], "mainBookmarkNum": "0"}