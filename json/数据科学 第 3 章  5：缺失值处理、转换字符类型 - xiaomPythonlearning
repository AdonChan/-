{"title": "数据科学 第 3 章  5：缺失值处理、转换字符类型 - xiaomPythonlearning ", "index": "python,数据处理", "content": "第3章 5：缺失值这次是用激励数据，没有获得激励的人，业绩和金额方有缺失值，以下为几种处理方法：\n-- 发现缺失值：isnull/notnull -- 处理缺失值：dropna/fillna\n保存名称为：01 缺失值.py\nimport pymysql\nimport pandas as pd\nfrom sqlalchemy import  create_engine\n\nsql = \"select * from jili\"\nengine = create_engine('mysql+pymysql://root:123456@192.168.200.200/xiaom')\ndf = pd.read_sql(sql,engine,)\n<class 'pandas.core.frame.DataFrame'>RangeIndex: 42 entries, 0 to 41Data columns (total 10 columns):dep         42 non-null object    #总共有42行group       42 non-null object  name        42 non-null objectoldpro      26 non-null float64    #以下每列均有缺失值newpro      33 non-null float64oldrate     27 non-null float64newrate     27 non-null float64oldbones    24 non-null float64newbones    26 non-null float64allbones    27 non-null float64dtypes: float64(7), object(3)memory usage: 3.4+ KB\n- 发现缺失值：\ndf.isnull返回的是布尔值，False表示非空值df.notnull返回布尔值，False表示空值\n\n- 处理缺失值\n有删除（dropna）、填充（fillna）两种方法\n- 删除：dropna()\ndf.dropna() #删除包含na的整行。\ndf.dropna(how = 'all')  \n# how是方法：如果为any，则表示包含空值的行，如果为all则表示删除整行均为空值的行。\n\ndf.dropna(axis = 'columns') #会删除包含空值的列，返回的结果是前3列均不为空值的列。\ndf.dropna(axis = 'rows',thresh = 8)  #表示每行最少有8个非空值\n\n- 填充：fillna\ndf.fillna(0).head() #填充缺失值：用0 填充\ndf.fillna(df.mean()).round(2).head() # 用均值填充，保留2位小数\ndf.fillna(method='ffill').head()  #用前一个数填充\ndf.fillna(menthod = 'bfill').head()  #用后一个数据填充\n--下面是对错行数据的处理\n之前导入sogou数据的时候，有错行的，现在要删除错行的数据：'01 搜狗 错行数据.py'在转换rank和number列为int格式的时候报错，发现是有的关键词到rank列了，所以rank列有字符的内容，经过简单考虑，准备删除这些错行的。\n先找到错行的，就是筛选字符长度大于3位的\n- 强制转换为int\n然后强制转换为int，再删除没有转换成功，即为空值的行\n#没发现of，强制转换为数字.coerce是强制的意思，ignore是忽略\npd.to_numeric(sogou['rank'],errors='coerce')\npd.to_numeric(sogou['number'],errors='coerce')\n\n#也可以用下面的方法一行搞定：\nsogou[['rank','number']] = sogou[['rank','number']].apply(pd.to_numeric,errors='coerce')\n\n- 删除rank为空的行\n#删除这些错误值，如果用spark就不用处理这么久的数据了😭\nsogou.dropna(subset=['rank'],inplace=True)\nsogou.info()\n\n\n>>>Out：\n<class 'pandas.core.frame.DataFrame'>\nInt64Index: 823818 entries, 0 to 825118\nData columns (total 6 columns):\ndate      823818 non-null datetime64[ns]\nuserid    823818 non-null object\nwords     823818 non-null object\nrank      823818 non-null float64\nnumber    823818 non-null float64\nurl       823818 non-null object\ndtypes: datetime64[ns](1), float64(2), object(3)\nmemory usage: 44.0+ MB\n- 保存csv\n#保存为新的csv：\nsogou.to_csv('sogoudayclear.csv',index = False)\n\n                ", "mainLikeNum": ["0 "], "mainBookmarkNum": "0"}