{"title": "æ•°æ®ç§‘å­¦ ç¬¬ 3 ç«   5ï¼šç¼ºå¤±å€¼å¤„ç†ã€è½¬æ¢å­—ç¬¦ç±»å‹ - xiaomPythonlearning ", "index": "python,æ•°æ®å¤„ç†", "content": "ç¬¬3ç«  5ï¼šç¼ºå¤±å€¼è¿™æ¬¡æ˜¯ç”¨æ¿€åŠ±æ•°æ®ï¼Œæ²¡æœ‰è·å¾—æ¿€åŠ±çš„äººï¼Œä¸šç»©å’Œé‡‘é¢æ–¹æœ‰ç¼ºå¤±å€¼ï¼Œä»¥ä¸‹ä¸ºå‡ ç§å¤„ç†æ–¹æ³•ï¼š\n-- å‘ç°ç¼ºå¤±å€¼ï¼šisnull/notnull -- å¤„ç†ç¼ºå¤±å€¼ï¼šdropna/fillna\nä¿å­˜åç§°ä¸ºï¼š01 ç¼ºå¤±å€¼.py\nimport pymysql\nimport pandas as pd\nfrom sqlalchemy import  create_engine\n\nsql = \"select * from jili\"\nengine = create_engine('mysql+pymysql://root:123456@192.168.200.200/xiaom')\ndf = pd.read_sql(sql,engine,)\n<class 'pandas.core.frame.DataFrame'>RangeIndex: 42 entries, 0 to 41Data columns (total 10 columns):dep         42 non-null object    #æ€»å…±æœ‰42è¡Œgroup       42 non-null object  name        42 non-null objectoldpro      26 non-null float64    #ä»¥ä¸‹æ¯åˆ—å‡æœ‰ç¼ºå¤±å€¼newpro      33 non-null float64oldrate     27 non-null float64newrate     27 non-null float64oldbones    24 non-null float64newbones    26 non-null float64allbones    27 non-null float64dtypes: float64(7), object(3)memory usage: 3.4+ KB\n- å‘ç°ç¼ºå¤±å€¼ï¼š\ndf.isnullè¿”å›çš„æ˜¯å¸ƒå°”å€¼ï¼ŒFalseè¡¨ç¤ºéç©ºå€¼df.notnullè¿”å›å¸ƒå°”å€¼ï¼ŒFalseè¡¨ç¤ºç©ºå€¼\n\n- å¤„ç†ç¼ºå¤±å€¼\næœ‰åˆ é™¤ï¼ˆdropnaï¼‰ã€å¡«å……ï¼ˆfillnaï¼‰ä¸¤ç§æ–¹æ³•\n- åˆ é™¤ï¼šdropna()\ndf.dropna() #åˆ é™¤åŒ…å«naçš„æ•´è¡Œã€‚\ndf.dropna(how = 'all')  \n# howæ˜¯æ–¹æ³•ï¼šå¦‚æœä¸ºanyï¼Œåˆ™è¡¨ç¤ºåŒ…å«ç©ºå€¼çš„è¡Œï¼Œå¦‚æœä¸ºallåˆ™è¡¨ç¤ºåˆ é™¤æ•´è¡Œå‡ä¸ºç©ºå€¼çš„è¡Œã€‚\n\ndf.dropna(axis = 'columns') #ä¼šåˆ é™¤åŒ…å«ç©ºå€¼çš„åˆ—ï¼Œè¿”å›çš„ç»“æœæ˜¯å‰3åˆ—å‡ä¸ä¸ºç©ºå€¼çš„åˆ—ã€‚\ndf.dropna(axis = 'rows',thresh = 8)  #è¡¨ç¤ºæ¯è¡Œæœ€å°‘æœ‰8ä¸ªéç©ºå€¼\n\n- å¡«å……ï¼šfillna\ndf.fillna(0).head() #å¡«å……ç¼ºå¤±å€¼ï¼šç”¨0 å¡«å……\ndf.fillna(df.mean()).round(2).head() # ç”¨å‡å€¼å¡«å……ï¼Œä¿ç•™2ä½å°æ•°\ndf.fillna(method='ffill').head()  #ç”¨å‰ä¸€ä¸ªæ•°å¡«å……\ndf.fillna(menthod = 'bfill').head()  #ç”¨åä¸€ä¸ªæ•°æ®å¡«å……\n--ä¸‹é¢æ˜¯å¯¹é”™è¡Œæ•°æ®çš„å¤„ç†\nä¹‹å‰å¯¼å…¥sogouæ•°æ®çš„æ—¶å€™ï¼Œæœ‰é”™è¡Œçš„ï¼Œç°åœ¨è¦åˆ é™¤é”™è¡Œçš„æ•°æ®ï¼š'01 æœç‹— é”™è¡Œæ•°æ®.py'åœ¨è½¬æ¢rankå’Œnumberåˆ—ä¸ºintæ ¼å¼çš„æ—¶å€™æŠ¥é”™ï¼Œå‘ç°æ˜¯æœ‰çš„å…³é”®è¯åˆ°rankåˆ—äº†ï¼Œæ‰€ä»¥rankåˆ—æœ‰å­—ç¬¦çš„å†…å®¹ï¼Œç»è¿‡ç®€å•è€ƒè™‘ï¼Œå‡†å¤‡åˆ é™¤è¿™äº›é”™è¡Œçš„ã€‚\nå…ˆæ‰¾åˆ°é”™è¡Œçš„ï¼Œå°±æ˜¯ç­›é€‰å­—ç¬¦é•¿åº¦å¤§äº3ä½çš„\n- å¼ºåˆ¶è½¬æ¢ä¸ºint\nç„¶åå¼ºåˆ¶è½¬æ¢ä¸ºintï¼Œå†åˆ é™¤æ²¡æœ‰è½¬æ¢æˆåŠŸï¼Œå³ä¸ºç©ºå€¼çš„è¡Œ\n#æ²¡å‘ç°ofï¼Œå¼ºåˆ¶è½¬æ¢ä¸ºæ•°å­—.coerceæ˜¯å¼ºåˆ¶çš„æ„æ€ï¼Œignoreæ˜¯å¿½ç•¥\npd.to_numeric(sogou['rank'],errors='coerce')\npd.to_numeric(sogou['number'],errors='coerce')\n\n#ä¹Ÿå¯ä»¥ç”¨ä¸‹é¢çš„æ–¹æ³•ä¸€è¡Œæå®šï¼š\nsogou[['rank','number']] = sogou[['rank','number']].apply(pd.to_numeric,errors='coerce')\n\n- åˆ é™¤rankä¸ºç©ºçš„è¡Œ\n#åˆ é™¤è¿™äº›é”™è¯¯å€¼ï¼Œå¦‚æœç”¨sparkå°±ä¸ç”¨å¤„ç†è¿™ä¹ˆä¹…çš„æ•°æ®äº†ğŸ˜­\nsogou.dropna(subset=['rank'],inplace=True)\nsogou.info()\n\n\n>>>Outï¼š\n<class 'pandas.core.frame.DataFrame'>\nInt64Index: 823818 entries, 0 to 825118\nData columns (total 6 columns):\ndate      823818 non-null datetime64[ns]\nuserid    823818 non-null object\nwords     823818 non-null object\nrank      823818 non-null float64\nnumber    823818 non-null float64\nurl       823818 non-null object\ndtypes: datetime64[ns](1), float64(2), object(3)\nmemory usage: 44.0+ MB\n- ä¿å­˜csv\n#ä¿å­˜ä¸ºæ–°çš„csvï¼š\nsogou.to_csv('sogoudayclear.csv',index = False)\n\n                ", "mainLikeNum": ["0 "], "mainBookmarkNum": "0"}