{"title": "Python3结合Sciter编写桌面程序 - 个人文章 ", "index": "python", "content": "本文写于2017.8.21，不保证之后版本的兼容性\n第一节 基础介绍及最简单测试\n先上流程图\n在线流程图\n废话?\n最近在学Python3，啃书啃不下去，咱是那种用到啥学啥的类型，刚好想做一个扒图的程序，权当练习。选用Sciter的理由...因为咱是前端，先不说sciter有多好，至少目前是满足的。\n需求：\n\n\n界面\n\n多站点\n预览图片\n下载原图\n\n\n科学上网\n\n对一个扒图操作而言，单纯的Py就够了，网上栗子多得是，就不在废话但对用惯Windows的咱来说，我想要一个界面，并且我并不想把图全下载下来，我希望能有个预览，发现满意的再下载...这，只能搞成桌面程序了吧\n一点点来...\n首先从界面入手吧\nHTML写的，没啥难点，略过...\n一个很重要的点，Sciter写的界面如何与Python程序交互？\n假如有一个按钮:\n<button class=\"btn\">Button</button>\nTiscript（sciter专有脚本语言，类似Js）:\n$(.btn).on(\"click\",function(){\n    view.clickBtn(\"A\",\"B\");  //view Sciter内置的对象，所有tis都可调用\n})\nPython:\ndef clickBtn(self, p1, p2 = None):\n    pass\n那么，Python如何调用Tis的函数呢？\nTiscript:\nfunction myBtn(){\n    return;\n}\nPython:\ncall_function()是PySciter的方法\ndef clickBtn(self, p1, p2 = None):\n    self.call_function('myBtn')  \n    pass\n以上就完成了Python与Sciter的通信。\n\n拓展：\n\n关于传参问题\nview.clickBtn(\"A\");\n...\ndef clickBtn(self, p1, p2 = None ):\n      print( p1, type(p1) )\n输出 : \"A\" <class 'sciter.value.value'>我们的本意是传递字符串A，但得到的却是<class 'sciter.value.value'>类型的 \"A\" （此处\"是值的一部分）解决方法:str(p1).strip('\"')\n如何传递Json?\nview.clickBtn({\"a\":\"A\"});\n...\ndef clickBtn(self, p1, p2 = None ):\n      print( p1, type(p1) )\n输出 : {\"a\":\"A\"} <class 'sciter.value.value'>看着没问题...但\nprint(p1['a'])\n会报 TypeError 的错误\n解决方法:\np = json.loads( str(p1) )\nprint(p['a'])\ncall_function() 又是如何呢?\nself.call_function('myBtn','A')\n...\nfunction myBtn(p1){\n   stdout.println(p1);\n   return;\n}\n输出 : A可以看出值被准确的传递了, Json呢?\nself.call_function('myBtn',{'a':'A'})\n...\nfunction myBtn(p1){\n   stdout.println(p1[\"a\"]);\n   return;\n}\n输出 : A看来也是没有问题的。\n注意: Sciter中不识别单引号, \"'\"作为字符串没问题 , 但不可用于取值。即p['a'] 是错误的!!p['a'] 是错误的!!p['a'] 是错误的!!\n\nOk，说完了以上的基础知识，咱来开始正式的敲代码吧~\n先来一个最简单的页面：\n<html window-frame=\"transparent\">\n<head>\n<title>Demo</title>\n<style type=\"text/css\" src=\"scs/css.scs\"></style>\n<script type=\"text/tiscript\">\n    function clickCallBack(p1){\n        $(footer>section).text = p1;  //位于statusbar.html\n        return;\n    }\n</script>\n</head>\n<body>\n<widget#widget>\n<include src=\"titlebar.html\" />\n<section#body>\n    <button class=\"click-me\">点我</button>\n</section>\n<include src=\"statusbar.html\" />\n</widget>\n</body>\n\n</html>\n# 导入sciter支持,必须安装pysciter\nimport sciter\nimport ctypes\nimport json\nimport time\n\n# 设置dpi, 防止程序在高分屏下发虚\nctypes.windll.user32.SetProcessDPIAware(2)\n\nclass Frame(sciter.Window):\n    def __init__(self):\n        '''\n            ismain=False, ispopup=False, ischild=False, resizeable=True,\n            parent=None, uni_theme=False, debug=True,\n            pos=None,  pos=(x, y)\n            size=None\n        '''\n        super().__init__(ismain=True, debug=True)\n        self.set_dispatch_options(enable=True, require_attribute=False)\n\n    def clickMe(self):\n        # 此处用sleep来模拟需要耗时的操作\n        time.sleep(5)\n        self.call_function('clickCallBack','你已经点到我了!')\n\nif __name__ == '__main__':\n    frame = Frame()\n    frame.load_file(\"Gui/main.html\")\n    frame.run_app()\n\n运行效果:\n源码\n感觉还不错,不是吗?\nPython3结合Sciter编写桌面程序第二节\nPython3结合Sciter编写桌面程序第三节\n\n                ", "mainLikeNum": ["0 "], "mainBookmarkNum": "5"}