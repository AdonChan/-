{"title": "分离django中的媒体文件，静态文件和网页 - Ateon ", "index": "python", "content": "前言\n文章会在github中持续更新\n\n作者: knthony\n\ngithub\n联系我\n\n\ndjango项目中，占很大体积的是静态文件，媒体文件还有html代码，那我们该如何把它们分离出来以方便我们和服务器去管理和使用它们。\nstatic 文件\nstatic，顾名思义就是静态文件，django自带了一个命令讲项目中所有的静态文件提取出来python3 manage.py collectstatic\n我习惯将这些可以从外部引入的文件放在项目的根目录下\nDemoProject\n--DemoProject\n--DemoApp\n--static\n--manage.py\n是的，就是它，我喜欢的位置。不过在此之前，我们需要在项目的setting.py中去设置提取文件所要存储的位置STATIC_ROOT\nSTATIC_ROOT = os.path.join(BASE_DIR, \"static\")\n那这样，我们运行完上面的命令就会发现我们的项目结构中会多一个static文件然后配置DemoProject下的url，添加\nfrom django.contrib.staticfiles.urls import staticfiles_urlpatterns\nfrom django.conf.urls.static import static\nfrom django.conf import settings\n\n\nurlpatterns = [\n    url(r'^admin/', admin.site.urls),\n]\n\n\nif settings.DEBUG or True:\n    urlpatterns += staticfiles_urlpatterns()\n当然这个if判断是在debug为true的时候支持这样的访问，那如果在真实生产环境中需要修改遮盖判断不过到这里还没有结束，为了方便的引用我们需要在setting.py中添加\nSTATICFILES_DIRS = [\n    ('bootstrap',os.path.join(BASE_DIR, 'static/bootstrap').replace('\\\\','/')),\n]\n注意这种方式在html中可以直接以如下方式访问\n<link rel=\"stylesheet\" href=\"{% static \"bootstrap/css/bootstrap.min.css\" %}\">\n注意要在第一行加上{% load staticfiles %}\nmedia文件\n网站上总是会有音乐视频或者图片等体积比较大的文件，那我们将这些也从django项目中分离出来并进行调用首先我们在和static同目录下新建一个media文件夹，在media中新建一个image作为我们存放图片的文件夹结构如下：\nDemoProject\n--DemoProject\n--DemoApp\n--static\n--media\n---image\n--manage.py\n第一步：在setting.py最后添加\nMEDIA_URL = '/media/'\nMEDIA_ROOT = os.path.join(BASE_DIR, \"media\")\n第二部：在urls.py中在 urlpatterns += staticfiles_urlpatterns()下面添加urlpatterns += static(settings.MEDIA_URL, document_root=settings.MEDIA_ROOT)\n说出来你可能不信，这样就ok了\n<img src=\"/media/image/test.png\" alt=\"\">\n这样就可以访问我们的media/image下的图片或者视频了\ntemplates\n如果我们想把项目中的网页代码文件归类分离出来第一步：\n\nTEMPLATES = [\n    {\n        'BACKEND': 'django.template.backends.django.DjangoTemplates',\n        'DIRS': [\n            os.path.join(BASE_DIR, 'templates').replace('\\\\','/'),\n        ],\n        'APP_DIRS': True,\n        'OPTIONS': {\n            'context_processors': [\n                'django.template.context_processors.debug',\n                'django.template.context_processors.request',\n                'django.contrib.auth.context_processors.auth',\n                'django.contrib.messages.context_processors.messages',\n            ],\n        },\n    },\n]\n在上面代码的DIRS中添加你网页代码的路径，如果也想和我一样放在根路径下可以和我一样\nos.path.join(BASE_DIR, 'templates').replace('\\\\','/'),\n这是最近写django项目总结的一点点，第一次写文章，大牛勿喷，感谢大牛能指出文中的缺漏和错误\n\n                ", "mainLikeNum": ["2 "], "mainBookmarkNum": "5"}