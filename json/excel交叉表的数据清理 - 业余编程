{"title": "excel交叉表的数据清理 - 业余编程 ", "index": "excel,python", "content": "之前在做一个excel的简单教程的时候：B站的一个Excel简单教程\n当时演示应该把交叉表（图1）转换成数据表格（图2）的形式。\n\n\n但是在excel里没有直接实现这个需求的函数，R的tidyr包有一个spread可以实现这功能，但是，毕竟是R。\npython同样可以实现这个需求，借助openpyxl这个包和excel互动，然后用一点代码就可以完成了：\nfrom openpyxl import Workbook,load_workbook\nfrom openpyxl.utils import get_column_letter\nwb = load_workbook('测试.xlsx')\nws = wb.active\nrcList = tuple(ws.rows)\nprint(rcList)\ndef spreadIt(rcList,rowVarName='var1',colVarName='var2',cellVarName='var3'):\n    rLength = len(rcList)\n    cLength = len(rcList[0])\n    rst = [[rowVarName,colVarName,cellVarName]]\n    for i in range(1,rLength):\n        for j in range(1,cLength):\n            rst.append([rcList[i][0].value, rcList[0]\n                        [j].value, rcList[i][j].value])\n    return rst\n\ndef write2Sheet(spreaded,worksheet):\n    for i in range(len(spreaded)):\n        for j in range(len(spreaded[0])):\n            worksheet[\"%s%d\"%(get_column_letter(j+1),i+1)]=spreaded[i][j]\n\nwbNew = Workbook()\nwsNew = wbNew.active\nwrite2Sheet(spreadIt(rcList,rowVarName='节数',colVarName='星期',cellVarName='课程'),wsNew)\n\nwbNew.save(filename='test.xlsx')\n\n                ", "mainLikeNum": ["1 "], "mainBookmarkNum": "0"}