{"title": "微信公众号开发小记——1.接入微信服务器 - 后端开发那点事儿 ", "index": "django,微信开发,python", "content": "描述\n由于马上要做一波公众号开发，今天先调研，把基本的服务器接起来。微信公众号服务器在接入的时候要做一些烦躁的事情，改配置的时候要进行握手，api调用要做一些烦躁的加密解密检查，而且微信使用的是xml解析也比较烦，所以需要找一个靠谱的sdk来做api调用以及各种解析。\n由于我知道会做多个不同服务号的开发，那么为什么不做个脚手架呢，方便接入。\n手脚架地址wechat-python-sdksdk文档\n微信公众号\n公众号开发首先你要有个公众号，这里就不说了按照流程申请。微信公众号地址看看微信公众号开发需要的一些配置数据\n点击开发的基本配置\n就会看到这个地方，所有的配置都在这里，把这些配置加到脚手架的local_settings.py里面，启动脚手架，服务器配置你点击启用。\n脚手架的说明\n微信公众号接入的时候要做很多事情，为了简化开发，提供一个django版本的服务器。\n用到了wechat-python-sdk\n安装\ngit clone xxx weixin_server\ncd weixin_server\nsource 你的virtualenv\npip install -r requirements.txt\n\n配置\nngrok配置\n微信服务器测试时需要打洞，用的ngrok, 在项目的ngrok目录下有个配置start.sh里面把your_domain配置成你想用的二级域名，ngrok.conf下可以看到,用的ittun.com这样访问的时候就可以用你配置的二级域名.ittun.com访问了，注意这个域名要配置在微信的URL(服务器地址)\nstart.sh后面的8888是你本机服务的端口号，例如我用django的runserver启动在8888端口，那么这里就是8888\n微信的各种配置\n在settings.py目录下新建一个local_settings.py, 根据微信公众号的信息，把下面的东西补全.\n# weixin config\nWEIXIN_TOKEN = 'Your weixin token'\nWEIXIN_APP_ID = 'Your weixin app id'\nWEIXIN_APP_SECRET = 'Your weixin app secret'\nWEIXIN_ENCODING_AES_KEY = 'Your weixin encoding aes key'\nWEIXIN_ENCRYPT_MODE = 'safe' # safe | compatible | normal\n\n调试\nngrok的配置以/etc/ngrok/ngrok -config=/etc/ngrok/ngrok.conf -subdomain=your_subdomin 8888为例\n你公众号的服务器URL配置应该为 http://your_subdomin.ittun.com\n./weixin_server/manager.py runserver 8888\n./ngrok/start.sh\n\n然后进入你的公众号发送信息就可以了。\n目前只接入了基本的文本的demo，后期会根据其他的东西做handler之类的，以及具体的代码讲解之后再说。\n\n                ", "mainLikeNum": ["0 "], "mainBookmarkNum": "18"}