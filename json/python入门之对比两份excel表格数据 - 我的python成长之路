{"title": "python入门之对比两份excel表格数据 - 我的python成长之路 ", "index": "python", "content": "今天老大交给我一个任务，对比两个版本的excel数据的异同（增删情况），唉，说多了都是泪，自从学会了python，再也不用担心老大这样的任务了~~~好了直接上代码吧，代码中解释\nimport xlrd\nimport xlwt\n#from xlutils.copy import copy #暂时用不上\nimport os\n\nl_p=[]#定义两个全局list，分别存储原始和目的需要对比的数据\nl_t=[]\n\ndef read_excel():\n    wb_pri = xlrd.open_workbook('verp.xlsx')#打开原始文件\n    wb_tar = xlrd.open_workbook('vert.xlsx')#打开目标文件\n    wb_result = xlwt.Workbook()#新建一个文件，用来保存结果\n    sheet_result = wb_result.add_sheet('result',cell_overwrite_ok=True)\n    result_i =0\n    result_j =0\n    for sheet_i in range(2,21):\n        sheet_pri = wb_pri.sheet_by_index(sheet_i) #通过index获取每个sheet，为了省心，我根据自己的需要限定为第2-21个sheet\n        sheet_tar = wb_tar.sheet_by_index(sheet_i)\n        sheet_backup = wb_backup.get_sheet(sheet_i)\n        print(sheet_pri.name,sheet_tar.name)\n        #为什么是取这一列，因为这就是需要对比的数据阿 \n        l_p = sheet_pri.col_values(2)\n        l_t = sheet_tar.col_values(2)\n\n        #tmp =[var for val in a if val in b] #这个是求交集,老大没要求是用不上的\n        #求参数在pri（原始数据）中存在，而在tar（目标）中不存在的\n        tmp_pd = list(set(l_p).difference(set(l_t)))\n        #求参数在tar中存在，而在pri中不存在的\n        tmp_td = list(set(l_t).difference(set(l_p)))\n        \n        if result_i <result_j:\n            result_i =result_j\n        else:\n            result_j =result_i\n        for pd_i in tmp_pd:\n            result_i = result_i+1\n            sheet_result.write(result_i,0,sheet_pri.name)\n            sheet_result.write(result_i,2,pd_i)\n        for td_i in tmp_td:\n            result_j =result_j +1\n            sheet_result.write(result_j,1,sheet_tar.name)\n            sheet_result.write(result_j,3,td_i)\n    #好了，可以去名为result的excel中查看结果了\n    wb_result.save('result.xls') \n \nif __name__ == '__main__':\n  read_excel()\n\n                ", "mainLikeNum": ["2 "], "mainBookmarkNum": "4"}