{"title": "2017中国大学排名爬虫代码修改 - 个人文章 ", "index": "python,html,网页爬虫", "content": "本文是学习http://www.icourse163.org/lea... 课程的代码实现和反思。\n课程的第6单元中嵩天老师给出的“中国大学排名爬虫”优化代码如果把url中的2016改为2017就会出错，原因：2016年各校排名数字的html格式为<td>1</td>,而2017年各校排名数字的html格式为<td>1<td>，针对这个问题，我对嵩天老师的代码做了一点修改，可能不是很漂亮，但是实现了功能我很开心。代码如下：\nimport requests, bs4, re\nfrom bs4 import BeautifulSoup\n\n\ndef getHTMLText(url):\n    try:\n        r = requests.get(url, timeout=30)\n        r.raise_for_status()\n        r.encoding = r.apparent_encoding\n        return r.text\n    except:\n        return ''\n\ndef fillUnivList(ulist, html):\n    soup = BeautifulSoup(html, 'html.parser')\n    for tr in soup.find('tbody').children:\n        if isinstance(tr, bs4.element.Tag):\n            yield tr   #用到了生成器\n\ndef peidui(ulist, html):\n    xlt = re.findall(r'<td>\\d{1,4}?<td>',html)  #用到了最小匹配\n    for tr,i in zip(fillUnivList(uinfo, html), xlt): #一次循环2个变量用到了zip\n        tds = tr('td')\n        ulist.append([i.replace('<td>',''), tds[1].string, tds[3].string])\n\ndef printUnivList(ulist, num):\n    tplt = '{0:^10}\\t{1:{3}^10}\\t{2:^10}'\n    print(tplt.format('排名','学校名称','总分',chr(12288)))\n    for i in range(num):\n        u=ulist[i]\n        print(tplt.format(u[0],u[1],u[2],chr(12288)))\n    \ndef main():\n    uinfo = []\n    url = 'http://www.zuihaodaxue.cn/zuihaodaxuepaiming2017.html'\n    html = getHTMLText(url)\n    peidui(uinfo, html)\n    printUnivList(uinfo, 20) \nmain()\n\n运行结果如下：\n\n排名来自最好大学网，只是作为爬虫练习使用，觉得排名不合适的网友勿喷。\n\n                ", "mainLikeNum": ["0 "], "mainBookmarkNum": "0"}