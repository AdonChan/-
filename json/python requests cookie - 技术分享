{"title": "python requests cookie - 技术分享 ", "index": "python", "content": "\n#encoding=utf8\nimport requests,time\n#登录知乎后通过document.cookie获取cookie\ncookie = '_zap=78503ecc-9420-482c-a747-5761a7c9de8c; _za=de220e47-6e79-4c2d-80c6-74a86eb567ce; _ga=GA1.2.932820854.1429357203; udid=\"xxxxxxxxxxx\";'\nDefault_Header = {'X-Requested-With': 'XMLHttpRequest',\n                  'Referer': 'http://www.zhihu.com',\n                  'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; '\n                                'rv:39.0) Gecko/20100101 Firefox/39.0',\n                  'Host': 'www.zhihu.com',\n                  'Cookie':cookie}\n_session = requests.session()\n_session.headers.update(Default_Header)\nheader = {'X-Requested-With': 'XMLHttpRequest',\n                  'Referer': 'http://www.zhihu.com',\n                  'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; '\n                                'rv:39.0) Gecko/20100101 Firefox/39.0',\n                  'Host': 'www.zhihu.com'}\n\nurl = 'https://www.zhihu.com/noti7/stack/default?limit=10&r=1473558020498' \ncookies={} \nfor line in cookie.split(';'): \n    name,value=line.strip().split('=',1) \n    cookies[name]=value\n#r = requests.get(url, headers=Default_Header) \nr = requests.get(url, headers=header,cookies=cookies) \n#r = _session.get(url) \n#print(r.content)\n#print(cookies)\nprint(r.json())\n\n#模拟登录\ndef login():\n    '''登录知乎'''\n    username = 'xxx'\n    password = 'xxx'\n    cap_content = _session.get('https://www.zhihu.com/captcha.gif?r='+str(int(time.time())*1000)+'&type=login').content\n    cap_file = open('cap.gif','wb')\n    cap_file.write(cap_content)\n    cap_file.close()\n    captcha = input('capture:')\n    data = {\"email\":username,\"password\":password,\"captcha\":captcha}\n    r = _session.post('https://www.zhihu.com/login/email', data)\n    print ((r.json())['msg'])\n                ", "mainLikeNum": ["1 "], "mainBookmarkNum": "1"}