{"title": "python docx文档转html页面 - 个人文章 ", "index": "word,docx,doc,python3.x,python", "content": "文章链接：https://mp.weixin.qq.com/s/uMb2ziRS1NJ1GXIjofeANg\n\n说到word文档转html的，网上一搜一大把，各种在线word转html页面，使用起来也方便。但是在实际项目中要使用的话，需要自己开发，这里就提供一个简单的方法。   后缀 .doc 和 .docx  都是word文档，doc是word2003以及之前版本保存的文档，docx是word2007、word2010等保存的新型文档，本质都是属于文字排版的文件。注意 这里提供的方法暂时是针对docx的。   \n这里使用pydocx的库，安装pip3 install pydocx，可以直接对docx文件进行处理，简单粗暴，PyDocX.to_html(\"**.docx\")，返回值就是转换后的html的源码，然后再通过写文件，写到html文件里面。\nfrom pydocx import PyDocX\nhtml = PyDocX.to_html(\"test.docx\")\nf = open(\"test.html\", 'w', encoding=\"utf-8\")\nf.write(html)\nf.close()\n这里对文件的处理都是当前文件夹下面的，得到的html文件可以直接打开查看，通过对html查看，可以发现文字转换成了P标签，图片使用base64 的方式显示的。   \n这里是对本地的文件进行处理，进一步部署到服务器上，我使用的是Django的项目，前端页面通过form 表单进行上传docx 文件。\n<form method=\"post\" enctype=\"multipart/form-data\">\n<input type=\"file\" name=\"file\" accept=\"application/vnd.openxmlformats-officedocument.wordprocessingml.document\">\n</form>\n<input> type属性定为file，accept=\"application/vnd.openxmlformats-officedocument.wordprocessingml.document\" 筛选docx 的文件。  \n\n使用地址：https://www.manjiexiang.cn/blog/wordtohtml   \n这里上传的文件是docx格式的word文档，针对doc 的文档，可以手动改成docx后缀名，进行上传使用。 尝试用代码转换成docx，window平台下有相应的库，ubantu 暂时无果，欢迎码友提供解决方法。   介绍下window平台下的代码转换方法，pip3 install pypiwin32安装这个库，里面有win32com，将doc文档转成docx 的。\nfrom win32com import client\nword = client.Dispatch(\"Word.Application\")\ndoc = word.Documents.Open(\"D:\\\\***\\\\**.doc\") //绝对路径 doc文件\ndoc.SaveAs(\"D:\\\\***\\\\**.docx\",16) //保存的docx 文件，绝对路径\ndoc.Close()\nword.Quit()\n欢迎关注我的个人博客：https://www.manjiexiang.cn/  \n更多精彩欢迎关注微信号：春风十里不如认识你  一起学习，一起进步，欢迎上车，有问题随时联系，一起解决！！！\n\n\n                ", "mainLikeNum": ["0 "], "mainBookmarkNum": "0"}