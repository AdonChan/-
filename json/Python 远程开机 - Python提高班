{"title": "Python 远程开机 - Python提高班 ", "index": "python,开机启动,黑科技", "content": "用 Python 关机你肯定听过或者实践过，那么用 Python 开机呢？这是一个神奇的方法，教你如何用 Python 来开机。\nGitHub 仓库地址：https://github.com/injetlee/Python/tree/master/Python%20%E9%BB%91%E9%AD%94%E6%B3%95\n本文目标\n\n远程开机原理\nPython 远程开机代码实现\nPython 关机说明\n\nPython 开机\n关于用程序来开机，是怎么做到的呢？这就是 WOL 技术 Wake-On-Lan, 利用计算机在关机或休眠状态时，网卡及主板部分仍然有微弱的供电，当然要保持电源是插上的，而且是有线连接。所以即使在关机情况下，网卡还是有一定运作能力的，可以监听计算机外部的网上广播信息，当发现特定格式的信息后就会执行开机。现在的主板基本都支持。\n只需要在网络适配器属性中配置下面两个选项\n\n\n下图这个勾不能选上，我们要保证网卡在关机后仍有供电，如果你关机后，网口的灯不亮了，就不行了，要保持网口灯亮。\n\n这个特定数据也有个好听的名字叫 Magic Packet(魔法数据包)。一般用过 UDP 协议进行广播。端口一般是7或者9. 魔法数据包总是以\"FF FF FF FF FF FF\" 连续6个 \"FF\",后面是 MAC 地址信息，一旦网卡侦测到数据包内容，就会唤醒目标计算机。\n我们还是来看一下代码怎么写，代码涉及到 UDP 网络编程这块，后面会专门写写网络编程这块内容。此函数只需输入目标计算机的 MAC 地址即可，在局域网中（当然，如果你的计算机有公网IP，那么在公网中也是可以的）另一台计算机上运行此程序，目标计算机即可自动开机。\n代码如下，代码本身很短，原理也很简单：\ndef wake_up(request, mac='DC-4A-3E-78-3E-0A'):\n    MAC = mac\n    BROADCAST = \"192.168.0.255\"\n    if len(MAC) != 17:\n        raise ValueError(\"MAC address should be set as form 'XX-XX-XX-XX-XX-XX'\")\n    mac_address = MAC.replace(\"-\", '')\n    data = ''.join(['FFFFFFFFFFFF', mac_address * 20])  # 构造原始数据格式\n    send_data = b''\n\n    # 把原始数据转换为16进制字节数组，\n    for i in range(0, len(data), 2):\n        send_data = b''.join([send_data, struct.pack('B', int(data[i: i + 2], 16))])\n    print(send_data)\n\n    # 通过socket广播出去，为避免失败，间隔广播三次\n    try:\n        sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)\n        sock.setsockopt(socket.SOL_SOCKET, socket.SO_BROADCAST, 1)\n        sock.sendto(send_data, (BROADCAST, 7))\n        time.sleep(1)\n        sock.sendto(send_data, (BROADCAST, 7))\n        time.sleep(1)\n        sock.sendto(send_data, (BROADCAST, 7))\n        return HttpResponse()\n        print(\"Done\")\n    except Exception as e:\n        return HttpResponse()\n        print(e)\nPython 关机\n关机来说相对就容易多了，网上也有很多现成的解决方案。大多数是用程序扫描邮箱，如果收到关机相关关键词的邮件，则程序自动执行关机命令。另外如果只是在局域网里实现关机，或者你有公网 IP 地址的话，也可以在本地计算机起一个服务，比如用 Flask 运行在5000端口。向5000这个地址发送指令即可。本机程序中需要有一条执行关机的命令即可\nimport os\nos.system('shutdown -s -t 00')\n\n                ", "mainLikeNum": ["21 "], "mainBookmarkNum": "13"}