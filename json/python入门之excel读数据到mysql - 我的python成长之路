{"title": "python入门之excel读数据到mysql - 我的python成长之路 ", "index": "python", "content": "功能：将Excel数据导入到MySQL数据库  练习使用sqlite3 将excel的数据导入到mysql  练习sql语句-查看dochttps://docs.python.org/3/lib...http://www.runoob.com/sqlite/...\n    import xlrd\n    import sqlite3\n\n    def save_cd_table():\n        # 创建插入SQL语句\n        query = '''INSERT INTO orders (job_number, name, section, date, time_in, time_out) VALUES (%s, %s, %s, %s, %s, %s)'''\n        cursor.execute('''CREATE TABLE cd_table(job_number, name, section, date, time_in, time_out)''')\n        # 创建一个for循环迭代读取xls文件每行数据的, 从第二行开始是要跳过标题\n        for r in range(1, sheet.nrows):\n          \n\n        # 关闭游标\n        cursor.close()\n    \n        # 提交\n        database.commit()\n    \n        # 关闭数据库连接\n        database.close()\n    \n        # 打印结果\n        print (\"\")\n        print (\"Done! \")\n        print (\"\")\n        #columns = str(sheet.ncols)\n        #rows = str(sheet.nrows)\n        #print (\"我刚导入了  %d columns \",columns )\n    \n    def read_cd_table(cursor):\n        #t=('10759',)\n        cursor.execute(\"SELECT * FROM cd_table WHERE job_number =10759 \")\n        result=cursor.fetchall()\n        print(result)\n        #for row in cursor.execute('SELECT * FROM cd_table ORDER by name'):\n        #for row in cursor.execute(\"SELECT * FROM cd_table WHERE job_number=10759\"):\n        #    print(row)\n    \n    def main():\n        # Open the workbook and define the worksheet\n        book = xlrd.open_workbook(\"CD.xls\")\n        #除了sheet_by_index之外还可以sheet_by_name,另外xlwt的写操作词篇暂不赘述\n        #对于excel的操作有很多有意思的方法，此后会专门写一篇\n        sheet = book.sheet_by_index(0)\n        #建立一个MySQL连接\n        database = sqlite3.connect (\"mysql_cd.db\")\n        # 获得游标对象, 用于逐行遍历数据库数据\n        cursor = database.cursor()\n        rows = str(sheet.nrows)\n        try:\n            save_cd_table()\n        except :\n            print(\".db file is exist\")\n        finally:\n            print('out..')\n        read_cd_table(cursor)\n        print(rows)\n        cursor.close()\n        database.close()\n    \n    if __name__ == '__main__':\n    main()\n\n                ", "mainLikeNum": ["0 "], "mainBookmarkNum": "0"}