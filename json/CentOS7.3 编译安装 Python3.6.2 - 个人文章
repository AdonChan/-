{"title": "CentOS7.3 编译安装 Python3.6.2 - 个人文章 ", "index": "python,linux", "content": "\n我使用的是 CentOS7.3 安装 Python3.6.2\n1.查看是否已经安装Python\nCentos7 默认安装了Python2.7.5 因为一些命令要用它比如 yum 它使用的是 python2.7.5.\n使用 python -V 命令查看一下是否安装 Python：\n# python -V\nPython 2.7.5\n然后查看一下 Python 可执行文件的位置：\n# which python\n/usr/bin/python\n进入到 bin 目录：\n# cd /usr/bin/\n# ls -al python*\nlrwxrwxrwx. 1 root root   34 8月  25 08:18 python -> python2\nlrwxrwxrwx. 1 root root    9 8月  19 21:32 python2 -> python2.7\n-rwxr-xr-x. 1 root root 7136 11月  6 2016 python2.7\n可以看到可执行文件 python 指向 python2 ，python2 又指向 python2.7 也就是说 Python 命令执行的系统预装的 Python2.7.\n要安装 Python 的其他版本先执行 mv python python.bak 命令备份 python 文件。\n# mv python python.bak\n# ls -al python*\nlrwxrwxrwx. 1 root root    9 8月  19 21:32 python2 -> python2.7\n-rwxr-xr-x. 1 root root 7136 11月  6 2016 python2.7\nlrwxrwxrwx. 1 root root    7 8月  19 21:32 python.bak -> python2\n2.修改 yum 配置文件\n因为yum使用CentOS7.3默认安装的Python 2.7.5,因此替换为Python 3.6.2后无法正常工作.\n# yum repolist\n  File \"/usr/bin/yum\", line 30\n    except KeyboardInterrupt, e:\n                            ^\nSyntaxError: invalid syntax\n因此修改yum配置文件,继续使用Python2.7.5.\n更改yum脚本的python依赖\n# cd /usr/bin\n# ls -al yum*\n-rwxr-xr-x. 1 root root   801 11月 15 2016 yum\n-rwxr-xr-x. 1 root root  9429 11月  6 2016 yum-builddep\n-rwxr-xr-x. 1 root root  8582 11月  6 2016 yum-config-manager\n-rwxr-xr-x. 1 root root  7609 11月  6 2016 yum-debug-dump\n-rwxr-xr-x. 1 root root  7903 11月  6 2016 yum-debug-restore\n-rwxr-xr-x. 1 root root 10999 11月  6 2016 yumdownloader\n-rwxr-xr-x. 1 root root 11031 11月  6 2016 yum-groups-manager\n\n使用vim更改以上文件头,把 #!/usr/bin/python 改为 #!/usr/bin/python2\n修改gnome-tweak-tool配置文件\n# vim /usr/bin/gnome-tweak-tool\n把文件头 #!/usr/bin/python 改为 #!/usr/bin/python2\n修改urlgrabber配置文件\n# vim /usr/libexec/urlgrabber-ext-down\n把文件头 #!/usr/bin/python 改为 #!/usr/bin/python2\n3.编译环境准备\n安装开发套件用于编译 Python3.6.2 源码\n# yum groupinstall 'Development Tools'\n安装 python3.6.2 可能会使用到的依赖\n# yum install -y ncurses-libs zlib-devel mysql-devel bzip2-devel openssl-devel ncurses-devel sqlite-devel readline-devel tk-devel gdbm-devel db4-devel libpcap-devel xz-devel\n4.安装 Python3.6.2\n到官网获取最新版的 Python3.6.2 下载地址 https://www.python.org/downloads/source/下载 tgz.xz 包就可以了. Python-3.6.2.tar.xz ,这个是 Python 的源码.\n执行wget 命令直接下载到当前文件夹：\n# wget https://www.python.org/ftp/python/3.6.2/Python-3.6.2.tar.xz\n解包:\n# xz -d Python-3.6.2.tar.xz\n解压缩：\n# tar -xvf Python-3.6.2.tar.xz\n解压缩之后出现 Python-3.6.2 文件夹.\n# ll\ndrwxr-xr-x. 17 max max     4096 8月  25 01:22 Python-3.6.2\n-rw-rw-r--.  1 max max 83169280 7月  17 11:55 Python-3.6.2.tar\n进入到Python-3.6.2文件夹下,编译源码\n# cd Python-3.6.2/\n# ./configure --prefix=/usr/local/python3.6 --enable-optimizations\n先解释上面的参数:\n\n--prefix选项是配置安装的路径，如果不配置该选项，安装后可执行文件默认放在/usr/local/bin，库文件默认放在/usr/local/lib，配置文件默认放在/usr/local/etc，其它的资源文件放在/usr/local/share，比较凌乱.如果配置--prefix，如：./configure --prefix=/usr/local/python3.6可以把所有资源文件放在/usr/local/python3.6的路径中，不会杂乱.用了--prefix选项的另一个好处是卸载软件或移植软件。当某个安装的软件不再需要时，只须简单的删除该安装目录,就可以把软件卸载得干干净净；移植软件只需拷贝整个目录到另外一个相同的操作系统机器即可.当然要卸载程序，也可以在原来的make目录下用一次make uninstall，但前提是make文件指定过uninstall.\n--enable-optimizations 是优化选项（LTO,PGO 等）加上这个 flag 编译后，性能有 10% 左右的优化,但是这会明显的增加编译时间,老久了.\n./configure命令执行完毕之后创建一个文件 Makefile, 供下面的make命令使用,执行make install之后就会把程序安装到我们指定的文件夹中去.\n\n然后执行make命令\n# make\n再执行make install命令\n# make install\n安装完成之后进入到/usr/local/python3.6目录,可以看到Python的可执行文件目录bin等相关目录.\n# cd /usr/local/python3.6\n# ll\n总用量 4\ndrwxr-xr-x. 2 root root 4096 8月  25 08:07 bin\ndrwxr-xr-x. 3 root root   24 8月  25 08:07 include\ndrwxr-xr-x. 4 root root   63 8月  25 08:07 lib\ndrwxr-xr-x. 3 root root   17 8月  25 08:07 share\n进入bin目录,可以看到很多相关的可执行文件,目前只需要关注python3.6、pip3.6.\n# cd bin\n# ll\n总用量 22552\nlrwxrwxrwx. 1 root root        8 8月  25 08:07 2to3 -> 2to3-3.6\n-rwxr-xr-x. 1 root root      111 8月  25 08:07 2to3-3.6\n-rwxr-xr-x. 1 root root      252 8月  25 08:07 easy_install-3.6\nlrwxrwxrwx. 1 root root        7 8月  25 08:07 idle3 -> idle3.6\n-rwxr-xr-x. 1 root root      109 8月  25 08:07 idle3.6\n-rwxr-xr-x. 1 root root      224 8月  25 08:07 pip3\n-rwxr-xr-x. 1 root root      224 8月  25 08:07 pip3.6\nlrwxrwxrwx. 1 root root        8 8月  25 08:07 pydoc3 -> pydoc3.6\n-rwxr-xr-x. 1 root root       94 8月  25 08:07 pydoc3.6\nlrwxrwxrwx. 1 root root        9 8月  25 08:07 python3 -> python3.6\n-rwxr-xr-x. 2 root root 11526224 8月  25 08:06 python3.6\nlrwxrwxrwx. 1 root root       17 8月  25 08:07 python3.6-config -> python3.6m-config\n-rwxr-xr-x. 2 root root 11526224 8月  25 08:06 python3.6m\n-rwxr-xr-x. 1 root root     3107 8月  25 08:07 python3.6m-config\nlrwxrwxrwx. 1 root root       16 8月  25 08:07 python3-config -> python3.6-config\nlrwxrwxrwx. 1 root root       10 8月  25 08:07 pyvenv -> pyvenv-3.6\n-rwxr-xr-x. 1 root root      451 8月  25 08:07 pyvenv-3.6\n5.修改软链接配置 Python3.6 、pip3.6 为系统默认\n# ln -s /usr/local/python3.6/bin/python3.6 /usr/bin/python\n# ln -s /usr/local/python3.6/bin/pip3.6 /usr/bin/pip\n进入/usr/bin目录查看相关软链接配置结果:\n# cd /usr/bin\n# ls -al python*\nlrwxrwxrwx. 1 root root   34 8月  25 08:18 python -> /usr/local/python3.6/bin/python3.6\nlrwxrwxrwx. 1 root root    9 8月  19 21:32 python2 -> python2.7\n-rwxr-xr-x. 1 root root 7136 11月  6 2016 python2.7\nlrwxrwxrwx. 1 root root    7 8月  19 21:32 python.bak -> python2\n\n# ls -al pip*\nlrwxrwxrwx. 1 root root 31 8月  25 08:21 pip -> /usr/local/python3.6/bin/pip3.6\n查看系统默认 Python、pip版本:\n# python -V\nPython 3.6.2\n\n# python2 -V\nPython 2.7.5\n\n# pip -V\npip 9.0.1 from /usr/local/python3.6/lib/python3.6/site-packages (python 3.6)\n现在系统默认的python版本为Python 3.6.2,而CentOS7.3默认安装的Python 2.7.5现在可以使用python2调用.pip 也变成了最新版本的.\n到这里CentOS7.3 编译安装 Python3.6.2就完成了!\n\n                ", "mainLikeNum": ["3 "], "mainBookmarkNum": "3"}