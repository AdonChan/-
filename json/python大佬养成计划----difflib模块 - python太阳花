{"title": "python大佬养成计划----difflib模块 - python太阳花 ", "index": "python", "content": "difflib模块\ndifflib为python的标准库模块，无需安装。用来对比文本之间的差异。并且支持输出可读性比较强的HTML文档，与LInux下的diff 命令相似。在版本控制方面非常有用。\ncodecs模块\nopen打开文件只能写入str类型,不管字符串是什么编码方式。\n但是有时候我们爬虫或者其他方式得到一些数据写入文件时会有编码不统一的问题，所以就一般都统一转换为unicode。此时的open打开文件会报错。\n写入时，如果参数 是unicode，则使用open()时指定的编码进行编码后写入；如果是str，则先根据源代码文件声明的字符编码，解码成unicode后再进行前述 操作。相对内置的open()来说，这个方法比较不容易在编码上出现问题。\ndifflib对比\n\nimport  difflib\nimport codecs\n\n# ['', '1 line', '2 line']\ntext1 = '''  \n    1. Beautiful is better than ugly.\n    2. Explicit is better than implicit.\n    3. Simple is better than complex.\n    4. Complex is better than complicated.\n'''.splitlines(keepends=True)\n\n\ntext2 = '''  \n    1. Beautifu  is better than ugly.\n    2. Explicit is better than implicit.\n    3. Simple is better than complex.\n    4. Complex is better than complicated.\n'''.splitlines(keepends=True)\n\n\n\n# 1. 以字符串方式展示两个文本的不同， 效果如下:\nd = difflib.Differ()\nresult = list(d.compare(text1, text2))\nresult = \" \".join(result)\nprint(result)\n\"\"\"\n -     1. Beautiful is better than ugly.\n ?                ^\n +     1. Beautifu  is better than ugly.\n ?                ^\n       2. Explicit is better than implicit.\n       3. Simple is better than complex.\n       4. Complex is better than complicated.\n\"\"\"\n\n\n# 2. 以html方式展示两个文本的不同， 浏览器打开:\nd = difflib.HtmlDiff()\nwith codecs.open(\"diff.html\", 'w','utf-8') as f:\n    f.write(d.make_file(text1, text2))\n\ndifflib示例\nimport  difflib\nimport codecs    \nfile1=\"D:\\python_need\\data.txt\"\nfile2='D:\\python_need\\cp.txt'\n\n\nwith open(file1)  as f1, open(file2) as f2:\n    text1 = f1.readlines()\n    text2 = f2.readlines()\n\nd = difflib.HtmlDiff()\nwith codecs.open(\"passwd.html\", 'w','utf-8') as f:\n    f.write(d.make_file(text1, text2))\n\n封装difflib模块\n使调用'mydiff 文件1 文件2'命令生成一个html文件，网页读取两者不同之处\n#!/home/kiosk/anaconda2/envs/mysql3/bin/python3\n\n#解释器如上\n\"\"\"如果要直接调用mydiff,需要添加文件到/usr/local/bin,\n封装difflib模块,文件命名为mydiff\nTerminal命令：sudo cp mydiff /usr/local/bin\"\"\"\nimport difflib\nimport os\nimport sys\n\"\"\"mydiff /etc/passwd /tmp/passwd >>differ.html\"\"\"\n\n\nif len(sys.argv) == 3:\n    # 命令行跟随的参数\n    file1 = sys.argv[1]\n    file2 = sys.argv[2]\n    with open(file1) as f1 ,open(file2) as f2:\n        text1 = f1.readlines()\n        text2 = f2.readlines()\n    d = difflib.HtmlDiff()\n    with open('differ.html', 'w') as f:\n        f.write(d.make_file(text1, text2))\nelse:\n    print(\"\"\"\n    Usage : %s 文件1 文件2 - 返回一个html页面\n    \"\"\" %(os.path.basename(sys.argv[0])))\n\n\n\n                ", "mainLikeNum": ["0 "], "mainBookmarkNum": "0"}