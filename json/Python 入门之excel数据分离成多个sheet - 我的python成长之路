{"title": "Python 入门之excel数据分离成多个sheet - 我的python成长之路 ", "index": "python", "content": "最近老大发了疯一样给我布置很多坑一样的任务，郁闷至极，今天这是一个非常简单的操作excel的示例。假如你全公司的数据都在一张表格中 ，那么请用这个把它们按部门分离出来吧。\n用python写一些小工具确实是简单啊。\noptionParser，继上一节的Entry之后，你就已经知道了怎样输入你的文本，那么通过命令行呢，这里的optionParser就是实现了这个目的。使用optionparser模块来解析\noptionparser的执行过程：导入optionparser ： from optparse import OptionParser构造optionparser的对象：parser = OptionParser()往optionparser对象中增加option ：parser.add_option()调用optionparser的解析函数：(options, args) = parser.parse_args()在options中使用解析到的options，在args中使用其他的args。\nfrom optparse import OptionParser\nimport sys\nimport xlrd,xlwt\n\nSTRING = '部门' #按部门分离\nTITLE_ROW = 0\ndef split_file(filename):\n    workbook = xlrd.open_workbook(filename)#\n    sheet = workbook.sheet_by_index(1) #通过index选择你需要分割的那个sheet    \n    Title=sheet.row_values(TITLE_ROW) #\n    print(Title)\n    index = Title.index(STRING)#选择所需要的那一列数据\n    print(index)\n    all= sheet.col_values(index)\n    department = list(set(all))\n    department.remove(STRING) #删除Title这一个元素得到的是所有的部门了\n    print(department)\n    wb_result=xlwt.Workbook()\n    for sub_dt in department:\n        row_i =0 \n        sheet_subdt=wb_result.add_sheet(sub_dt,cell_overwrite_ok=True)\n        for j in range(sheet.ncols):\n            sheet_subdt.write(row_i,j,sheet.row_values(TITLE_ROW)[j])\n        row_i=row_i+1\n        for i in range(1,sheet.nrows): #第1行是Titile，从第2行开始\n            if sheet.row_values(i)[index] == sub_dt:\n                for j in range(sheet.ncols):\n                    sheet_subdt.write(row_i,j,sheet.row_values(i)[j])\n                row_i=row_i+1\n            \n    wb_result.save('result-split.xls')\n        \ndef main():\n    parser = OptionParser(description=\"split your excel sheet to many by keywords.\", usage=\"%prog [-f]\", version=\"%prog 1.0\")\n    parser.add_option('-f', '--filename', dest='filename',\n                      help=\"the filename that you need to split.\")\n    options, args = parser.parse_args(args=sys.argv[1:])\n    stock = split_file(options.filename)\nif __name__=='__main__':\n    main()\n\n                ", "mainLikeNum": ["0 "], "mainBookmarkNum": "0"}